(window.webpackJsonp=window.webpackJsonp||[]).push([[1047],{1469:function(t,s,a){"use strict";a.r(s);var e=a(9),n=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"digitalocean"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#digitalocean"}},[t._v("#")]),t._v(" DigitalOcean")]),t._v(" "),a("p",[t._v("This is a step-by-step guide for deploying a Strapi project to "),a("a",{attrs:{href:"https://www.digitalocean.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("DigitalOcean"),a("OutboundLink")],1),t._v(". Databases can be on a "),a("a",{attrs:{href:"https://www.digitalocean.com/docs/droplets/",target:"_blank",rel:"noopener noreferrer"}},[t._v("DigitalOcean Droplet"),a("OutboundLink")],1),t._v(" or hosted externally as a service. Prior to starting this guide, you should have created a "),a("RouterLink",{attrs:{to:"/developer-docs/latest/getting-started/quick-start.html"}},[t._v("Strapi project")]),t._v(". And have read through the "),a("RouterLink",{attrs:{to:"/developer-docs/latest/setup-deployment-guides/deployment.html#application-configuration"}},[t._v("configuration")]),t._v(" section.")],1),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),a("p",[t._v("Strapi does have a "),a("RouterLink",{attrs:{to:"/developer-docs/latest/setup-deployment-guides/installation/digitalocean-one-click.html"}},[t._v("One-Click")]),t._v(" deployment option for DigitalOcean")],1)]),t._v(" "),a("h3",{attrs:{id:"digitalocean-install-requirements"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#digitalocean-install-requirements"}},[t._v("#")]),t._v(" DigitalOcean Install Requirements")]),t._v(" "),a("ul",[a("li",[t._v("If you don't have a DigitalOcean account you will need to create one, you can use "),a("a",{attrs:{href:"https://try.digitalocean.com/strapi/",target:"_blank",rel:"noopener noreferrer"}},[t._v("this referral link"),a("OutboundLink")],1),t._v(" to get $100 of free credits!")])]),t._v(" "),a("h3",{attrs:{id:"create-a-droplet"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#create-a-droplet"}},[t._v("#")]),t._v(' Create a "Droplet"')]),t._v(" "),a("p",[t._v("DigitalOcean calls a virtual private server, a "),a("a",{attrs:{href:"https://www.digitalocean.com/docs/droplets/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Droplet"),a("OutboundLink")],1),t._v(". You need to create a new "),a("code",[t._v("Droplet")]),t._v(" to host your Strapi project.")]),t._v(" "),a("h4",{attrs:{id:"_1-log-in-to-your-digitalocean-account"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-log-in-to-your-digitalocean-account"}},[t._v("#")]),t._v(" 1. Log in to your "),a("a",{attrs:{href:"https://cloud.digitalocean.com/login",target:"_blank",rel:"noopener noreferrer"}},[t._v("DigitalOcean account"),a("OutboundLink")],1),t._v(".")]),t._v(" "),a("h4",{attrs:{id:"_2-create-a-droplet-by-clicking-on-new-droplet"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-create-a-droplet-by-clicking-on-new-droplet"}},[t._v("#")]),t._v(" 2. "),a("code",[t._v("Create a Droplet")]),t._v(" by clicking on "),a("code",[t._v("New Droplet")]),t._v(".")]),t._v(" "),a("p",[t._v("Choose these options:")]),t._v(" "),a("ul",[a("li",[t._v("Ubuntu 18.04 x64")]),t._v(" "),a("li",[t._v("STARTER "),a("code",[t._v("Standard")])]),t._v(" "),a("li",[t._v("Choose an appropriate pricing plan. For example, pricing: "),a("code",[t._v("$10/mo")]),t._v(" "),a("em",[t._v("(Scroll to the left)")]),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),a("p",[t._v("The $5/mo plan is currently unsupported as Strapi will not build with 1G of RAM. At the moment, deploying the Strapi Admin interface requires more than 1g of RAM. Therefore, a minimum standard Droplet of "),a("strong",[t._v("$10/mo")]),t._v(" or larger instance is needed.")])])]),t._v(" "),a("li",[t._v("Choose a "),a("code",[t._v("datacenter")]),t._v(" region nearest your audience, for example, "),a("code",[t._v("New York")]),t._v(".")]),t._v(" "),a("li",[a("strong",[t._v("OPTIONAL:")]),t._v(" Select additional options, for example, "),a("code",[t._v("[x] IPv6")]),t._v(".")]),t._v(" "),a("li",[t._v("添加 your SSH key"),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),a("p",[t._v("We recommend you "),a("code",[t._v("add your SSH key")]),t._v(" for better security.")])]),t._v(" "),a("ul",[a("li",[t._v("In your terminal, use "),a("code",[t._v("pbcopy < ~/.ssh/id_rsa.pub")]),t._v(" to copy your existing SSH public key, on your development computer, to the clipboard.")]),t._v(" "),a("li",[t._v("点击 "),a("code",[t._v("New SSH Key")]),t._v(" and paste in your "),a("code",[t._v("SSH Key")]),t._v(". "),a("code",[t._v("Name")]),t._v(" this SSH key and then "),a("code",[t._v("Save")]),t._v(".\n(Additional instructions on creating and using SSH Keys can be found "),a("a",{attrs:{href:"https://www.digitalocean.com/docs/droplets/how-to/add-ssh-keys/create-with-openssh/",target:"_blank",rel:"noopener noreferrer"}},[t._v("这里"),a("OutboundLink")],1),t._v(".)")])])]),t._v(" "),a("li",[a("strong",[t._v("OPTIONAL:")]),t._v(" "),a("code",[t._v("Choose a hostname")]),t._v(" or leave as-is.")]),t._v(" "),a("li",[t._v("点击 green "),a("code",[t._v("Create")]),t._v(" 按钮")])]),t._v(" "),a("p",[a("strong",[t._v("DigitalOcean")]),t._v(" will create your "),a("strong",[t._v("Droplet")]),t._v(" and indicate the progress with a percentage bar. Once this is complete, you may continue to the next steps.")]),t._v(" "),a("h3",{attrs:{id:"setup-production-server-and-install-node-js"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#setup-production-server-and-install-node-js"}},[t._v("#")]),t._v(" Setup production server and install Node.js")]),t._v(" "),a("p",[t._v("These next steps will help you to "),a("em",[t._v("set up a production server")]),t._v(" and "),a("em",[t._v("set up a non-root user")]),t._v(" for managing your server.")]),t._v(" "),a("p",[t._v("Follow the official "),a("a",{attrs:{href:"https://www.digitalocean.com/community/tutorials/initial-server-setup-with-ubuntu-18-04",target:"_blank",rel:"noopener noreferrer"}},[t._v("DigitalOcean docs for initial server set-up using Ubuntu 18.04"),a("OutboundLink")],1),t._v(". These docs will have you complete the following actions:")]),t._v(" "),a("h4",{attrs:{id:"_1-logging-and-set-up-root-user-access-to-your-server-with-ssh"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-logging-and-set-up-root-user-access-to-your-server-with-ssh"}},[t._v("#")]),t._v(" 1. "),a("a",{attrs:{href:"https://www.digitalocean.com/community/tutorials/initial-server-setup-with-ubuntu-18-04#step-1-%E2%80%94-logging-in-as-root",target:"_blank",rel:"noopener noreferrer"}},[t._v("Logging and set up root user access to your server with SSH"),a("OutboundLink")],1),t._v(".")]),t._v(" "),a("h4",{attrs:{id:"_2-creating-a-new-user"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-creating-a-new-user"}},[t._v("#")]),t._v(" 2. "),a("a",{attrs:{href:"https://www.digitalocean.com/community/tutorials/initial-server-setup-with-ubuntu-18-04#step-2-%E2%80%94-creating-a-new-user",target:"_blank",rel:"noopener noreferrer"}},[t._v("Creating a new user"),a("OutboundLink")],1),t._v(".")]),t._v(" "),a("h4",{attrs:{id:"_3-granting-administrative-privileges-to-the-new-user"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-granting-administrative-privileges-to-the-new-user"}},[t._v("#")]),t._v(" 3. "),a("a",{attrs:{href:"https://www.digitalocean.com/community/tutorials/initial-server-setup-with-ubuntu-18-04#step-3-%E2%80%94-granting-administrative-privileges",target:"_blank",rel:"noopener noreferrer"}},[t._v("Granting Administrative Privileges to the new user"),a("OutboundLink")],1),t._v(".")]),t._v(" "),a("h4",{attrs:{id:"_4-setting-up-a-basic-firewall"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-setting-up-a-basic-firewall"}},[t._v("#")]),t._v(" 4. "),a("a",{attrs:{href:"https://www.digitalocean.com/community/tutorials/initial-server-setup-with-ubuntu-18-04#step-4-%E2%80%94-setting-up-a-basic-firewall",target:"_blank",rel:"noopener noreferrer"}},[t._v("Setting up a basic firewall"),a("OutboundLink")],1),t._v(".")]),t._v(" "),a("h4",{attrs:{id:"_5-giving-your-regular-user-access-to-the-server-with-ssh-key-authentication"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-giving-your-regular-user-access-to-the-server-with-ssh-key-authentication"}},[t._v("#")]),t._v(" 5. "),a("a",{attrs:{href:"https://www.digitalocean.com/community/tutorials/initial-server-setup-with-ubuntu-18-04#step-5-%E2%80%94-enabling-external-access-for-your-regular-user",target:"_blank",rel:"noopener noreferrer"}},[t._v("Giving your regular user access to the server"),a("OutboundLink")],1),t._v(" "),a("strong",[t._v("with SSH key authentication")]),t._v(".")]),t._v(" "),a("p",[t._v("Next, install "),a("code",[t._v("Node.js")]),t._v(":")]),t._v(" "),a("h4",{attrs:{id:"_6-you-will-install-node-js"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-you-will-install-node-js"}},[t._v("#")]),t._v(" 6. You will install "),a("code",[t._v("Node.js")]),t._v(".")]),t._v(" "),a("p",[t._v("Use the instructions in section "),a("strong",[t._v("Install Node using a PPA")]),t._v(" from the official "),a("a",{attrs:{href:"https://www.digitalocean.com/community/tutorials/how-to-install-node-js-on-ubuntu-18-04#installing-using-a-ppa",target:"_blank",rel:"noopener noreferrer"}},[t._v("DigitalOcean docs for installing a production ready Node.js server"),a("OutboundLink")],1),t._v(".")]),t._v(" "),a("p",[t._v("After completing the steps to "),a("strong",[t._v('install Node.js, NPM and the "build-essential package"')]),t._v(", you will manually change npm's default directory. The following steps are based on "),a("a",{attrs:{href:"https://docs.npmjs.com/resolving-eacces-permissions-errors-when-installing-packages-globally",target:"_blank",rel:"noopener noreferrer"}},[t._v("how to resolve access permissions from npmjs.com"),a("OutboundLink")],1),t._v(":")]),t._v(" "),a("ul",[a("li",[t._v("创建 a "),a("code",[t._v(".npm-global")]),t._v(" directory and set the path to this directory for "),a("code",[t._v("node_modules")])])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" ~\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("mkdir")]),t._v(" ~/.npm-global\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" config "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("set")]),t._v(" prefix "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'~/.npm-global'")]),t._v("\n")])])]),a("ul",[a("li",[t._v("创建 (or modify) a "),a("code",[t._v("~/.profile")]),t._v(" file and add this line:")])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("nano")]),t._v(" ~/.profile\n")])])]),a("p",[t._v("Add these lines.")]),t._v(" "),a("div",{staticClass:"language-ini extra-class"},[a("pre",{pre:!0,attrs:{class:"language-ini"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# set PATH so global node modules install without permission issues")]),t._v("\nexport PATH"),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v("~/.npm-global/bin:$PATH")]),t._v("\n")])])]),a("ul",[a("li",[t._v("Lastly, update your system variables:")])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("source")]),t._v(" ~/.profile\n")])])]),a("p",[t._v("You are now ready to continue to the next section.")]),t._v(" "),a("h3",{attrs:{id:"install-and-configure-git-versioning-on-your-server"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#install-and-configure-git-versioning-on-your-server"}},[t._v("#")]),t._v(" Install and Configure Git versioning on your server")]),t._v(" "),a("p",[t._v("A convenient way to maintain your Strapi application and update it during and after initial development is to use "),a("a",{attrs:{href:"https://git-scm.com/book/en/v2/Getting-Started-About-Version-Control",target:"_blank",rel:"noopener noreferrer"}},[t._v("Git"),a("OutboundLink")],1),t._v(". In order to use Git, you will need to have it installed on your Droplet. Droplets should have Git installed by default, so you will first check if it is installed and if it is not installed, you will need to install it.")]),t._v(" "),a("p",[t._v("The next step is to configure Git on your server.")]),t._v(" "),a("h4",{attrs:{id:"_1-check-to-see-if-git-is-installed"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-check-to-see-if-git-is-installed"}},[t._v("#")]),t._v(" 1. Check to see if "),a("code",[t._v("Git")]),t._v(" is installed")]),t._v(" "),a("p",[t._v("If you see a "),a("code",[t._v("git version 2.x.x")]),t._v(" then you do have "),a("code",[t._v("Git")]),t._v(" installed. Check with the following command:")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" --version\n")])])]),a("h4",{attrs:{id:"_2-optional-install-git"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-optional-install-git"}},[t._v("#")]),t._v(" 2. "),a("strong",[t._v("OPTIONAL:")]),t._v(" Install Git.")]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("注意")]),t._v(" "),a("p",[t._v("Only do this step if "),a("em",[t._v("not installed")]),t._v(", as above. Please follow these directions on "),a("a",{attrs:{href:"https://www.digitalocean.com/community/tutorials/how-to-install-git-on-ubuntu-18-04",target:"_blank",rel:"noopener noreferrer"}},[t._v("how to install Git on Ubuntu 18.04"),a("OutboundLink")],1),t._v(".")])]),t._v(" "),a("h4",{attrs:{id:"_3-complete-the-global-username-and-email-settings-setting-up-git"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-complete-the-global-username-and-email-settings-setting-up-git"}},[t._v("#")]),t._v(" 3. Complete the global "),a("strong",[t._v("username")]),t._v(" and "),a("strong",[t._v("email")]),t._v(" settings: "),a("a",{attrs:{href:"https://www.digitalocean.com/community/tutorials/how-to-install-git-on-ubuntu-18-04#setting-up-git",target:"_blank",rel:"noopener noreferrer"}},[t._v("Setting up Git"),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("After installing and configuring Git on your Droplet. Please continue to the next step, "),a("a",{attrs:{href:"#install-the-database-for-your-project"}},[t._v("installing a database")]),t._v(".")]),t._v(" "),a("h3",{attrs:{id:"install-the-database-for-your-project"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#install-the-database-for-your-project"}},[t._v("#")]),t._v(" Install the database for your project")]),t._v(" "),a("p",[t._v("DigitalOcean has excellent documentation regarding the installation and use of the major databases that work with Strapi. The previous steps above should all be completed prior to continuing. You can find links, and any further instructions, below:")]),t._v(" "),a("Tabs",{attrs:{type:"border-card"}},[a("Tab",{attrs:{label:"PostgreSQL"}},[a("ol",[a("li",[a("a",{attrs:{href:"https://www.digitalocean.com/community/tutorials/how-to-install-and-use-postgresql-on-ubuntu-18-04",target:"_blank",rel:"noopener noreferrer"}},[t._v("Install PostgresSQL on Ubuntu 18.04"),a("OutboundLink")],1),t._v("(Through "),a("strong",[t._v("Step 4")]),t._v(" - Creating a New Database).")])]),t._v(" "),a("p",[t._v("Complete the steps to "),a("a",{attrs:{href:"https://www.digitalocean.com/community/tutorials/how-to-install-and-use-postgresql-on-ubuntu-18-04#step-1-%E2%80%94-installing-postgresql",target:"_blank",rel:"noopener noreferrer"}},[t._v("install PostgreSQL"),a("OutboundLink")],1),t._v(", "),a("a",{attrs:{href:"https://www.digitalocean.com/community/tutorials/how-to-install-and-use-postgresql-on-ubuntu-18-04#step-3-%E2%80%94-creating-a-new-role",target:"_blank",rel:"noopener noreferrer"}},[t._v("add a user"),a("OutboundLink")],1),t._v(" and "),a("a",{attrs:{href:"https://www.digitalocean.com/community/tutorials/how-to-install-and-use-postgresql-on-ubuntu-18-04#step-4-%E2%80%94-creating-a-new-database",target:"_blank",rel:"noopener noreferrer"}},[t._v("create a database"),a("OutboundLink")],1),t._v(".")]),t._v(" "),a("ol",{attrs:{start:"2"}},[a("li",[t._v("In order to connect to a PostgreSQL database with Strapi, it needs either to have a password, or specifically state there is no password by noting an empty string. Follow these commands from your terminal to "),a("code",[t._v("alter")]),t._v(" the "),a("code",[t._v("user")]),t._v(" you created and "),a("code",[t._v("add a password")]),t._v(":")])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" -u postgres psql     //only necessary "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" you switched away from the postgres@ user\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("sudo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" password "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" your-name:\npsql "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10.8")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Ubuntu "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10.8")]),t._v("-0ubuntu0.18.04.1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("))")]),t._v("\nType "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"help"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" help.\n\npsql\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("postgres")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ALTER USER your-name PASSWORD 'password';")]),t._v("\nALTER ROLE\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("postgres")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# \\q")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("exit")]),t._v("\n")])])]),a("ul",[a("li",[a("p",[a("strong",[t._v("OPTIONAL:")]),t._v(" If in "),a("strong",[t._v("Development")]),t._v(", your Strapi project is uses "),a("strong",[t._v("SQLite")]),t._v(", you will need to install a dependency package called "),a("code",[t._v("pg")]),t._v(":")]),t._v(" "),a("ul",[a("li",[t._v("On your "),a("strong",[t._v("Development")]),t._v(" computer:")])]),t._v(" "),a("p",[a("code",[t._v("Path: ./my-project/")])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" pg --save\n")])])]),a("p",[t._v("The "),a("code",[t._v("pg")]),t._v(" package is automatically installed locally if you choose "),a("code",[t._v("PostgreSQL")]),t._v(" as the initial database choice when you first set-up Strapi.")])])]),t._v(" "),a("p",[t._v("You will need the "),a("strong",[t._v("database name")]),t._v(", "),a("strong",[t._v("username")]),t._v(" and "),a("strong",[t._v("password")]),t._v(" for later use, please note these down.")]),t._v(" "),a("h3",{attrs:{id:"local-development-configuration"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#local-development-configuration"}},[t._v("#")]),t._v(" Local Development Configuration")]),t._v(" "),a("ul",[a("li",[t._v("You must have "),a("a",{attrs:{href:"https://git-scm.com/book/en/v2/Getting-Started-First-Time-Git-Setup",target:"_blank",rel:"noopener noreferrer"}},[t._v("Git installed and set-up locally"),a("OutboundLink")],1),t._v(".")]),t._v(" "),a("li",[t._v("You must have created a repository for your Strapi project and have your development project initialized to this repository.")])]),t._v(" "),a("p",[t._v("In your code editor, you will need to edit a file called "),a("code",[t._v("database.js")]),t._v(". Replace the contents of the file with the following.")]),t._v(" "),a("p",[a("code",[t._v("Path: ./config/database.js")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("module"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("exports")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" env "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  defaultConnection"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'default'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  connections"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      connector"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'bookshelf'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      settings"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        client"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'postgres'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        host"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("env")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'DATABASE_HOST'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'127.0.0.1'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        port"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" env"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("int")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'DATABASE_PORT'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("5432")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        database"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("env")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'DATABASE_NAME'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'strapi'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        username"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("env")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'DATABASE_USERNAME'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        password"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("env")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'DATABASE_PASSWORD'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      options"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        ssl"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("You are now ready to push these changes to Github:")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" commit -m "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Configured production/database.json"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" push\n")])])]),a("p",[t._v("Please continue to the next section, "),a("a",{attrs:{href:"#deploy-from-github"}},[t._v("Deploy from GitHub")]),t._v(".")])])],1),t._v(" "),a("h3",{attrs:{id:"deploy-from-github"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#deploy-from-github"}},[t._v("#")]),t._v(" Deploy from Github")]),t._v(" "),a("p",[t._v("You will next deploy your Strapi project to your Droplet by "),a("code",[t._v("cloning it from GitHub")]),t._v(".")]),t._v(" "),a("p",[t._v("From your terminal, "),a("code",[t._v("logged in as your non-root user")]),t._v(" to your Droplet:")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" ~\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" clone https://github.com/your-name/your-project-repo.git\n")])])]),a("p",[t._v("Next, navigate to the "),a("code",[t._v("my-project")]),t._v(" folder, the root for Strapi. You will now need to run "),a("code",[t._v("npm install")]),t._v(" to install the packages for your project.")]),t._v(" "),a("p",[a("code",[t._v("Path: ./my-project/")])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" ./my-project/\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("NODE_ENV")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("production "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" run build\n")])])]),a("p",[t._v("Strapi uses "),a("code",[t._v("Port: 1337")]),t._v(" by default. You will need to configure your "),a("code",[t._v("ufw firewall")]),t._v(" to allow access to this port, for testing and installation purposes. After you have installed and "),a("a",{attrs:{href:"https://www.digitalocean.com/community/tutorials/how-to-install-nginx-on-ubuntu-18-04",target:"_blank",rel:"noopener noreferrer"}},[t._v("configured NGINX"),a("OutboundLink")],1),t._v(", you need to "),a("code",[t._v("sudo ufw deny 1337")]),t._v(", to close the port to outside traffic.")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" ~\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" ufw allow "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1337")]),t._v("/tcp\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" ufw "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("enable")]),t._v("\n\nCommand may disrupt existing "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ssh")]),t._v(" connections. Proceed with operation "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("y"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("? y\nFirewall is active and enabled on system startup\n")])])]),a("p",[t._v("Your Strapi project is now installed on your "),a("strong",[t._v("Droplet")]),t._v(". You have a few more steps prior to being able to access Strapi and "),a("RouterLink",{attrs:{to:"/developer-docs/latest/getting-started/quick-start.html#_2-create-an-administrator-user"}},[t._v("create your first user")]),t._v(".")],1),t._v(" "),a("p",[t._v("You will next need to "),a("a",{attrs:{href:"#install-and-configure-pm2-runtime"}},[t._v("install and configure PM2 Runtime")]),t._v(".")]),t._v(" "),a("h3",{attrs:{id:"install-and-configure-pm2-runtime"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#install-and-configure-pm2-runtime"}},[t._v("#")]),t._v(" Install and configure PM2 Runtime")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://pm2.keymetrics.io",target:"_blank",rel:"noopener noreferrer"}},[t._v("PM2 Runtime"),a("OutboundLink")],1),t._v(" allows you to keep your Strapi project alive and to reload it without downtime.")]),t._v(" "),a("p",[t._v("Ensure you are logged in as a "),a("strong",[t._v("non-root")]),t._v(" user. You will install "),a("strong",[t._v("PM2")]),t._v(" globally:")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" pm2@latest -g\n")])])]),a("h3",{attrs:{id:"the-ecosystem-config-js-file"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#the-ecosystem-config-js-file"}},[t._v("#")]),t._v(" The ecosystem.config.js file")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("You will need to configure an "),a("code",[t._v("ecosystem.config.js")]),t._v(" file. This file will manage the "),a("strong",[t._v("database connection variables")]),t._v(" Strapi needs to connect to your database. The "),a("code",[t._v("ecosystem.config.js")]),t._v(" will also be used by "),a("code",[t._v("pm2")]),t._v(" to restart your project whenever any changes are made to files within the Strapi file system itself (such as when an update arrives from GitHub). You can read more about this file "),a("a",{attrs:{href:"https://pm2.keymetrics.io/docs/usage/pm2-doc-single-page/",target:"_blank",rel:"noopener noreferrer"}},[t._v("这里"),a("OutboundLink")],1),t._v(".")]),t._v(" "),a("ul",[a("li",[t._v("You will need to open your "),a("code",[t._v("nano")]),t._v(" editor and then "),a("code",[t._v("copy/paste")]),t._v(" the following:")])])])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" ~\npm2 init\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("nano")]),t._v(" ecosystem.config.js\n")])])]),a("ul",[a("li",[t._v("Next, replace the boilerplate content in the file, with the following:")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("module"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  apps"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      name"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'strapi'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      cwd"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/home/your-name/my-strapi-project/my-project'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      script"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'npm'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      args"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'start'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      env"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("NODE_ENV")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'production'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("DATABASE_HOST")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'localhost'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// database endpoint")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("DATABASE_PORT")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'5432'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("DATABASE_NAME")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'strapi'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// DB name")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("DATABASE_USERNAME")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'your-name'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// your username for psql")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("DATABASE_PASSWORD")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'password'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// your password for psql")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("You can also set your environment variables in a "),a("code",[t._v(".env")]),t._v(" file in your project like so:")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("DATABASE_HOST=your-unique-url.rds.amazonaws.com\nDATABASE_PORT=5432\nDATABASE_NAME=strapi\nDATABASE_USERNAME=postgres\nDATABASE_PASSWORD=Password\n")])])]),a("p",[t._v("We recommend you continue setting the "),a("code",[t._v("NODE_ENV")]),t._v(" variable in the "),a("code",[t._v("ecosystem.config.js")]),t._v(" file.")]),t._v(" "),a("p",[t._v("Use the following command to start "),a("code",[t._v("pm2")]),t._v(":")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" ~\npm2 start ecosystem.config.js\n")])])]),a("p",[a("code",[t._v("pm2")]),t._v(" is now set-up to use an "),a("code",[t._v("ecosystem.config.js")]),t._v(" to manage restarting your application upon changes. This is a recommended best practice.")]),t._v(" "),a("p",[a("strong",[t._v("OPTIONAL:")]),t._v(" You may see your project and set-up your first administrator user, by "),a("RouterLink",{attrs:{to:"/developer-docs/latest/getting-started/quick-start.html#_2-create-an-administrator-user"}},[t._v("creating an admin user")]),t._v(".")],1),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),a("p",[t._v("Earlier, "),a("code",[t._v("Port 1337")]),t._v(" was allowed access for "),a("strong",[t._v("testing and setup")]),t._v(" purposes. After setting up "),a("strong",[t._v("NGINX")]),t._v(", the "),a("strong",[t._v("Port 1337")]),t._v(" needs to have access "),a("strong",[t._v("denied")]),t._v(".")])]),t._v(" "),a("p",[t._v("Follow the steps below to have your app launch on system startup.")]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),a("p",[t._v("These steps are modified from the DigitalOcean "),a("a",{attrs:{href:"https://www.digitalocean.com/community/tutorials/how-to-set-up-a-node-js-application-for-production-on-ubuntu-18-04#step-3-%E2%80%94-installing-pm2",target:"_blank",rel:"noopener noreferrer"}},[t._v("documentation for setting up PM2"),a("OutboundLink")],1),t._v(".")])]),t._v(" "),a("ul",[a("li",[t._v("Generate and configure a startup script to launch PM2, it will generate a Startup Script to copy/paste, do so:")])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" ~\n$ pm2 startup systemd\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("PM2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" Init System found: systemd\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("PM2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" To setup the Startup Script, copy/paste the following command:\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("env")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("PATH")])]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("$PATH")]),t._v(":/usr/bin /usr/lib/node_modules/pm2/bin/pm2 startup systemd -u your-name --hp /home/your-name\n")])])]),a("ul",[a("li",[t._v("Copy/paste the generated command:")])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("env")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("PATH")])]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("$PATH")]),t._v(":/usr/bin /usr/lib/node_modules/pm2/bin/pm2 startup systemd -u your-name --hp /home/your-name\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("PM2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" Init System found: systemd\nPlatform systemd\n\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("PM2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("v"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" Command successfully executed.\n+---------------------------------------+\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("PM2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" Freeze a process list on "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("reboot")]),t._v(" via:\n   $ pm2 save\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("PM2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" Remove init script via:\n   $ pm2 unstartup systemd\n")])])]),a("ul",[a("li",[t._v("Next, "),a("code",[t._v("Save")]),t._v(" the new PM2 process list and environment. Then "),a("code",[t._v("Start")]),t._v(" the service with "),a("code",[t._v("systemctl")]),t._v(":")])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("pm2 save\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("PM2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" Saving current process list"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("PM2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" Successfully saved "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" /home/your-name/.pm2/dump.pm2\n\n")])])]),a("ul",[a("li",[a("strong",[t._v("OPTIONAL")]),t._v(": You can test to see if the script above works whenever your system reboots with the "),a("code",[t._v("sudo reboot")]),t._v(" command. You will need to login again with your "),a("strong",[t._v("non-root user")]),t._v(" and then run "),a("code",[t._v("pm2 list")]),t._v(" and "),a("code",[t._v("systemctl status pm2-your-name")]),t._v(" to verify everything is working.")])]),t._v(" "),a("p",[t._v("Continue below to configure the "),a("code",[t._v("webhook")]),t._v(".")]),t._v(" "),a("h3",{attrs:{id:"set-up-a-webhook-on-digitalocean-github"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#set-up-a-webhook-on-digitalocean-github"}},[t._v("#")]),t._v(" Set up a webhook on DigitalOcean / GitHub")]),t._v(" "),a("p",[t._v("Providing that your project is set-up on GitHub, you will need to configure your "),a("strong",[t._v("Strapi Project Repository")]),t._v(" with a webhook. The following articles provide additional information to the steps below: "),a("a",{attrs:{href:"https://developer.github.com/webhooks/creating/",target:"_blank",rel:"noopener noreferrer"}},[t._v("GitHub Creating Webhooks Guide"),a("OutboundLink")],1),t._v(" and "),a("a",{attrs:{href:"https://www.digitalocean.com/community/tutorials/how-to-use-node-js-and-github-webhooks-to-keep-remote-projects-in-sync",target:"_blank",rel:"noopener noreferrer"}},[t._v("DigitalOcean Guide to GitHub WebHooks"),a("OutboundLink")],1),t._v(".")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("You will need to access the "),a("code",[t._v("Settings")]),t._v(" tab for your "),a("code",[t._v("Strapi Project Repository")]),t._v(":")]),t._v(" "),a("ol",[a("li",[t._v("Navigate and click to "),a("code",[t._v("Settings")]),t._v(" for your repository.")]),t._v(" "),a("li",[t._v("点击 "),a("code",[t._v("Webhooks")]),t._v(", then click "),a("code",[t._v("Add Webhook")]),t._v(".")]),t._v(" "),a("li",[t._v("The fields are filled out like this:\n"),a("ul",[a("li",[t._v("Payload URL: Enter "),a("code",[t._v("http://your-ip-address:8080")])]),t._v(" "),a("li",[t._v("Content type: Select "),a("code",[t._v("application/json")])]),t._v(" "),a("li",[t._v("Which events would you like to trigger this webhook: Select "),a("code",[t._v("Just the push event")])]),t._v(" "),a("li",[t._v("Secret: Enter "),a("code",[t._v("YourSecret")])]),t._v(" "),a("li",[t._v("Active: Select the checkbox")])])]),t._v(" "),a("li",[t._v("Review the fields and click "),a("code",[t._v("Add Webhook")]),t._v(".")])])]),t._v(" "),a("li",[a("p",[t._v("Next, you need to create a "),a("code",[t._v("Webhook Script")]),t._v(" on your server. These commands create a new file called "),a("code",[t._v("webhook.js")]),t._v(" which will hold two variables:")])])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" ~\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("mkdir")]),t._v(" NodeWebHooks\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" NodeWebHooks\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("nano")]),t._v(" webhook.js\n")])])]),a("ul",[a("li",[t._v("In the "),a("code",[t._v("nano")]),t._v(" editor, copy/paste the following script, but make sure to replace "),a("code",[t._v("your_secret_key")]),t._v(" and "),a("code",[t._v("repo")]),t._v(" with the values that correspond to your project, then save and exit.")])]),t._v(" "),a("p",[t._v("(This script creates a variable called "),a("code",[t._v("PM2_CMD")]),t._v(" which is used after pulling from GitHub to update your project. The script first changes to the home directory and then runs the variable "),a("code",[t._v("PM2_CMD")]),t._v(" as "),a("code",[t._v("pm2 restart strapi")]),t._v(".")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" secret "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'your_secret_key'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" repo "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'~/path-to-your-repo/'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" http "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" crypto "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'crypto'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" exec "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'child_process'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exec"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("PM2_CMD")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'cd ~ && pm2 startOrRestart ecosystem.config.js'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nhttp\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createServer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("req"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    req"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'data'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("chunk")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" sig "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'sha1='")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("\n        crypto\n          "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createHmac")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'sha1'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" secret"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("update")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("chunk"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("toString")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("digest")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'hex'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("req"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("headers"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'x-hub-signature'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" sig"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("exec")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token template-string"}},[a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("cd ")]),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("repo"),a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v(" && git pull && ")]),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("PM2_CMD")]),a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("error"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" stdout"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" stderr")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("error"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("error")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token template-string"}},[a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("exec error: ")]),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("error"),a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n          console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token template-string"}},[a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("stdout: ")]),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("stdout"),a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n          console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token template-string"}},[a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("stderr: ")]),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("stderr"),a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    res"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("end")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("listen")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("8080")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("ul",[a("li",[t._v("Allow the port to communicate with outside web traffic for "),a("code",[t._v("port 8080")]),t._v(":")])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" ufw allow "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("8080")]),t._v("/tcp\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" ufw "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("enable")]),t._v("\n\nCommand may disrupt existing "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ssh")]),t._v(" connections. Proceed with operation "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("y"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("? y\nFirewall is active and enabled on system startup\n")])])]),a("p",[t._v("Earlier you setup "),a("code",[t._v("pm2")]),t._v(" to start the services (your "),a("strong",[t._v("Strapi project")]),t._v(") whenever the "),a("strong",[t._v("Droplet")]),t._v(" reboots or is started. You will now do the same for the "),a("code",[t._v("webhook")]),t._v(" script.")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("Install the webhook as a "),a("code",[t._v("Systemd")]),t._v(" service")]),t._v(" "),a("ul",[a("li",[t._v("Run "),a("code",[t._v("echo $PATH")]),t._v(" and copy the output for use in the next step.")])])])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("echo $PATH\n\n/home/your-name/.npm-global/bin:/home/your-name/bin:/home/your-name/.local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin\n")])])]),a("ul",[a("li",[t._v("创建 a "),a("code",[t._v("webhook.service")]),t._v(" file:")])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" ~\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("nano")]),t._v(" /etc/systemd/system/webhook.service\n")])])]),a("ul",[a("li",[t._v("In the "),a("code",[t._v("nano")]),t._v(" editor, copy/paste the following script, but make sure to replace "),a("code",[t._v("your-name")]),t._v(" "),a("strong",[t._v("in two places")]),t._v(" with your username. Earlier, you ran "),a("code",[t._v("echo $PATH")]),t._v(", copy this to the "),a("code",[t._v("Environment=PATH=")]),t._v(" variable, then save and exit:")])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Unit"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("Description")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("Github webhook\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("After")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("network.target\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Service"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("Environment")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("PATH")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("your_path\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("Type")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("simple\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("User")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("your-name\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("ExecStart")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/usr/bin/nodejs /home/your-name/NodeWebHooks/webhook.js\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("Restart")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("on-failure\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Install"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("WantedBy")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("multi-user.target\n")])])]),a("ul",[a("li",[t._v("Enable and start the new service so it starts when the system boots:")])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" systemctl "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("enable")]),t._v(" webhook.service\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" systemctl start webhook\n")])])]),a("ul",[a("li",[t._v("点击 the status of the webhook:")])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" systemctl status webhook\n")])])]),a("ul",[a("li",[t._v("You may test your "),a("strong",[t._v("webhook")]),t._v(" by following the instructions "),a("a",{attrs:{href:"https://www.digitalocean.com/community/tutorials/how-to-use-node-js-and-github-webhooks-to-keep-remote-projects-in-sync#step-4-testing-the-webhook",target:"_blank",rel:"noopener noreferrer"}},[t._v("这里"),a("OutboundLink")],1),t._v(".")])]),t._v(" "),a("h3",{attrs:{id:"further-steps-to-take"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#further-steps-to-take"}},[t._v("#")]),t._v(" Further steps to take")]),t._v(" "),a("ul",[a("li",[t._v("You can "),a("strong",[t._v("add a domain name")]),t._v(" or "),a("strong",[t._v("use a subdomain name")]),t._v(" for your Strapi project, you will need to "),a("a",{attrs:{href:"https://www.digitalocean.com/community/tutorials/how-to-install-nginx-on-ubuntu-18-04",target:"_blank",rel:"noopener noreferrer"}},[t._v("install NGINX and configure it"),a("OutboundLink")],1),t._v(".")]),t._v(" "),a("li",[t._v("Deny traffic to Port 1337. You have set-up a proxy using Nginx, you now need to block access by running the following command:")])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("cd ~\nsudo ufw deny 1337\n")])])]),a("ul",[a("li",[t._v("To "),a("strong",[t._v("install SSL")]),t._v(", you will need to "),a("a",{attrs:{href:"https://www.digitalocean.com/community/tutorials/how-to-secure-nginx-with-let-s-encrypt-on-ubuntu-18-04",target:"_blank",rel:"noopener noreferrer"}},[t._v("install and run Certbot by Let's Encrypt"),a("OutboundLink")],1),t._v(".")]),t._v(" "),a("li",[t._v("Set-up "),a("a",{attrs:{href:"https://www.digitalocean.com/community/tutorials/how-to-set-up-nginx-with-http-2-support-on-ubuntu-18-04",target:"_blank",rel:"noopener noreferrer"}},[t._v("Nginx with HTTP/2 Support"),a("OutboundLink")],1),t._v(" for Ubuntu 18.04.")])]),t._v(" "),a("p",[t._v("Your "),a("code",[t._v("Strapi")]),t._v(" project has been installed on a "),a("strong",[t._v("DigitalOcean Droplet")]),t._v(" using "),a("strong",[t._v("Ubuntu 18.04")]),t._v(".")])],1)}),[],!1,null,null,null);s.default=n.exports}}]);