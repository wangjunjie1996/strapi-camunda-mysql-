(window.webpackJsonp=window.webpackJsonp||[]).push([[1018],{1441:function(t,e,s){"use strict";s.r(e);var a=s(9),n=Object(a.a)({},(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"roles-permissions"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#roles-permissions"}},[t._v("#")]),t._v(" Roles & Permissions")]),t._v(" "),s("p",[t._v("This plugin provides a way to protect your API with a full authentication process based on JWT. This plugin comes also with an ACL strategy that allows you to manage the permissions between the groups of users.")]),t._v(" "),s("p",[t._v("To access the plugin admin panel, click on the "),s("strong",[t._v("Settings")]),t._v(" link 在左边的菜单里 and then everything will be under the "),s("strong",[t._v("USERS & PERMISSIONS PLUGIN")]),t._v(" section.")]),t._v(" "),s("h2",{attrs:{id:"concept"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#concept"}},[t._v("#")]),t._v(" Concept")]),t._v(" "),s("p",[t._v("When this plugin is installed, it adds an access layer on your application.\nThe plugin uses "),s("a",{attrs:{href:"https://en.wikipedia.org/wiki/JSON_Web_Token",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("jwt token")]),s("OutboundLink")],1),t._v(" to authenticate users.")]),t._v(" "),s("p",[t._v("Each time an API request is sent, the server checks if an "),s("code",[t._v("Authorization")]),t._v(" header is present and verifies if the user making the request has access to the resource.")]),t._v(" "),s("p",[t._v("To do so, your JWT contains your user ID and we are able to match the group your user is in and at the end to know if the group allows access to the route.")]),t._v(" "),s("h2",{attrs:{id:"manage-role-permissions"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#manage-role-permissions"}},[t._v("#")]),t._v(" Manage role permissions")]),t._v(" "),s("h3",{attrs:{id:"public-role"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#public-role"}},[t._v("#")]),t._v(" Public role")]),t._v(" "),s("p",[t._v("This role is used when you receive a request that doesn't have an "),s("code",[t._v("Authorization")]),t._v(" header.\nIf you allow some permissions in this role, everybody will be able to access the endpoints you selected.\nThis is common practice to select "),s("code",[t._v("find")]),t._v(" / "),s("code",[t._v("findOne")]),t._v(" endpoints when you want your front-end application to access all the content without developing user authentication and authorization.")]),t._v(" "),s("h3",{attrs:{id:"authenticated-role"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#authenticated-role"}},[t._v("#")]),t._v(" Authenticated role")]),t._v(" "),s("p",[t._v("This is the default role that is given to every "),s("strong",[t._v("new user")]),t._v(" if no role is provided at creation. In this role you will be able to define routes that a user can access.")]),t._v(" "),s("h3",{attrs:{id:"permissions-management"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#permissions-management"}},[t._v("#")]),t._v(" Permissions management")]),t._v(" "),s("p",[t._v("By clicking on the "),s("strong",[t._v("Role")]),t._v(" name, you will be able to see all functions available in your application (and these functions are related to a specific route)")]),t._v(" "),s("p",[t._v("If you check a function name, it makes this route accessible by the current role you are editing.\nOn the right sidebar you will be able to see the URL related to this function.")]),t._v(" "),s("h3",{attrs:{id:"update-the-default-role"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#update-the-default-role"}},[t._v("#")]),t._v(" Update the default role")]),t._v(" "),s("p",[t._v("When you create a user without a role or if you use the "),s("code",[t._v("/auth/local/register")]),t._v(" route, the "),s("code",[t._v("authenticated")]),t._v(" role is given to the user.")]),t._v(" "),s("p",[t._v("To change the default role, go to the "),s("code",[t._v("Advanced settings")]),t._v(" tab and update the "),s("code",[t._v("Default role for authenticated users")]),t._v(" option.")]),t._v(" "),s("h2",{attrs:{id:"authentication"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#authentication"}},[t._v("#")]),t._v(" Authentication")]),t._v(" "),s("h3",{attrs:{id:"token-usage"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#token-usage"}},[t._v("#")]),t._v(" Token usage")]),t._v(" "),s("p",[t._v("A jwt token may be used for making permission-restricted API requests. To make an API request as a user, place the jwt token into an "),s("code",[t._v("Authorization")]),t._v(" header of the GET request. A request without a token, will assume the "),s("code",[t._v("public")]),t._v(" role permissions by default. Modify the permissions of each user's role in admin dashboard. Authentication failures return a 401 (unauthorized) error.")]),t._v(" "),s("h4",{attrs:{id:"usage"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#usage"}},[t._v("#")]),t._v(" Usage")]),t._v(" "),s("ul",[s("li",[t._v("The "),s("code",[t._v("token")]),t._v(" variable is the "),s("code",[t._v("data.jwt")]),t._v(" received when logging in or registering.")])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" axios "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'axios'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" token "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'YOUR_TOKEN_HERE'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Request API.")]),t._v("\naxios\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://localhost:1337/posts'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    headers"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      Authorization"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token template-string"}},[s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("Bearer ")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("token"),s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("response")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Handle success.")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Data: '")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" response"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("catch")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("error")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Handle error.")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'An error occurred:'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" error"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("response"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h3",{attrs:{id:"jwt-configuration"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#jwt-configuration"}},[t._v("#")]),t._v(" JWT configuration")]),t._v(" "),s("p",[t._v("You can configure option for the JWT generation by creating "),s("code",[t._v("extensions/users-permissions/config/security.json")]),t._v(" file.\nWe are using "),s("a",{attrs:{href:"https://www.npmjs.com/package/jsonwebtoken",target:"_blank",rel:"noopener noreferrer"}},[t._v("jsonwebtoken"),s("OutboundLink")],1),t._v(" to generate the JWT.")]),t._v(" "),s("p",[t._v("Available options:")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("expiresIn")]),t._v(": expressed in seconds or a string describing a time span zeit/ms."),s("br"),t._v('\nEg: 60, "2 days", "10h", "7d". A numeric value is interpreted as a seconds count. If you use a string be sure you provide the time units (days, hours, etc), otherwise milliseconds unit is used by default ("120" is equal to "120ms").')])]),t._v(" "),s("p",[s("strong",[t._v("Path —")]),t._v(" "),s("code",[t._v("extensions/users-permissions/config/security.json")])]),t._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"jwt"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"expiresIn"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1d"')]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h3",{attrs:{id:"registration"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#registration"}},[t._v("#")]),t._v(" Registration")]),t._v(" "),s("p",[t._v("Creates a new user in the database with a default role as 'registered'.")]),t._v(" "),s("h4",{attrs:{id:"usage-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#usage-2"}},[t._v("#")]),t._v(" Usage")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" axios "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'axios'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Request API.")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Add your own code here to customize or restrict how the public can register new users.")]),t._v("\naxios\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("post")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://localhost:1337/auth/local/register'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    username"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Strapi user'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    email"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'user@strapi.io'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    password"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'strapiPassword'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("response")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Handle success.")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Well done!'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'User profile'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" response"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("user"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'User token'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" response"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("jwt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("catch")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("error")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Handle error.")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'An error occurred:'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" error"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("response"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h3",{attrs:{id:"login"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#login"}},[t._v("#")]),t._v(" Login")]),t._v(" "),s("p",[t._v("Submit the user's identifier and password credentials for authentication. When the authentication is successful, the response data returned will have the user's information along with a jwt authentication token.")]),t._v(" "),s("h4",{attrs:{id:"local"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#local"}},[t._v("#")]),t._v(" Local")]),t._v(" "),s("ul",[s("li",[t._v("The "),s("code",[t._v("identifier")]),t._v(" param can either be an "),s("strong",[t._v("email")]),t._v(" or a "),s("strong",[t._v("username")]),t._v(".")])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" axios "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'axios'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Request API.")]),t._v("\naxios\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("post")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://localhost:1337/auth/local'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    identifier"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'user@strapi.io'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    password"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'strapiPassword'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("response")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Handle success.")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Well done!'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'User profile'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" response"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("user"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'User token'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" response"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("jwt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("catch")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("error")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Handle error.")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'An error occurred:'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" error"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("response"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h3",{attrs:{id:"providers"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#providers"}},[t._v("#")]),t._v(" Providers")]),t._v(" "),s("p",[t._v("Thanks to "),s("a",{attrs:{href:"https://github.com/simov/grant",target:"_blank",rel:"noopener noreferrer"}},[t._v("Grant"),s("OutboundLink")],1),t._v(" and "),s("a",{attrs:{href:"https://github.com/simov/purest",target:"_blank",rel:"noopener noreferrer"}},[t._v("Purest"),s("OutboundLink")],1),t._v(", you can easily use OAuth and OAuth2 providers to enable authentication in your application.")]),t._v(" "),s("p",[t._v("For better understanding, you may find as follows the description of the login flow. To simplify the explanation, we used "),s("code",[t._v("github")]),t._v(" as the provider but it works the same for the other providers.")]),t._v(" "),s("h4",{attrs:{id:"understanding-the-login-flow"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#understanding-the-login-flow"}},[t._v("#")]),t._v(" Understanding the login flow")]),t._v(" "),s("p",[t._v("Let's say that strapi's backend is located at: strapi.website.com.\nLet's say that your app frontend is located at: website.com.")]),t._v(" "),s("ol",[s("li",[t._v("The user goes on your frontend app ("),s("code",[t._v("https://website.com")]),t._v(") and click on your button "),s("code",[t._v("connect with Github")]),t._v(".")]),t._v(" "),s("li",[t._v("The frontend redirect the tab to the backend URL: "),s("code",[t._v("https://strapi.website.com/connect/github")]),t._v(".")]),t._v(" "),s("li",[t._v("The backend redirects the tab to the GitHub login page where the user logs in.")]),t._v(" "),s("li",[t._v("Once done, Github redirects the tab to the backend URL:"),s("code",[t._v("https://strapi.website.com/connect/github/callback?code=abcdef")]),t._v(".")]),t._v(" "),s("li",[t._v("The backend uses the given "),s("code",[t._v("code")]),t._v(" to get from Github an "),s("code",[t._v("access_token")]),t._v(" that can be used for a period of time to make authorized requests to Github to get the user info (the email of the user of example).")]),t._v(" "),s("li",[t._v("Then, the backend redirects the tab to the url of your choice with the param "),s("code",[t._v("access_token")]),t._v(" (example: "),s("code",[t._v("http://website.com/connect/github/redirect?access_token=eyfvg")]),t._v(")")]),t._v(" "),s("li",[t._v("The frontend ("),s("code",[t._v("http://website.com/connect/github/redirect")]),t._v(") calls the backend with "),s("code",[t._v("https://strapi.website.com/auth/github/callback?access_token=eyfvg")]),t._v(" that returns the strapi user profile with its "),s("code",[t._v("jwt")]),t._v(". "),s("br"),t._v(" (Under the hood, the backend asks Github for the user's profile and a match is done on Github user's email address and Strapi user's email address)")]),t._v(" "),s("li",[t._v("The frontend now possesses the user's "),s("code",[t._v("jwt")]),t._v(", with means the user is connected and the frontend can make authenticated requests to the backend!")])]),t._v(" "),s("p",[t._v("An example of a frontend app that handles this flow can be found here: "),s("a",{attrs:{href:"https://github.com/strapi/strapi-examples/tree/master/login-react",target:"_blank",rel:"noopener noreferrer"}},[t._v("react login example app"),s("OutboundLink")],1),t._v(".")]),t._v(" "),s("h4",{attrs:{id:"setting-up-the-server-url"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#setting-up-the-server-url"}},[t._v("#")]),t._v(" Setting up the server url")]),t._v(" "),s("p",[t._v("Before setting up a provider, you need to specify the absolute url of your backend in "),s("code",[t._v("server.js")]),t._v(".")]),t._v(" "),s("p",[s("strong",[t._v("example -")]),t._v(" "),s("code",[t._v("config/server.js")])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("module"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("exports")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" env "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  host"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("env")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'HOST'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'0.0.0.0'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  port"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" env"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("int")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'PORT'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1337")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  url"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("env")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://localhost:1337'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),s("p",[t._v("Later on you will give this url to your provider. "),s("br"),t._v(" For development, some providers accept the use of localhost urls but many don't. In this case we recommand to use "),s("a",{attrs:{href:"https://ngrok.com/docs",target:"_blank",rel:"noopener noreferrer"}},[t._v("ngrok"),s("OutboundLink")],1),t._v(" ("),s("code",[t._v("ngrok http 1337")]),t._v(") that will make a proxy tunnel from a url it created to your localhost url (ex: "),s("code",[t._v("url: env('', 'https://5299e8514242.ngrok.io'),")]),t._v(").")])]),t._v(" "),s("h4",{attrs:{id:"setting-up-the-provider-examples"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#setting-up-the-provider-examples"}},[t._v("#")]),t._v(" Setting up the provider - examples")]),t._v(" "),s("p",[t._v("Instead of a generic explanation, for better understanding, we decided to show an example for each provider.")]),t._v(" "),s("p",[t._v("In the following examples, the frontend app will be the "),s("a",{attrs:{href:"https://github.com/strapi/strapi-examples/tree/master/login-react",target:"_blank",rel:"noopener noreferrer"}},[t._v("react login example app"),s("OutboundLink")],1),t._v(". "),s("br"),t._v("\nIt (the frontend app) will be running on "),s("code",[t._v("http://localhost:3000")]),t._v(". "),s("br"),t._v("\nStrapi (the backend) will be running on "),s("code",[t._v("http://localhost:1337")]),t._v(".")]),t._v(" "),s("Tabs",{attrs:{type:"border-card"}},[s("Tab",{attrs:{label:"GitHub"}},[s("h4",{attrs:{id:"using-ngrok"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#using-ngrok"}},[t._v("#")]),t._v(" Using ngrok")]),t._v(" "),s("p",[t._v("Github doesn't accept "),s("code",[t._v("localhost")]),t._v(" urls. "),s("br"),t._v("\nUse "),s("code",[t._v("ngrok")]),t._v(" to serve the backend app.")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("ngrok http 1337\n")])])]),s("p",[t._v("Don't forget to update the server url in the backend config file "),s("code",[t._v("config/server.js")]),t._v(" and the server url in your frontend app (environment variable "),s("code",[t._v("REACT_APP_BACKEND_URL")]),t._v(" if you use "),s("a",{attrs:{href:"https://github.com/strapi/strapi-examples/tree/master/login-react",target:"_blank",rel:"noopener noreferrer"}},[t._v("react login example app"),s("OutboundLink")],1),t._v(") with the generated ngrok url.")]),t._v(" "),s("h4",{attrs:{id:"github-configuration"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#github-configuration"}},[t._v("#")]),t._v(" Github configuration")]),t._v(" "),s("ul",[s("li",[t._v("Visit the OAuth Apps list page "),s("a",{attrs:{href:"https://github.com/settings/developers",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/settings/developers"),s("OutboundLink")],1)]),t._v(" "),s("li",[t._v("点击 "),s("strong",[t._v("New OAuth App")]),t._v(" button")]),t._v(" "),s("li",[t._v("填充 the information (replace with your own ngrok url):\n"),s("ul",[s("li",[s("strong",[t._v("Application name")]),t._v(": Strapi GitHub auth")]),t._v(" "),s("li",[s("strong",[t._v("Homepage URL")]),t._v(": "),s("code",[t._v("https://65e60559.ngrok.io")])]),t._v(" "),s("li",[s("strong",[t._v("Application description")]),t._v(": Strapi provider auth description")]),t._v(" "),s("li",[s("strong",[t._v("Authorization callback URL")]),t._v(": "),s("code",[t._v("https://65e60559.ngrok.io/connect/github/callback")])])])])]),t._v(" "),s("h4",{attrs:{id:"strapi-configuration"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#strapi-configuration"}},[t._v("#")]),t._v(" Strapi configuration")]),t._v(" "),s("ul",[s("li",[t._v("Visit the User Permissions provider settings page "),s("br"),t._v(" "),s("a",{attrs:{href:"http://localhost:1337/admin/settings/users-permissions/providers",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://localhost:1337/admin/settings/users-permissions/providers"),s("OutboundLink")],1)]),t._v(" "),s("li",[t._v("点击 the "),s("strong",[t._v("GitHub")]),t._v(" provider")]),t._v(" "),s("li",[t._v("填充 the information (replace with your own client ID and secret):\n"),s("ul",[s("li",[s("strong",[t._v("Enable")]),t._v(": "),s("code",[t._v("ON")])]),t._v(" "),s("li",[s("strong",[t._v("Client ID")]),t._v(": 53de5258f8472c140917")]),t._v(" "),s("li",[s("strong",[t._v("Client Secret")]),t._v(": fb9d0fe1d345d9ac7f83d7a1e646b37c554dae8b")]),t._v(" "),s("li",[s("strong",[t._v("The redirect URL to your front-end app")]),t._v(": "),s("code",[t._v("http://localhost:3000/connect/github/redirect")])])])])])]),t._v(" "),s("Tab",{attrs:{label:"Facebook"}},[s("h4",{attrs:{id:"using-ngrok-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#using-ngrok-2"}},[t._v("#")]),t._v(" Using ngrok")]),t._v(" "),s("p",[t._v("Facebook doesn't accept "),s("code",[t._v("localhost")]),t._v(" urls. "),s("br"),t._v("\nUse "),s("code",[t._v("ngrok")]),t._v(" to serve the backend app.")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("ngrok http 1337\n")])])]),s("p",[t._v("Don't forget to update the server url in the backend config file "),s("code",[t._v("config/server.js")]),t._v(" and the server url in your frontend app (environment variable "),s("code",[t._v("REACT_APP_BACKEND_URL")]),t._v(" if you use "),s("a",{attrs:{href:"https://github.com/strapi/strapi-examples/tree/master/login-react",target:"_blank",rel:"noopener noreferrer"}},[t._v("react login example app"),s("OutboundLink")],1),t._v(") with the generated ngrok url.")]),t._v(" "),s("h4",{attrs:{id:"facebook-configuration"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#facebook-configuration"}},[t._v("#")]),t._v(" Facebook configuration")]),t._v(" "),s("ul",[s("li",[t._v("Visit the Developer Apps list page "),s("br"),t._v(" "),s("a",{attrs:{href:"https://developers.facebook.com/apps/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://developers.facebook.com/apps/"),s("OutboundLink")],1)]),t._v(" "),s("li",[t._v("点击 "),s("strong",[t._v("Add a New App")]),t._v(" button")]),t._v(" "),s("li",[t._v("填充 the "),s("strong",[t._v("Display Name")]),t._v(" in the modal and create the app")]),t._v(" "),s("li",[t._v("Setup a "),s("strong",[t._v("Facebook Login")]),t._v(" product")]),t._v(" "),s("li",[t._v("点击 the "),s("strong",[t._v("PRODUCTS > Facebook login > Settings")]),t._v(" link 在左边的菜单里")]),t._v(" "),s("li",[t._v("填充 the information and save (replace with your own ngrok url):\n"),s("ul",[s("li",[s("strong",[t._v("Valid OAuth Redirect URIs")]),t._v(": "),s("code",[t._v("https://65e60559.ngrok.io/connect/facebook/callback")])])])]),t._v(" "),s("li",[t._v("Then, click on "),s("strong",[t._v("Settings")]),t._v(" 在左边的菜单里")]),t._v(" "),s("li",[t._v("然后 on "),s("strong",[t._v("Basic")]),t._v(" link")]),t._v(" "),s("li",[t._v("You should see your Application ID and secret, save them for later")])]),t._v(" "),s("h4",{attrs:{id:"strapi-configuration-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#strapi-configuration-2"}},[t._v("#")]),t._v(" Strapi configuration")]),t._v(" "),s("ul",[s("li",[t._v("Visit the User Permissions provider settings page "),s("br"),t._v(" "),s("a",{attrs:{href:"http://localhost:1337/admin/settings/users-permissions/providers",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://localhost:1337/admin/settings/users-permissions/providers"),s("OutboundLink")],1)]),t._v(" "),s("li",[t._v("点击 the "),s("strong",[t._v("Facebook")]),t._v(" provider")]),t._v(" "),s("li",[t._v("填充 the information (replace with your own client ID and secret):\n"),s("ul",[s("li",[s("strong",[t._v("Enable")]),t._v(": "),s("code",[t._v("ON")])]),t._v(" "),s("li",[s("strong",[t._v("Client ID")]),t._v(": 2408954435875229")]),t._v(" "),s("li",[s("strong",[t._v("Client Secret")]),t._v(": 4fe04b740b69f31ea410b9391ff3b5b0")]),t._v(" "),s("li",[s("strong",[t._v("The redirect URL to your front-end app")]),t._v(": "),s("code",[t._v("http://localhost:3000/connect/facebook/redirect")])])])])])]),t._v(" "),s("Tab",{attrs:{label:"Google"}},[s("h4",{attrs:{id:"using-ngrok-3"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#using-ngrok-3"}},[t._v("#")]),t._v(" Using ngrok")]),t._v(" "),s("p",[t._v("Google accepts the "),s("code",[t._v("localhost")]),t._v(" urls. "),s("br"),t._v("\nThe use of "),s("code",[t._v("ngrok")]),t._v(" is not needed.")]),t._v(" "),s("h4",{attrs:{id:"google-configuration"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#google-configuration"}},[t._v("#")]),t._v(" Google configuration")]),t._v(" "),s("ul",[s("li",[t._v("Visit the Google Developer Console "),s("br"),t._v(" "),s("a",{attrs:{href:"https://console.developers.google.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://console.developers.google.com/"),s("OutboundLink")],1)]),t._v(" "),s("li",[t._v("点击 the "),s("strong",[t._v("Select a project")]),t._v(" dropdown in the top menu")]),t._v(" "),s("li",[t._v("然后 click "),s("strong",[t._v("NEW PROJECT")]),t._v(" button")]),t._v(" "),s("li",[t._v("填充 the "),s("strong",[t._v("Project name")]),t._v(" input and create")])]),t._v(" "),s("p",[t._v("Wait a few seconds while the application is created.")]),t._v(" "),s("ul",[s("li",[t._v("On the project dropdown, select your new project")]),t._v(" "),s("li",[t._v("点击 "),s("strong",[t._v("Go to APIs overview")]),t._v(" under the "),s("strong",[t._v("APIs")]),t._v(" card")]),t._v(" "),s("li",[t._v("然后 click on the "),s("strong",[t._v("Credentials")]),t._v(" link 在左边的菜单里")]),t._v(" "),s("li",[t._v("点击 "),s("strong",[t._v("OAuth consent screen")]),t._v(" button")]),t._v(" "),s("li",[t._v("Choose "),s("strong",[t._v("External")]),t._v(" and click on "),s("strong",[t._v("create")])]),t._v(" "),s("li",[t._v("填充 the "),s("strong",[t._v("Application name")]),t._v(" and save")]),t._v(" "),s("li",[t._v("然后 click on "),s("strong",[t._v("Create credentials")]),t._v(" button")]),t._v(" "),s("li",[t._v("Choose "),s("strong",[t._v("OAuth client ID")]),t._v(" option")]),t._v(" "),s("li",[t._v("填充 the information:\n"),s("ul",[s("li",[s("strong",[t._v("Name")]),t._v(": "),s("code",[t._v("Strapi Auth")])]),t._v(" "),s("li",[s("strong",[t._v("Authorized redirect URIs")]),t._v(": "),s("code",[t._v("http://localhost:1337/connect/google/callback")])])])]),t._v(" "),s("li",[t._v("点击 "),s("strong",[t._v("OAuth 2.0 Client IDs")]),t._v(" name of the client you just created")]),t._v(" "),s("li",[t._v("You should see your Application ID and secret, save them for later")])]),t._v(" "),s("h4",{attrs:{id:"strapi-configuration-3"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#strapi-configuration-3"}},[t._v("#")]),t._v(" Strapi configuration")]),t._v(" "),s("ul",[s("li",[t._v("Visit the User Permissions provider settings page "),s("br"),t._v(" "),s("a",{attrs:{href:"http://localhost:1337/admin/settings/users-permissions/providers",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://localhost:1337/admin/settings/users-permissions/providers"),s("OutboundLink")],1)]),t._v(" "),s("li",[t._v("点击 the "),s("strong",[t._v("Google")]),t._v(" provider")]),t._v(" "),s("li",[t._v("填充 the information (replace with your own client ID and secret):\n"),s("ul",[s("li",[s("strong",[t._v("Enable")]),t._v(": "),s("code",[t._v("ON")])]),t._v(" "),s("li",[s("strong",[t._v("Client ID")]),t._v(": 226437944084-o2mojv5i4lfnng9q8kq3jkf5v03avemk.apps.googleusercontent.com")]),t._v(" "),s("li",[s("strong",[t._v("Client Secret")]),t._v(": aiTbMoiuJQflSBy6uQrfgsni")]),t._v(" "),s("li",[s("strong",[t._v("The redirect URL to your front-end app")]),t._v(": "),s("code",[t._v("http://localhost:3000/connect/google/redirect")])])])])])]),t._v(" "),s("Tab",{attrs:{label:"AWS Cognito"}},[s("h4",{attrs:{id:"using-ngrok-4"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#using-ngrok-4"}},[t._v("#")]),t._v(" Using ngrok")]),t._v(" "),s("p",[t._v("AWS Cognito accepts the "),s("code",[t._v("localhost")]),t._v(" urls. "),s("br"),t._v("\nThe use of "),s("code",[t._v("ngrok")]),t._v(" is not needed.")]),t._v(" "),s("h4",{attrs:{id:"aws-cognito-configuration"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#aws-cognito-configuration"}},[t._v("#")]),t._v(" AWS Cognito configuration")]),t._v(" "),s("ul",[s("li",[t._v("Visit the AWS Management Console "),s("br"),t._v(" "),s("a",{attrs:{href:"https://aws.amazon.com/console/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://aws.amazon.com/console/"),s("OutboundLink")],1)]),t._v(" "),s("li",[t._v("If needed, select your "),s("strong",[t._v("Region")]),t._v(" in the top right corner next to the Support dropdown")]),t._v(" "),s("li",[t._v("选择 "),s("strong",[t._v("Services")]),t._v(" dropdown in the top left corner")]),t._v(" "),s("li",[t._v("点击 "),s("strong",[t._v("Cognito")]),t._v(" in the "),s("code",[t._v("Security, Identity & Compliance")]),t._v(" section")]),t._v(" "),s("li",[t._v("然后 click on the "),s("strong",[t._v("Manage User Pools")]),t._v(" button")]),t._v(" "),s("li",[t._v("If applicable either create or use an existing user pool. You will find hereafter a tutorial to create a User Pool "),s("br"),t._v(" "),s("a",{attrs:{href:"https://docs.aws.amazon.com/cognito/latest/developerguide/tutorial-create-user-pool.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://docs.aws.amazon.com/cognito/latest/developerguide/tutorial-create-user-pool.html"),s("OutboundLink")],1)]),t._v(" "),s("li",[t._v("Go to the "),s("strong",[t._v("App clients")]),t._v(" section in your cognito user pool and create a new client with the name "),s("code",[t._v("Strapi Auth")]),t._v(" and set all the parameters and then click on "),s("strong",[t._v("Create app client")])]),t._v(" "),s("li",[t._v("You should now have an "),s("strong",[t._v("App client id")]),t._v(" and by clicking on the button "),s("strong",[t._v("Show Details")]),t._v(" you will be able to see the "),s("strong",[t._v("App client secret")]),t._v(". Do copy those two values "),s("strong",[t._v("App client id")]),t._v(" and "),s("strong",[t._v("App client secret")]),t._v(" somewhere for later use when configuring the AWS Cognito provider in Strapi.")]),t._v(" "),s("li",[t._v("Go to the "),s("strong",[t._v("App integration section")]),t._v(" and click on "),s("strong",[t._v("App client settings")])]),t._v(" "),s("li",[t._v("Look for your app client named "),s("code",[t._v("Strapi Auth")]),t._v(" and enable Cognito User Pool by checking it in the "),s("strong",[t._v("Enabled Identity Providers")]),t._v(" section of your newly created App client")]),t._v(" "),s("li",[t._v("填充 in your callback URL and Sign out URL with the value "),s("code",[t._v("http://localhost:1337/connect/cognito/callback")]),t._v(" or the one provided by your AWS Cognito provider in Strapi")]),t._v(" "),s("li",[t._v("In the "),s("strong",[t._v("Oauth 2.0")]),t._v(" section select "),s("code",[t._v("Authorization code grant")]),t._v(" and "),s("code",[t._v("Implicit grant")]),t._v(" for the "),s("strong",[t._v("Allowed OAuth Flows")]),t._v(" and select "),s("code",[t._v("email")]),t._v(", "),s("code",[t._v("openid")]),t._v(" and "),s("code",[t._v("profile")]),t._v(" for the "),s("strong",[t._v("Allowed OAuth Scopes")])]),t._v(" "),s("li",[t._v("You can now click on "),s("strong",[t._v("Save changes")]),t._v(" and if you have already configured your domain name then you should be able to see a link to the "),s("strong",[t._v("Launch Hosted UI")]),t._v(". You can click on it in order to display the AWS Cognito login page. In case you haven't yet configured your domain name, use the link "),s("strong",[t._v("Choose domain name")]),t._v(" at the bottom right of the page in order to configure your domain name. On that page you will have an "),s("code",[t._v("Amazon Cognito Domain")]),t._v(" section where a "),s("code",[t._v("Domain prefix")]),t._v(" is already setup. Type a domain prefix to use for the sign-up and sign-in pages that are hosted by Amazon Cognito, this domain prefix together with the "),s("code",[t._v(".auth.YOUR_REGION.amazoncognito.com")]),t._v(" will be the "),s("strong",[t._v("Host URI (Subdomain)")]),t._v(" value for your strapi configuration later on.")])]),t._v(" "),s("h4",{attrs:{id:"strapi-configuration-4"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#strapi-configuration-4"}},[t._v("#")]),t._v(" Strapi configuration")]),t._v(" "),s("ul",[s("li",[t._v("Visit the User Permissions provider settings page "),s("br"),t._v(" "),s("a",{attrs:{href:"http://localhost:1337/admin/settings/users-permissions/providers",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://localhost:1337/admin/settings/users-permissions/providers"),s("OutboundLink")],1)]),t._v(" "),s("li",[t._v("点击 the "),s("strong",[t._v("Cognito")]),t._v(" provider")]),t._v(" "),s("li",[t._v("填充 the information (replace with your own client ID and secret):\n"),s("ul",[s("li",[s("strong",[t._v("Enable")]),t._v(": "),s("code",[t._v("ON")])]),t._v(" "),s("li",[s("strong",[t._v("Client ID")]),t._v(": fill in the "),s("strong",[t._v("App client id")]),t._v(" ("),s("code",[t._v("5bd7a786qdupjmi0b3s10vegdt")]),t._v(")")]),t._v(" "),s("li",[s("strong",[t._v("Client Secret")]),t._v(": fill in the "),s("strong",[t._v("App client secret")]),t._v(" ("),s("code",[t._v("19c5c78dsfsdfssfsdfhpdb4nkpb145vesdfdsfsffgh7vwd6g45jlipbpb")]),t._v(")")]),t._v(" "),s("li",[s("strong",[t._v("Host URI (Subdomain)")]),t._v(": fill in the URL value that you copied earlier ("),s("code",[t._v("myapp67b50345-67b50b17-local.auth.eu-central-1.amazoncognito.com")]),t._v(")")]),t._v(" "),s("li",[s("strong",[t._v("The redirect URL to your front-end app")]),t._v(": if you are using strapi react-login "),s("a",{attrs:{href:"https://github.com/strapi/strapi-examples/tree/master/login-react/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/strapi/strapi-examples/tree/master/login-react/"),s("OutboundLink")],1),t._v(" use "),s("code",[t._v("http://localhost:3000/connect/cognito/redirect")]),t._v(" but if you do not yet have a front-end app to test your Cognito configuration you can then use the following URL "),s("code",[t._v("http://localhost:1337/auth/cognito/callback")])])])])])]),t._v(" "),s("Tab",{attrs:{label:"Twitter"}},[s("h4",{attrs:{id:"using-ngrok-5"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#using-ngrok-5"}},[t._v("#")]),t._v(" Using ngrok")]),t._v(" "),s("p",[t._v("Twitter doesn't accept "),s("code",[t._v("localhost")]),t._v(" urls. "),s("br"),t._v("\nUse "),s("code",[t._v("ngrok")]),t._v(" to serve the backend app.")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("ngrok http 1337\n")])])]),s("p",[t._v("Don't forget to update the server url in the backend config file "),s("code",[t._v("config/server.js")]),t._v(" and the server url in your frontend app (environment variable "),s("code",[t._v("REACT_APP_BACKEND_URL")]),t._v(" if you use "),s("a",{attrs:{href:"https://github.com/strapi/strapi-examples/tree/master/login-react",target:"_blank",rel:"noopener noreferrer"}},[t._v("react login example app"),s("OutboundLink")],1),t._v(") with the generated ngrok url.")]),t._v(" "),s("h4",{attrs:{id:"twitter-configuration"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#twitter-configuration"}},[t._v("#")]),t._v(" Twitter configuration")]),t._v(" "),s("ul",[s("li",[t._v("Visit the Apps list page "),s("br"),t._v(" "),s("a",{attrs:{href:"https://developer.twitter.com/en/apps",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://developer.twitter.com/en/apps"),s("OutboundLink")],1)]),t._v(" "),s("li",[t._v("点击 "),s("strong",[t._v("Create an app")]),t._v(" button")]),t._v(" "),s("li",[t._v("填充 the information (replace with your own ngrok url):\n"),s("ul",[s("li",[s("strong",[t._v("App name")]),t._v(": Strapi Twitter auth")]),t._v(" "),s("li",[s("strong",[t._v("Application description")]),t._v(": This is a demo app for Strapi auth")]),t._v(" "),s("li",[s("strong",[t._v("Tell us how this app will be used")]),t._v(": - here write a message enough long -")])])]),t._v(" "),s("li",[t._v("At the end of the process you should see your Application ID and secret, save them for later")]),t._v(" "),s("li",[t._v("Go to you app setting and click on edit "),s("strong",[t._v("Authentication settings")])]),t._v(" "),s("li",[t._v("Enable "),s("strong",[t._v("3rd party authentication")]),t._v(" AND "),s("strong",[t._v("Request email address from users")])]),t._v(" "),s("li",[t._v("填充 the information (replace with your own ngrok url):\n"),s("ul",[s("li",[s("strong",[t._v("Callback URLs")]),t._v(": "),s("code",[t._v("https://65e60559.ngrok.io/connect/twitter/callback")])]),t._v(" "),s("li",[s("strong",[t._v("Website URL")]),t._v(": "),s("code",[t._v("https://65e60559.ngrok.io")])]),t._v(" "),s("li",[s("strong",[t._v("Privacy policy")]),t._v(": "),s("code",[t._v("https://d73e70e88872.ngrok.io")])]),t._v(" "),s("li",[s("strong",[t._v("Terms of service")]),t._v(": "),s("code",[t._v("https://d73e70e88872.ngrok.io")])])])])]),t._v(" "),s("h4",{attrs:{id:"strapi-configuration-5"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#strapi-configuration-5"}},[t._v("#")]),t._v(" Strapi configuration")]),t._v(" "),s("ul",[s("li",[t._v("Visit the User Permissions provider settings page "),s("br"),t._v(" "),s("a",{attrs:{href:"http://localhost:1337/admin/settings/users-permissions/providers",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://localhost:1337/admin/settings/users-permissions/providers"),s("OutboundLink")],1)]),t._v(" "),s("li",[t._v("点击 the "),s("strong",[t._v("Twitter")]),t._v(" provider")]),t._v(" "),s("li",[t._v("填充 the information (replace with your own client ID and secret):\n"),s("ul",[s("li",[s("strong",[t._v("Enable")]),t._v(": "),s("code",[t._v("ON")])]),t._v(" "),s("li",[s("strong",[t._v("Client ID")]),t._v(": yfN4ycGGmKXiS1njtIYxuN5IH")]),t._v(" "),s("li",[s("strong",[t._v("Client Secret")]),t._v(": Nag1en8S4VwqurBvlW5OaFyKlzqrXFeyWhph6CZlpGA2V3VR3T")]),t._v(" "),s("li",[s("strong",[t._v("The redirect URL to your front-end app")]),t._v(": "),s("code",[t._v("http://localhost:3000/connect/twitter/redirect")])])])])])]),t._v(" "),s("Tab",{attrs:{label:"Discord"}},[s("h4",{attrs:{id:"using-ngrok-6"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#using-ngrok-6"}},[t._v("#")]),t._v(" Using ngrok")]),t._v(" "),s("p",[t._v("Discord accepts the "),s("code",[t._v("localhost")]),t._v(" urls. "),s("br"),t._v("\nThe use of "),s("code",[t._v("ngrok")]),t._v(" is not needed.")]),t._v(" "),s("h4",{attrs:{id:"discord-configuration"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#discord-configuration"}},[t._v("#")]),t._v(" Discord configuration")]),t._v(" "),s("ul",[s("li",[t._v("Visit the Apps list page on the developer portal "),s("br"),t._v(" "),s("a",{attrs:{href:"https://discordapp.com/developers/applications/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://discordapp.com/developers/applications/"),s("OutboundLink")],1)]),t._v(" "),s("li",[t._v("点击 "),s("strong",[t._v("New application")]),t._v(" button")]),t._v(" "),s("li",[t._v("填充 the "),s("strong",[t._v("name")]),t._v(" and create")]),t._v(" "),s("li",[t._v("点击 "),s("strong",[t._v("OAuth2")]),t._v(" 在左边的菜单里")]),t._v(" "),s("li",[t._v("And click on "),s("strong",[t._v("Add redirect")]),t._v(" button")]),t._v(" "),s("li",[t._v("填充 the "),s("strong",[t._v("Redirect")]),t._v(" input with "),s("code",[t._v("http://localhost:1337/connect/discord/callback")]),t._v(" URL and save")]),t._v(" "),s("li",[t._v("点击 "),s("strong",[t._v("General information")]),t._v(" 在左边的菜单里")]),t._v(" "),s("li",[t._v("You should see your Application ID and secret, save them for later")])]),t._v(" "),s("h4",{attrs:{id:"strapi-configuration-6"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#strapi-configuration-6"}},[t._v("#")]),t._v(" Strapi configuration")]),t._v(" "),s("ul",[s("li",[t._v("Visit the User Permissions provider settings page "),s("br"),t._v(" "),s("a",{attrs:{href:"http://localhost:1337/admin/settings/users-permissions/providers",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://localhost:1337/admin/settings/users-permissions/providers"),s("OutboundLink")],1)]),t._v(" "),s("li",[t._v("点击 the "),s("strong",[t._v("Discord")]),t._v(" provider")]),t._v(" "),s("li",[t._v("填充 the information (replace with your own client ID and secret):\n"),s("ul",[s("li",[s("strong",[t._v("Enable")]),t._v(": "),s("code",[t._v("ON")])]),t._v(" "),s("li",[s("strong",[t._v("Client ID")]),t._v(": 665118465148846081")]),t._v(" "),s("li",[s("strong",[t._v("Client Secret")]),t._v(": iJbr7mkyqyut-J2hGvvSDch_5Dw5U77J")]),t._v(" "),s("li",[s("strong",[t._v("The redirect URL to your front-end app")]),t._v(": "),s("code",[t._v("http://localhost:3000/connect/discord/redirect")])])])])])]),t._v(" "),s("Tab",{attrs:{label:"Twitch"}},[s("h4",{attrs:{id:"using-ngrok-7"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#using-ngrok-7"}},[t._v("#")]),t._v(" Using ngrok")]),t._v(" "),s("p",[t._v("Discord accepts the "),s("code",[t._v("localhost")]),t._v(" urls. "),s("br"),t._v("\nThe use of "),s("code",[t._v("ngrok")]),t._v(" is not needed.")]),t._v(" "),s("h4",{attrs:{id:"twitch-configuration"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#twitch-configuration"}},[t._v("#")]),t._v(" Twitch configuration")]),t._v(" "),s("ul",[s("li",[t._v("Visit the Apps list page on the developer console "),s("br"),t._v(" "),s("a",{attrs:{href:"https://dev.twitch.tv/console/apps",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://dev.twitch.tv/console/apps"),s("OutboundLink")],1)]),t._v(" "),s("li",[t._v("点击 "),s("strong",[t._v("Register Your Application")]),t._v(" button")]),t._v(" "),s("li",[t._v("填充 the information:\n"),s("ul",[s("li",[s("strong",[t._v("Name")]),t._v(": Strapi auth")]),t._v(" "),s("li",[s("strong",[t._v("OAuth Redirect URLs")]),t._v(": "),s("code",[t._v("http://localhost:1337/connect/twitch/callback")])]),t._v(" "),s("li",[s("strong",[t._v("Category")]),t._v(": Choose a category")])])]),t._v(" "),s("li",[t._v("点击 "),s("strong",[t._v("Manage")]),t._v(" button of your new app")]),t._v(" "),s("li",[t._v("Generate a new "),s("strong",[t._v("Client Secret")]),t._v(" with the "),s("strong",[t._v("New Secret")]),t._v(" button")]),t._v(" "),s("li",[t._v("You should see your Application ID and secret, save them for later")])]),t._v(" "),s("h4",{attrs:{id:"strapi-configuration-7"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#strapi-configuration-7"}},[t._v("#")]),t._v(" Strapi configuration")]),t._v(" "),s("ul",[s("li",[t._v("Visit the User Permissions provider settings page "),s("br"),t._v(" "),s("a",{attrs:{href:"http://localhost:1337/admin/settings/users-permissions/providers",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://localhost:1337/admin/settings/users-permissions/providers"),s("OutboundLink")],1)]),t._v(" "),s("li",[t._v("点击 the "),s("strong",[t._v("Twitch")]),t._v(" provider")]),t._v(" "),s("li",[t._v("填充 the information (replace with your own client ID and secret):\n"),s("ul",[s("li",[s("strong",[t._v("Enable")]),t._v(": "),s("code",[t._v("ON")])]),t._v(" "),s("li",[s("strong",[t._v("Client ID")]),t._v(": amuy279g8wt68qlht3u4gek4oykh5j")]),t._v(" "),s("li",[s("strong",[t._v("Client Secret")]),t._v(": dapssh10uo97gg2l25qufr8wen3yr6")]),t._v(" "),s("li",[s("strong",[t._v("The redirect URL to your front-end app")]),t._v(": "),s("code",[t._v("http://localhost:3000/connect/twitch/redirect")])])])])])]),t._v(" "),s("Tab",{attrs:{label:"Instagram"}},[s("h4",{attrs:{id:"using-ngrok-8"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#using-ngrok-8"}},[t._v("#")]),t._v(" Using ngrok")]),t._v(" "),s("p",[t._v("Facebook doesn't accept "),s("code",[t._v("localhost")]),t._v(" urls. "),s("br"),t._v("\nUse "),s("code",[t._v("ngrok")]),t._v(" to serve the backend app.")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("ngrok http 1337\n")])])]),s("p",[t._v("Don't forget to update the server url in the backend config file "),s("code",[t._v("config/server.js")]),t._v(" and the server url in your frontend app (environment variable "),s("code",[t._v("REACT_APP_BACKEND_URL")]),t._v(" if you use "),s("a",{attrs:{href:"https://github.com/strapi/strapi-examples/tree/master/login-react",target:"_blank",rel:"noopener noreferrer"}},[t._v("react login example app"),s("OutboundLink")],1),t._v(") with the generated ngrok url.")]),t._v(" "),s("h4",{attrs:{id:"instagram-configuration"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#instagram-configuration"}},[t._v("#")]),t._v(" Instagram configuration")]),t._v(" "),s("ul",[s("li",[t._v("Visit the Developer Apps list page "),s("br"),t._v(" "),s("a",{attrs:{href:"https://developers.facebook.com/apps/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://developers.facebook.com/apps/"),s("OutboundLink")],1)]),t._v(" "),s("li",[t._v("点击 "),s("strong",[t._v("Add a New App")]),t._v(" button")]),t._v(" "),s("li",[t._v("填充 the "),s("strong",[t._v("Display Name")]),t._v(" in the modal and create the app")]),t._v(" "),s("li",[t._v("Setup an "),s("strong",[t._v("Instagram")]),t._v(" product")]),t._v(" "),s("li",[t._v("点击 the "),s("strong",[t._v("PRODUCTS > Instagram > Basic Display")]),t._v(" link 在左边的菜单里")]),t._v(" "),s("li",[t._v("然后 click on the "),s("strong",[t._v("Create new application")]),t._v(" button (and valid the modal)")]),t._v(" "),s("li",[t._v("填充 the information (replace with your own ngrok url):\n"),s("ul",[s("li",[s("strong",[t._v("Valid OAuth Redirect URIs")]),t._v(": "),s("code",[t._v("https://65e60559.ngrok.io/connect/instagram/callback")])]),t._v(" "),s("li",[s("strong",[t._v("Deauthorize")]),t._v(": "),s("code",[t._v("https://65e60559.ngrok.io")])]),t._v(" "),s("li",[s("strong",[t._v("Data Deletion Requests")]),t._v(": "),s("code",[t._v("https://65e60559.ngrok.io")])])])]),t._v(" "),s("li",[t._v("On the "),s("strong",[t._v("App Review for Instagram Basic Display")]),t._v(" click on "),s("strong",[t._v("Add to submission")]),t._v(" for "),s("strong",[t._v("instagram_graph_user_profile")]),t._v(".")]),t._v(" "),s("li",[t._v("You should see your Application ID and secret, save them for later")])]),t._v(" "),s("h4",{attrs:{id:"strapi-configuration-8"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#strapi-configuration-8"}},[t._v("#")]),t._v(" Strapi configuration")]),t._v(" "),s("ul",[s("li",[t._v("Visit the User Permissions provider settings page "),s("br"),t._v(" "),s("a",{attrs:{href:"http://localhost:1337/admin/settings/users-permissions/providers",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://localhost:1337/admin/settings/users-permissions/providers"),s("OutboundLink")],1)]),t._v(" "),s("li",[t._v("点击 the "),s("strong",[t._v("Instagram")]),t._v(" provider")]),t._v(" "),s("li",[t._v("填充 the information (replace with your own client ID and secret):\n"),s("ul",[s("li",[s("strong",[t._v("Enable")]),t._v(": "),s("code",[t._v("ON")])]),t._v(" "),s("li",[s("strong",[t._v("Client ID")]),t._v(": 563883201184965")]),t._v(" "),s("li",[s("strong",[t._v("Client Secret")]),t._v(": f5ba10a7dd78c2410ab6b8a35ab28226")]),t._v(" "),s("li",[s("strong",[t._v("The redirect URL to your front-end app")]),t._v(": "),s("code",[t._v("http://localhost:3000/connect/instagram/redirect")])])])])])]),t._v(" "),s("Tab",{attrs:{label:"VK"}},[s("h4",{attrs:{id:"using-ngrok-9"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#using-ngrok-9"}},[t._v("#")]),t._v(" Using ngrok")]),t._v(" "),s("p",[t._v("Discord accepts the "),s("code",[t._v("localhost")]),t._v(" urls. "),s("br"),t._v("\nThe use of "),s("code",[t._v("ngrok")]),t._v(" is not needed.")]),t._v(" "),s("h4",{attrs:{id:"vk-configuration"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#vk-configuration"}},[t._v("#")]),t._v(" VK configuration")]),t._v(" "),s("ul",[s("li",[t._v("Visit the Apps list page "),s("br"),t._v(" "),s("a",{attrs:{href:"https://vk.com/apps?act=manage",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://vk.com/apps?act=manage"),s("OutboundLink")],1)]),t._v(" "),s("li",[t._v("点击 "),s("strong",[t._v("Create app")]),t._v(" button")]),t._v(" "),s("li",[t._v("填充 the information:\n"),s("ul",[s("li",[s("strong",[t._v("Title")]),t._v(": Strapi auth")]),t._v(" "),s("li",[s("strong",[t._v("Platform")]),t._v(": Choose "),s("strong",[t._v("Website")]),t._v(" option")]),t._v(" "),s("li",[s("strong",[t._v("Website address")]),t._v(": "),s("code",[t._v("http://localhost:1337")])]),t._v(" "),s("li",[s("strong",[t._v("Base domain")]),t._v(": "),s("code",[t._v("localhost")])])])]),t._v(" "),s("li",[t._v("点击 the "),s("strong",[t._v("Settings")]),t._v(" link 在左边的菜单里")]),t._v(" "),s("li",[t._v("点击 the "),s("strong",[t._v("Open API")]),t._v(" link to enable this option")]),t._v(" "),s("li",[t._v("填充 the information:\n"),s("ul",[s("li",[s("strong",[t._v("Authorized redirect URL")]),t._v(": "),s("code",[t._v("http://localhost:1337/connect/vk/callback")])])])])]),t._v(" "),s("h4",{attrs:{id:"strapi-configuration-9"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#strapi-configuration-9"}},[t._v("#")]),t._v(" Strapi configuration")]),t._v(" "),s("ul",[s("li",[t._v("Visit the User Permissions provider settings page "),s("br"),t._v(" "),s("a",{attrs:{href:"http://localhost:1337/admin/settings/users-permissions/providers",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://localhost:1337/admin/settings/users-permissions/providers"),s("OutboundLink")],1)]),t._v(" "),s("li",[t._v("点击 the "),s("strong",[t._v("VK")]),t._v(" provider")]),t._v(" "),s("li",[t._v("填充 the information:\n"),s("ul",[s("li",[s("strong",[t._v("Enable")]),t._v(": "),s("code",[t._v("ON")])]),t._v(" "),s("li",[s("strong",[t._v("Client ID")]),t._v(": 7276416")]),t._v(" "),s("li",[s("strong",[t._v("Client Secret")]),t._v(": cFBUSghLXGuxqnCyw1N3")]),t._v(" "),s("li",[s("strong",[t._v("The redirect URL to your front-end app")]),t._v(": "),s("code",[t._v("http://localhost:3000/connect/vk/redirect")])])])])])]),t._v(" "),s("Tab",{attrs:{label:"LinkedIn"}},[s("h4",{attrs:{id:"using-ngrok-10"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#using-ngrok-10"}},[t._v("#")]),t._v(" Using ngrok")]),t._v(" "),s("p",[t._v("LinkedIn accepts the "),s("code",[t._v("localhost")]),t._v(" urls. "),s("br"),t._v("\nThe use of "),s("code",[t._v("ngrok")]),t._v(" is not needed.")]),t._v(" "),s("h4",{attrs:{id:"linkedin-configuration"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#linkedin-configuration"}},[t._v("#")]),t._v(" LinkedIn configuration")]),t._v(" "),s("ul",[s("li",[t._v("Visit the Apps list page "),s("br"),t._v(" "),s("a",{attrs:{href:"https://www.linkedin.com/developers/apps",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://www.linkedin.com/developers/apps"),s("OutboundLink")],1)]),t._v(" "),s("li",[t._v("点击 "),s("strong",[t._v("Create app")]),t._v(" button")]),t._v(" "),s("li",[t._v("填充 the information:\n"),s("ul",[s("li",[s("strong",[t._v("App name")]),t._v(": Strapi auth")]),t._v(" "),s("li",[s("strong",[t._v("LinkedIn Page")]),t._v(": Enter a LinkedIn page name to associate with the app or click "),s("strong",[t._v("Create a new LinkedIn Page")]),t._v(" to create a new one")]),t._v(" "),s("li",[s("strong",[t._v("App Logo")]),t._v(": Upload a square image that is at least 100x100 pixels.")])])]),t._v(" "),s("li",[t._v("点击 the "),s("strong",[t._v("Create app")]),t._v(" to create the app")]),t._v(" "),s("li",[t._v("On the app page click on "),s("strong",[t._v("Auth")]),t._v(" tab")]),t._v(" "),s("li",[t._v("填充 the information:\n"),s("ul",[s("li",[s("strong",[t._v("Authorized redirect URL")]),t._v(": "),s("code",[t._v("http://localhost:1337/connect/linkedin/callback")])])])]),t._v(" "),s("li",[t._v("On the app page click on "),s("strong",[t._v("Products")]),t._v(" tab.")]),t._v(" "),s("li",[t._v("Select "),s("code",[t._v("Sign In with LinkedIn")]),t._v(" from the product list to enable it.")])]),t._v(" "),s("h4",{attrs:{id:"strapi-configuration-10"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#strapi-configuration-10"}},[t._v("#")]),t._v(" Strapi configuration")]),t._v(" "),s("ul",[s("li",[t._v("Visit the User Permissions provider settings page "),s("br"),t._v(" "),s("a",{attrs:{href:"http://localhost:1337/admin/settings/users-permissions/providers",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://localhost:1337/admin/settings/users-permissions/providers"),s("OutboundLink")],1)]),t._v(" "),s("li",[t._v("点击 the "),s("strong",[t._v("LinkedIn")]),t._v(" provider")]),t._v(" "),s("li",[t._v("填充 the information:\n"),s("ul",[s("li",[s("strong",[t._v("Enable")]),t._v(": "),s("code",[t._v("ON")])]),t._v(" "),s("li",[s("strong",[t._v("Client ID")]),t._v(": 84witsxk641rlv")]),t._v(" "),s("li",[s("strong",[t._v("Client Secret")]),t._v(": HdXO7a7mkrU5a6WN")]),t._v(" "),s("li",[s("strong",[t._v("The redirect URL to your front-end app")]),t._v(": "),s("code",[t._v("http://localhost:3000/connect/linkedin/redirect")])])])])])]),t._v(" "),s("Tab",{attrs:{label:"Reddit"}},[s("h4",{attrs:{id:"using-ngrok-11"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#using-ngrok-11"}},[t._v("#")]),t._v(" Using ngrok")]),t._v(" "),s("p",[t._v("Reddit accepts the "),s("code",[t._v("localhost")]),t._v(" urls. "),s("br"),t._v("\nThe use of "),s("code",[t._v("ngrok")]),t._v(" is not needed.")]),t._v(" "),s("h4",{attrs:{id:"reddit-configuration"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#reddit-configuration"}},[t._v("#")]),t._v(" Reddit configuration")]),t._v(" "),s("ul",[s("li",[t._v("Visit the Reddit authorized applications preferences page "),s("br"),t._v(" "),s("a",{attrs:{href:"https://www.reddit.com/prefs/apps",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://www.reddit.com/prefs/apps"),s("OutboundLink")],1)]),t._v(" "),s("li",[t._v("点击 the "),s("strong",[t._v("create another app...")]),t._v(" button near the bottom")]),t._v(" "),s("li",[t._v("Select "),s("strong",[t._v("web app")]),t._v(" for the type")]),t._v(" "),s("li",[t._v("填充 the "),s("strong",[t._v("name")]),t._v(" and "),s("strong",[t._v("redirect uri")]),t._v(" input in")]),t._v(" "),s("li",[t._v("点击 "),s("strong",[t._v("create app")]),t._v(" button")]),t._v(" "),s("li",[t._v("Note that the "),s("strong",[t._v("Client ID")]),t._v(" is located under the app type (web app)")])]),t._v(" "),s("h4",{attrs:{id:"strapi-configuration-11"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#strapi-configuration-11"}},[t._v("#")]),t._v(" Strapi configuration")]),t._v(" "),s("ul",[s("li",[t._v("Visit the User Permissions provider settings page "),s("br"),t._v(" "),s("a",{attrs:{href:"http://localhost:1337/admin/settings/users-permissions/providers",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://localhost:1337/admin/settings/users-permissions/providers"),s("OutboundLink")],1)]),t._v(" "),s("li",[t._v("点击 the "),s("strong",[t._v("Reddit")]),t._v(" provider")]),t._v(" "),s("li",[t._v("填充 the information (replace with your own client ID and secret):\n"),s("ul",[s("li",[s("strong",[t._v("Enable")]),t._v(": "),s("code",[t._v("ON")])]),t._v(" "),s("li",[s("strong",[t._v("Client ID")]),t._v(": hmxSBOit0SCjSQ")]),t._v(" "),s("li",[s("strong",[t._v("Client Secret")]),t._v(": gwR9hCjK_PMYVYNGeDLS4WLB8g7xqg")]),t._v(" "),s("li",[s("strong",[t._v("The redirect URL to your front-end app")]),t._v(": "),s("code",[t._v("http://localhost:3000/connect/reddit/redirect")])])])])])]),t._v(" "),s("Tab",{attrs:{label:"Auth0"}},[s("h4",{attrs:{id:"using-ngrok-12"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#using-ngrok-12"}},[t._v("#")]),t._v(" Using ngrok")]),t._v(" "),s("p",[t._v("Auth0 accepts the "),s("code",[t._v("localhost")]),t._v(" urls. "),s("br"),t._v("\nThe use of "),s("code",[t._v("ngrok")]),t._v(" is not needed.")]),t._v(" "),s("h4",{attrs:{id:"auth0-configuration"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#auth0-configuration"}},[t._v("#")]),t._v(" Auth0 configuration")]),t._v(" "),s("ul",[s("li",[t._v("Visit your Auth0 tenant dashboard")]),t._v(" "),s("li",[t._v("In API section, create a new API")]),t._v(" "),s("li",[t._v("In application, create a "),s("code",[t._v("machine-to-machine")]),t._v(" application and select the API that you have just created")]),t._v(" "),s("li",[t._v("In settings of this app set these values:\n"),s("ul",[s("li",[s("strong",[t._v("Allowed Callback URLs")]),t._v(": "),s("code",[t._v("http://localhost:1337/connect/auth0/callback")])]),t._v(" "),s("li",[s("strong",[t._v("Allowed Logout URLs")]),t._v(": "),s("code",[t._v("http://localhost:3000")])]),t._v(" "),s("li",[s("strong",[t._v("Allowed Web Origins")]),t._v(": "),s("code",[t._v("http://localhost:3000")])])])]),t._v(" "),s("li",[t._v('At the bottom of settings, show "Advanced Settings" and go to the "Grant Types". Ensure that these grants are checked/enabled:\n'),s("ul",[s("li",[t._v("Implicit")]),t._v(" "),s("li",[t._v("Authorization Code")]),t._v(" "),s("li",[t._v("Refresh Token")]),t._v(" "),s("li",[t._v("Client Credentials")])])])]),t._v(" "),s("h4",{attrs:{id:"strapi-configuration-12"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#strapi-configuration-12"}},[t._v("#")]),t._v(" Strapi configuration")]),t._v(" "),s("ul",[s("li",[t._v("Visit the User Permissions provider settings page "),s("br"),t._v(" "),s("a",{attrs:{href:"http://localhost:1337/admin/settings/users-permissions/providers",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://localhost:1337/admin/settings/users-permissions/providers"),s("OutboundLink")],1)]),t._v(" "),s("li",[t._v("点击 the "),s("strong",[t._v("Auth0")]),t._v(" provider")]),t._v(" "),s("li",[t._v("填充 the information:\n"),s("ul",[s("li",[t._v("Enable: "),s("code",[t._v("ON")])]),t._v(" "),s("li",[t._v("Client ID: "),s("code",[t._v("<Your Auth0 Client ID>")])]),t._v(" "),s("li",[t._v("Client ID: "),s("code",[t._v("<Your Auth0 Client Secret>")])]),t._v(" "),s("li",[t._v("Subdomain: "),s("code",[t._v("<Your Auth0 tenant url>")]),t._v(", example it is the part in bold in the following url: https://"),s("strong",[t._v("my-tenant.eu")]),t._v(".auth0.com/")]),t._v(" "),s("li",[t._v("The redirect URL to your front-end app: "),s("code",[t._v("http://localhost:3000/connect/auth0")])])])])])])],1),t._v(" "),s("p",[t._v("Your configuration is done.\nLaunch the backend and the "),s("a",{attrs:{href:"https://github.com/strapi/strapi-examples/tree/master/login-react",target:"_blank",rel:"noopener noreferrer"}},[t._v("react login example app"),s("OutboundLink")],1),t._v(", go to "),s("code",[t._v("http://localhost:3000")]),t._v(" and try to connect to the provider your configured. It should work 🎉")]),t._v(" "),s("h4",{attrs:{id:"what-you-have-to-do-in-your-frontend"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#what-you-have-to-do-in-your-frontend"}},[t._v("#")]),t._v(" What you have to do in your frontend")]),t._v(" "),s("p",[t._v("Once you have configured strapi and the provider, in your frontend app you have to :")]),t._v(" "),s("ul",[s("li",[t._v("创建 a button that links to "),s("code",[t._v("GET STRAPI_BACKEND_URL/connect/${provider}")]),t._v(" (ex: "),s("code",[t._v("https://strapi.mywebsite/connect/github")]),t._v(").")]),t._v(" "),s("li",[t._v("创建 a frontend route like "),s("code",[t._v("FRONTEND_URL/connect/${provider}/redirect")]),t._v(" that have to handle the "),s("code",[t._v("access_token")]),t._v(" param and that have to request "),s("code",[t._v("STRAPI_BACKEND_URL/auth/${provider}/callback")]),t._v(" with the "),s("code",[t._v("access_token")]),t._v(" param. "),s("br"),t._v("\nThe JSON request response will be "),s("code",[t._v('{ "jwt": "...", "user": {...} }')]),t._v(".")])]),t._v(" "),s("p",[t._v("Now you can make authenticated requests 🎉 More info here: "),s("a",{attrs:{href:"#token-usage"}},[t._v("token usage")]),t._v(".")]),t._v(" "),s("div",{staticClass:"custom-block warning"},[s("p",{staticClass:"custom-block-title"},[t._v("Troubleshooting")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("Error 429")]),t._v(": It's most likely because your login flow fell into a loop. To make new requests to the backend, you need to wait a few minutes or restart the backend.")]),t._v(" "),s("li",[s("strong",[t._v("Grant: missing session or misconfigured provider")]),t._v(": It may be due to many things.\n"),s("ul",[s("li",[s("strong",[t._v("The redirect url can't be built")]),t._v(": Make sure you have set the backend url in "),s("code",[t._v("config/server.js")]),t._v(": "),s("a",{attrs:{href:"#setting-up-the-server-url"}},[t._v("Setting up the server url")])]),t._v(" "),s("li",[s("strong",[t._v("A session/cookie/cache problem")]),t._v(": You can try again in a private tab.")]),t._v(" "),s("li",[s("strong",[t._v("The incorrect use of a domain with ngrok")]),t._v(": Check your urls and make sure that you use the ngrok url instead of "),s("code",[t._v("http://localhost:1337")]),t._v(". Don't forget to check the backend url set in the example app at "),s("code",[t._v("src/config.js")]),t._v(".")])])]),t._v(" "),s("li",[s("strong",[t._v("You can't access your admin panel")]),t._v(": It's most likely because you built it with the backend url set with a ngrok url and you stopped/restarted ngrok. You need to replace the backend url with the new ngrok url and run "),s("code",[t._v("yarn build")]),t._v(" or "),s("code",[t._v("npm run build")]),t._v(" again.")])])]),t._v(" "),s("h3",{attrs:{id:"forgotten-reset-password"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#forgotten-reset-password"}},[t._v("#")]),t._v(" Forgotten & reset password")]),t._v(" "),s("p",[s("strong",[t._v("Can only be used for users registered using the email provider.")])]),t._v(" "),s("p",[t._v("The flow was thought this way:")]),t._v(" "),s("ol",[s("li",[t._v("The user goes to your "),s("strong",[t._v("forgotten password page")])]),t._v(" "),s("li",[t._v("The user enters his/her email address")]),t._v(" "),s("li",[t._v("Your forgotten password page sends a request to the backend to send an email with the reset password link to the user")]),t._v(" "),s("li",[t._v("The user receives the email, and clicks on the special link")]),t._v(" "),s("li",[t._v("The link redirects the user to your "),s("strong",[t._v("reset password page")])]),t._v(" "),s("li",[t._v("The user enters his/her new password")]),t._v(" "),s("li",[t._v("The "),s("strong",[t._v("reset password page")]),t._v(" sends a request to the backend with the new password")]),t._v(" "),s("li",[t._v("If the request contains the code contained in the link at step 3., the password is updated")]),t._v(" "),s("li",[t._v("The user can log in with the new password")])]),t._v(" "),s("p",[t._v("In the following section we will detail steps 3. and 7..")]),t._v(" "),s("h4",{attrs:{id:"forgotten-password-ask-for-the-reset-password-link"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#forgotten-password-ask-for-the-reset-password-link"}},[t._v("#")]),t._v(" Forgotten password: ask for the reset password link")]),t._v(" "),s("p",[t._v("This action sends an email to a user with the link to your own reset password page.\nThe link will be enriched with the url param "),s("code",[t._v("code")]),t._v(" that is needed for the "),s("a",{attrs:{href:"#reset-password"}},[t._v("reset password")]),t._v(" at step 7..")]),t._v(" "),s("p",[t._v("First, you must specify the url to your reset password page in the admin panel: "),s("strong",[t._v("Settings > USERS & PERMISSIONS PLUGIN > Advanced Settings > Reset Password Page")]),t._v(".")]),t._v(" "),s("p",[t._v("Then, your "),s("strong",[t._v("forgotten password page")]),t._v(" has to make the following request to your backend.")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" axios "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'axios'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Request API.")]),t._v("\naxios\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("post")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://localhost:1337/auth/forgot-password'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    email"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'user@strapi.io'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// user's email")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("response")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Your user received an email'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("catch")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("error")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'An error occurred:'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" error"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("response"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h4",{attrs:{id:"reset-password-send-the-new-password"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#reset-password-send-the-new-password"}},[t._v("#")]),t._v(" Reset Password: send the new password")]),t._v(" "),s("p",[t._v("This action will update the user password.\nAlso works with the "),s("RouterLink",{attrs:{to:"/developer-docs/latest/development/plugins/graphql.html"}},[t._v("GraphQL Plugin")]),t._v(", with the "),s("code",[t._v("resetPassword")]),t._v(" mutation.")],1),t._v(" "),s("p",[t._v("Your "),s("strong",[t._v("reset password page")]),t._v(" has to make the following request to your backend.")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" axios "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'axios'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Request API.")]),t._v("\naxios\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("post")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://localhost:1337/auth/reset-password'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    code"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'privateCode'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// code contained in the reset link of step 3.")]),t._v("\n    password"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'userNewPassword'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    passwordConfirmation"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'userNewPassword'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("response")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Your user\'s password has been reset."')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("catch")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("error")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'An error occurred:'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" error"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("response"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("Congrats, you're done!")]),t._v(" "),s("h3",{attrs:{id:"email-validation"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#email-validation"}},[t._v("#")]),t._v(" Email validation")]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("NOTE")]),t._v(" "),s("p",[t._v("In production, make sure the "),s("code",[t._v("url")]),t._v(" config property is set. Otherwise the validation link will redirect to "),s("code",[t._v("localhost")]),t._v(". More info on the config "),s("RouterLink",{attrs:{to:"/developer-docs/latest/setup-deployment-guides/configurations.html#server"}},[t._v("这里")]),t._v(".")],1)]),t._v(" "),s("p",[t._v("After having registered, if you have set "),s("strong",[t._v("Enable email confirmation")]),t._v(" to "),s("strong",[t._v("ON")]),t._v(", the user will receive a confirmation link by email. The user has to click on it to validate his/her registration.")]),t._v(" "),s("p",[s("em",[t._v("Example of the confirmation link:")]),t._v(" "),s("code",[t._v("https://yourwebsite.com/auth/email-confirmation?confirmation=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6MywiaWF0IjoxNTk0OTgxMTE3LCJleHAiOjE1OTc1NzMxMTd9.0WeB-mvuguMyr4eY8CypTZDkunR--vZYzZH6h6sChFg")])]),t._v(" "),s("p",[t._v("If needed, you can re-send the confirmation email by making the following request.")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" axios "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'axios'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Request API.")]),t._v("\naxios\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("post")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token template-string"}},[s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("http://localhost:1337/auth/send-email-confirmation")]),s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    email"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'user@strapi.io'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// user's email")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("response")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Your user received an email'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("catch")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("error")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("error")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'An error occurred:'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" error"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("response"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h2",{attrs:{id:"user-object-in-strapi-context"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#user-object-in-strapi-context"}},[t._v("#")]),t._v(" User object in Strapi context")]),t._v(" "),s("p",[t._v("The "),s("code",[t._v("user")]),t._v(" object is available to successfully authenticated requests.")]),t._v(" "),s("h4",{attrs:{id:"usage-3"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#usage-3"}},[t._v("#")]),t._v(" Usage")]),t._v(" "),s("ul",[s("li",[t._v("The authenticated "),s("code",[t._v("user")]),t._v(" object is a property of "),s("code",[t._v("ctx.state")]),t._v(".")])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("create")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("ctx")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" id "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" ctx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("user"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" depositObj "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("ctx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("request"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("body"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    depositor"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" data "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" strapi"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("services"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("deposit"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("depositObj"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Send 201 `created`")]),t._v("\n  ctx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("created")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h2",{attrs:{id:"adding-a-new-provider-to-your-project"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#adding-a-new-provider-to-your-project"}},[t._v("#")]),t._v(" Adding a new provider (to your project)")]),t._v(" "),s("p",[s("strong",[s("a",{attrs:{href:"https://github.com/simov/grant",target:"_blank",rel:"noopener noreferrer"}},[t._v("Grant"),s("OutboundLink")],1),t._v(" supplies configuration for a number of commonly used OAuth providers. "),s("a",{attrs:{href:"https://github.com/simov/grant#misc-custom-providers",target:"_blank",rel:"noopener noreferrer"}},[t._v("Custom"),s("OutboundLink")],1),t._v(" providers are also supported")]),t._v(". "),s("br"),t._v(" You can view and try out the 200+ supported providers here: "),s("a",{attrs:{href:"https://grant.outofindex.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("OAuth Playground"),s("OutboundLink")],1),t._v(".")]),t._v(" "),s("h3",{attrs:{id:"prepare-your-files"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#prepare-your-files"}},[t._v("#")]),t._v(" Prepare your files")]),t._v(" "),s("p",[t._v("To add a new provider on Strapi, you will need to perform changes onto the following files:")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("extensions/users-permissions/services/Providers.js\nextensions/users-permissions/config/functions/bootstrap.js\n")])])]),s("p",[t._v("If these files don't exist you will need to copy from your "),s("code",[t._v("node_modules")]),t._v(" or the Strapi mono-repo. You can see "),s("RouterLink",{attrs:{to:"/developer-docs/latest/development/plugin-customization.html"}},[t._v("plugin extensions")]),t._v(" 了解详情 on how it works.")],1),t._v(" "),s("p",[t._v("We will go step by step.")]),t._v(" "),s("h3",{attrs:{id:"configure-your-provider-request"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#configure-your-provider-request"}},[t._v("#")]),t._v(" Configure your Provider Request")]),t._v(" "),s("p",[t._v("Configure the new provider in the "),s("code",[t._v("Provider.js")]),t._v(" file at the "),s("code",[t._v("getProfile")]),t._v(" function.")]),t._v(" "),s("p",[t._v("The "),s("code",[t._v("getProfile")]),t._v(" takes three params:")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("provider")]),t._v(": The name of the used provider as a string.")]),t._v(" "),s("li",[s("strong",[t._v("query")]),t._v(": The query is the result of the provider callback.")]),t._v(" "),s("li",[s("strong",[t._v("callback")]),t._v(": The callback function who will continue the internal Strapi login logic.")])]),t._v(" "),s("p",[t._v("Here is an example that uses the "),s("code",[t._v("discord")]),t._v(" provider.")]),t._v(" "),s("h3",{attrs:{id:"configure-your-oauth-generic-information"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#configure-your-oauth-generic-information"}},[t._v("#")]),t._v(" Configure your oauth generic information")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'discord'")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" discord "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Purest")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    provider"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'discord'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    config"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'discord'")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'https://discordapp.com/api/'")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'__domain'")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'auth'")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n              "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'auth'")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'bearer'")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'[0]'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'{endpoint}'")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'__path'")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n              "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'alias'")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'__default'")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("This code creates a "),s("code",[t._v("Purest")]),t._v(" object that gives us a generic way to interact with the provider's REST API.")]),t._v(" "),s("p",[t._v("For more specs on using the "),s("code",[t._v("Purest")]),t._v(" module, 访问 the "),s("a",{attrs:{href:"https://github.com/simov/purest",target:"_blank",rel:"noopener noreferrer"}},[t._v("Official Purest 文档"),s("OutboundLink")],1)]),t._v(" "),s("p",[t._v("You may also want to take a look onto the numerous already made configurations "),s("a",{attrs:{href:"https://github.com/simov/purest-providers/blob/master/config/providers.json",target:"_blank",rel:"noopener noreferrer"}},[t._v("这里"),s("OutboundLink")],1),t._v(".")]),t._v(" "),s("h3",{attrs:{id:"retrieve-your-user-s-information"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#retrieve-your-user-s-information"}},[t._v("#")]),t._v(" Retrieve your user's information:")]),t._v(" "),s("p",[t._v("For our discord provider it will look like:")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("  discord"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("query")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'users/@me'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("auth")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("access_token"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("request")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("err"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" body")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("err"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("callback")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("err"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Combine username and discriminator because discord username is not unique")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" username "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token template-string"}},[s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("body"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("username"),s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("#")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("body"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("discriminator"),s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("callback")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        username"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        email"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" body"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("email\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("break")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("Here is the next part of our switch. Now that we have properly configured our provider, we want to use it to retrieve\nuser information.")]),t._v(" "),s("p",[t._v("Here you see the real power of "),s("code",[t._v("purest")]),t._v(", you can simply make a get request on the desired URL, using the "),s("code",[t._v("access_token")]),t._v("\nfrom the "),s("code",[t._v("query")]),t._v(" parameter to authenticate.")]),t._v(" "),s("p",[t._v("That way, you should be able to retrieve the user info you need.")]),t._v(" "),s("p",[t._v("Now, you can simply call the "),s("code",[t._v("callback")]),t._v(" function with the username and email of your user. That way, Strapi will be able\nto retrieve your user from the database and log you in.")]),t._v(" "),s("h3",{attrs:{id:"configure-the-new-provider-model-onto-database"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#configure-the-new-provider-model-onto-database"}},[t._v("#")]),t._v(" Configure the new provider model onto database")]),t._v(" "),s("p",[t._v("Now, we need to configure our 'model' for our new provider. That way, our settings can be stored in the database, and\nmanaged from the admin panel.")]),t._v(" "),s("p",[t._v("Open the file "),s("code",[t._v("packages/strapi-plugin-users-permissions/config/functions/bootstrap.js")])]),t._v(" "),s("p",[t._v("Add the fields your provider needs into the "),s("code",[t._v("grantConfig")]),t._v(" object.\nFor our discord provider it will look like:")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("discord"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  enabled"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// make this provider disabled by default")]),t._v("\n  icon"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'comments'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// The icon to use on the UI")]),t._v("\n  key"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// our provider app id (leave it blank, you will fill it with the content manager)")]),t._v("\n  secret"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// our provider secret key (leave it blank, you will fill it with the content manager)")]),t._v("\n  callback"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/auth/discord/callback'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// the callback endpoint of our provider")]),t._v("\n  scope"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// the scope that we need from our user to retrieve information")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'identify'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'email'")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n")])])]),t._v(" "),s("h2",{attrs:{id:"templating-emails"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#templating-emails"}},[t._v("#")]),t._v(" Templating emails")]),t._v(" "),s("p",[t._v("By default, this plugin comes with only two templates (reset password and email address confirmation) at the moment. More templates will come later. The templates use Lodash's template() method to populate the variables.")]),t._v(" "),s("p",[t._v("You can update these templates under "),s("strong",[t._v("Plugins")]),t._v(" > "),s("strong",[t._v("Roles & Permissions")]),t._v(" > "),s("strong",[t._v("Email Templates")]),t._v(" tab in the admin panel.")]),t._v(" "),s("h3",{attrs:{id:"reset-password"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#reset-password"}},[t._v("#")]),t._v(" Reset Password")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("USER")]),t._v(" (object)\n"),s("ul",[s("li",[s("code",[t._v("username")])]),t._v(" "),s("li",[s("code",[t._v("email")])])])]),t._v(" "),s("li",[s("code",[t._v("TOKEN")]),t._v(" corresponds to the token generated to be able to reset the password.")]),t._v(" "),s("li",[s("code",[t._v("URL")]),t._v(" is the link where the user will be redirected after clicking on it in the email.")])]),t._v(" "),s("h3",{attrs:{id:"email-address-confirmation"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#email-address-confirmation"}},[t._v("#")]),t._v(" Email address confirmation")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("USER")]),t._v(" (object)\n"),s("ul",[s("li",[s("code",[t._v("username")])]),t._v(" "),s("li",[s("code",[t._v("email")])])])]),t._v(" "),s("li",[s("code",[t._v("CODE")]),t._v(" corresponds to the CODE generated to be able confirm the user email.")]),t._v(" "),s("li",[s("code",[t._v("URL")]),t._v(" is the Strapi backend URL that confirms the code (by default "),s("code",[t._v("/auth/email-confirmation")]),t._v(").")])]),t._v(" "),s("h2",{attrs:{id:"security-configuration"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#security-configuration"}},[t._v("#")]),t._v(" Security configuration")]),t._v(" "),s("p",[t._v("JWT tokens can be verified and trusted because the information is digitally signed. To sign a token a "),s("em",[t._v("secret")]),t._v(" is required. By default Strapi generates one that is stored in "),s("code",[t._v("./extensions/users-permissions/config/jwt.js")]),t._v(". This is useful during development but for security reasons it is "),s("strong",[t._v("recommended")]),t._v(" to set a custom token via an environment variable "),s("code",[t._v("JWT_SECRET")]),t._v(" when deploying to production.")]),t._v(" "),s("p",[t._v("By default you can set a "),s("code",[t._v("JWT_SECRET")]),t._v(" environment variable and it will be used as secret. If you want to use another variable you can update the configuration file.")]),t._v(" "),s("p",[s("strong",[t._v("Path -")]),t._v(" "),s("code",[t._v("./extensions/users-permissions/config/jwt.js")]),t._v(".")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("module"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  jwtSecret"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" process"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("env"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("SOME_ENV_VAR")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),s("p",[t._v("You can learn more on configuration in the documentation "),s("RouterLink",{attrs:{to:"/developer-docs/latest/setup-deployment-guides/configurations.html"}},[t._v("这里")])],1)])],1)}),[],!1,null,null,null);e.default=n.exports}}]);