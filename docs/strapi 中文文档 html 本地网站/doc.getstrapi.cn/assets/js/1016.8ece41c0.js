(window.webpackJsonp=window.webpackJsonp||[]).push([[1016],{1436:function(t,a,s){"use strict";s.r(a);var e=s(9),n=Object(e.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"email"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#email"}},[t._v("#")]),t._v(" Email")]),t._v(" "),s("p",[t._v("Thanks to the plugin "),s("code",[t._v("Email")]),t._v(", you can send email from your server or externals providers such as "),s("strong",[t._v("Sendgrid")]),t._v(".")]),t._v(" "),s("h2",{attrs:{id:"programmatic-usage"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#programmatic-usage"}},[t._v("#")]),t._v(" Programmatic usage")]),t._v(" "),s("h3",{attrs:{id:"send-an-email-send"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#send-an-email-send"}},[t._v("#")]),t._v(" Send an email - "),s("code",[t._v(".send()")])]),t._v(" "),s("p",[t._v("In your custom controllers or services you may want to send email.\nBy using the following function, Strapi will use the configured provider to send an email.")]),t._v(" "),s("p",[s("strong",[t._v("例子")])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" strapi"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("plugins"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'email'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("services"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("email"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("send")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  to"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'paulbocuse@strapi.io'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'joelrobuchon@strapi.io'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  cc"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'helenedarroze@strapi.io'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  bcc"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ghislainearabian@strapi.io'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  replyTo"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'annesophiepic@strapi.io'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  subject"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Use strapi email provider successfully'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  text"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Hello world!'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  html"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Hello world!'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h3",{attrs:{id:"send-an-email-using-a-template-sendtemplatedemail"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#send-an-email-using-a-template-sendtemplatedemail"}},[t._v("#")]),t._v(" Send an email using a template - "),s("code",[t._v(".sendTemplatedEmail()")])]),t._v(" "),s("p",[t._v("When you send an email, you will most likely want to build it from a template you wrote.\nThe email plugin provides the service "),s("code",[t._v("sendTemplatedEmail")]),t._v(" that compile the email and then sends it. The function have the following params:")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("param")]),t._v(" "),s("th",[t._v("description")]),t._v(" "),s("th",[t._v("type")]),t._v(" "),s("th",[t._v("default")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[s("code",[t._v("emailOptions")])]),t._v(" "),s("td",[t._v("Object that contains email options ("),s("code",[t._v("to")]),t._v(", "),s("code",[t._v("from")]),t._v(", "),s("code",[t._v("replyTo")]),t._v(", "),s("code",[t._v("cc")]),t._v(", "),s("code",[t._v("bcc")]),t._v(") except "),s("code",[t._v("subject")]),t._v(", "),s("code",[t._v("text")]),t._v(" and "),s("code",[t._v("html")])]),t._v(" "),s("td",[t._v("object")]),t._v(" "),s("td",[s("code",[t._v("{}")])])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("emailTemplate")])]),t._v(" "),s("td",[t._v("Object that contains "),s("code",[t._v("subject")]),t._v(", "),s("code",[t._v("text")]),t._v(" and "),s("code",[t._v("html")]),t._v(" as "),s("a",{attrs:{href:"https://lodash.com/docs/4.17.15#template",target:"_blank",rel:"noopener noreferrer"}},[t._v("lodash string templates"),s("OutboundLink")],1)]),t._v(" "),s("td",[t._v("object")]),t._v(" "),s("td",[s("code",[t._v("{}")])])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("data")])]),t._v(" "),s("td",[t._v("Object that contains the data used to compile the templates")]),t._v(" "),s("td",[t._v("object")]),t._v(" "),s("td",[s("code",[t._v("{}")])])])])]),t._v(" "),s("p",[s("strong",[t._v("例子")])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" emailTemplate "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  subject"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Welcome <%= user.firstname %>'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  text"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token template-string"}},[s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("Welcome on mywebsite.fr!\n    Your account is now linked with: <%= user.email %>.")]),s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  html"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token template-string"}},[s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("<h1>Welcome on mywebsite.fr!</h1>\n    <p>Your account is now linked with: <%= user.email %>.<p>")]),s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" strapi"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("plugins"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("email"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("services"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("email"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sendTemplatedEmail")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    to"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" user"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("email"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// from: is not specified, so it's the defaultFrom that will be used instead")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  emailTemplate"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    user"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" _"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("pick")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("user"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'username'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'email'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'firstname'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'lastname'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h2",{attrs:{id:"configure-the-plugin"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#configure-the-plugin"}},[t._v("#")]),t._v(" Configure the plugin")]),t._v(" "),s("p",[t._v("By default Strapi provides a local email system ("),s("a",{attrs:{href:"https://www.npmjs.com/package/sendmail",target:"_blank",rel:"noopener noreferrer"}},[t._v("sendmail"),s("OutboundLink")],1),t._v("). If you want to use a third party to send emails, you need to install the correct provider module. Otherwise you can skip this part and continue to configure your provider.")]),t._v(" "),s("p",[t._v("You can check all the available providers developed by the community on npmjs.org - "),s("a",{attrs:{href:"https://www.npmjs.com/search?q=strapi-provider-email-",target:"_blank",rel:"noopener noreferrer"}},[t._v("Providers list"),s("OutboundLink")],1)]),t._v(" "),s("p",[t._v("To install a new provider run:")]),t._v(" "),s("Tabs",{attrs:{type:"border-card"}},[s("Tab",{attrs:{label:"yarn"}},[s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("yarn add strapi-provider-email-sendgrid --save\n")])])])]),t._v(" "),s("Tab",{attrs:{label:"npm"}},[s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("npm install strapi-provider-email-sendgrid --save\n")])])])])],1),t._v(" "),s("h4",{attrs:{id:"using-scoped-packages-as-providers"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#using-scoped-packages-as-providers"}},[t._v("#")]),t._v(" Using scoped packages as providers")]),t._v(" "),s("p",[t._v("If your package name is "),s("a",{attrs:{href:"https://docs.npmjs.com/about-scopes",target:"_blank",rel:"noopener noreferrer"}},[t._v("scoped"),s("OutboundLink")],1),t._v(" (for example "),s("code",[t._v("@username/strapi-provider-email-gmail-oauth2")]),t._v(") you need to take an extra step by aliasing it in "),s("code",[t._v("package.json")]),t._v(". Go to the "),s("code",[t._v("dependencies")]),t._v(" section and change the provider line to look like this:")]),t._v(" "),s("p",[s("code",[t._v('"strapi-provider-email-gmail-oauth2": "npm:@username/strapi-provider-email-gmail-oauth2@0.1.9"')])]),t._v(" "),s("p",[t._v("The string after the last "),s("code",[t._v("@")]),t._v(" represents your desired "),s("a",{attrs:{href:"https://docs.npmjs.com/about-semantic-versioning",target:"_blank",rel:"noopener noreferrer"}},[t._v("semver"),s("OutboundLink")],1),t._v(" version range.")]),t._v(" "),s("h3",{attrs:{id:"configure-your-provider"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#configure-your-provider"}},[t._v("#")]),t._v(" Configure your provider")]),t._v(" "),s("p",[t._v("After installing your provider you will need to add some settings in "),s("code",[t._v("config/plugins.js")]),t._v(". If this file doesn't exists, you'll need to create it. Check the README of each provider to know what configuration settings the provider needs.")]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),s("p",[t._v("Make sure you have the correct spelling of the configuration filename, it is written in plural (with a trailing 's'): "),s("code",[t._v("plugins.js")]),t._v(".")])]),t._v(" "),s("p",[t._v("Here is an example of a configuration made for the provider "),s("a",{attrs:{href:"https://www.npmjs.com/package/strapi-provider-email-sendgrid",target:"_blank",rel:"noopener noreferrer"}},[t._v("strapi-provider-email-sendgrid"),s("OutboundLink")],1),t._v(".")]),t._v(" "),s("p",[s("strong",[t._v("Path —")]),t._v(" "),s("code",[t._v("./config/plugins.js")]),t._v(".")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("module"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("exports")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" env "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n  email"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    provider"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'sendgrid'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    providerOptions"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      apiKey"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("env")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'SENDGRID_API_KEY'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    settings"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      defaultFrom"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'juliasedefdjian@strapi.io'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      defaultReplyTo"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'juliasedefdjian@strapi.io'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      testAddress"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'juliasedefdjian@strapi.io'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),s("p",[t._v("If you're using a different provider depending on your environment, you can specify the correct configuration in "),s("code",[t._v("config/env/${yourEnvironment}/plugins.js")]),t._v(". More info here: "),s("RouterLink",{attrs:{to:"/developer-docs/latest/setup-deployment-guides/configurations.html#environment"}},[t._v("Environments")])],1)]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),s("p",[t._v("Only one email provider will be active at all time. If the email provider setting isn't picked up by strapi, verify you have put the file "),s("code",[t._v("plugins.js")]),t._v(" in the correct folder, and with correct filename. The selection of email provider is done via configuration file only.")])]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),s("p",[t._v("When testing the new email provider with those two email templates created during strapi setup, the "),s("em",[t._v("shipper email")]),t._v(" on the template, with default no-reply@strapi.io need to be updated in according to your email provider, otherwise it will fail the test.\nMore info here: "),s("a",{attrs:{href:"http://localhost:1337/admin/plugins/users-permissions/email-templates",target:"_blank",rel:"noopener noreferrer"}},[t._v("Configure templates Locally"),s("OutboundLink")],1)])]),t._v(" "),s("h2",{attrs:{id:"create-new-provider"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#create-new-provider"}},[t._v("#")]),t._v(" Create new provider")]),t._v(" "),s("p",[t._v("If you want to create your own, make sure the name starts with "),s("code",[t._v("strapi-provider-email-")]),t._v(" (duplicating an existing one will be easier) and customize the "),s("code",[t._v("send")]),t._v(" function.")]),t._v(" "),s("p",[t._v("Default template")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("module"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("init")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("providerOptions "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" settings "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("send")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("options")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("In the "),s("code",[t._v("send")]),t._v(" function you will have access to:")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("providerOptions")]),t._v(" that contains configurations written in "),s("code",[t._v("plugins.js")])]),t._v(" "),s("li",[s("code",[t._v("settings")]),t._v(" that contains configurations written in "),s("code",[t._v("plugins.js")])]),t._v(" "),s("li",[s("code",[t._v("options")]),t._v(" that contains options you send when you call the "),s("code",[t._v("send")]),t._v(" function from the email plugin service")])]),t._v(" "),s("p",[t._v("To use it you will have to publish it on "),s("strong",[t._v("npm")]),t._v(".")]),t._v(" "),s("h3",{attrs:{id:"create-a-local-provider"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#create-a-local-provider"}},[t._v("#")]),t._v(" Create a local provider")]),t._v(" "),s("p",[t._v("If you want to create your own provider without publishing it on "),s("strong",[t._v("npm")]),t._v(" you can follow these steps:")]),t._v(" "),s("ul",[s("li",[t._v("创建 a "),s("code",[t._v("providers")]),t._v(" folder in your application.")]),t._v(" "),s("li",[t._v("创建 your provider as explained in the documentation eg. "),s("code",[t._v("./providers/strapi-provider-email-[...]/...")])]),t._v(" "),s("li",[t._v("然后 update your "),s("code",[t._v("package.json")]),t._v(" to link your "),s("code",[t._v("strapi-provider-email-[...]")]),t._v(" dependency to the "),s("a",{attrs:{href:"https://docs.npmjs.com/files/package.json#local-paths",target:"_blank",rel:"noopener noreferrer"}},[t._v("local path"),s("OutboundLink")],1),t._v(" of your new provider.")])]),t._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  ...\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"dependencies"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    ...\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"strapi-provider-email-[...]"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"file:providers/strapi-provider-email-[...]"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    ...\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("ul",[s("li",[t._v("Finally, run "),s("code",[t._v("yarn install")]),t._v(" or "),s("code",[t._v("npm install")]),t._v(" to install your new custom provider.")])]),t._v(" "),s("h2",{attrs:{id:"troubleshooting"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#troubleshooting"}},[t._v("#")]),t._v(" Troubleshooting")]),t._v(" "),s("p",[t._v("You received an "),s("code",[t._v("Auth.form.error.email.invalid")]),t._v(" error even though the email is valid and exists in the database.")]),t._v(" "),s("p",[t._v("Here is the error response you get from the API.")]),t._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"statusCode"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("400")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"error"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Bad Request"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"message"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"messages"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"id"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Auth.form.error.email.invalid"')]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("This error is due to your IP connection. By default, Strapi uses the "),s("a",{attrs:{href:"https://github.com/guileen/node-sendmail",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("sendmail")]),s("OutboundLink")],1),t._v(" package.")]),t._v(" "),s("p",[t._v("This package sends an email from the server it runs on. Depending on the network you are on, the connection to the SMTP server could fail.")]),t._v(" "),s("p",[t._v("Here is the "),s("code",[t._v("sendmail")]),t._v(" error.")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("Error: SMTP code:550 msg:550-5.7.1 [87.88.179.13] The IP you're using to send mail is not authorized to\n550-5.7.1 send email directly to our servers. Please use the SMTP relay at your\n550-5.7.1 service provider instead. Learn more at\n550 5.7.1  https://support.google.com/mail/?p=NotAuthorizedError 30si2132728pjz.75 - gsmtp\n")])])]),s("p",[t._v("To fix it, we suggest you to use another email provider that uses third party to send emails.")]),t._v(" "),s("p",[t._v("When using a third party provider, you avoid having to setup a mail server on your server and get extra features such as email analytics.")])],1)}),[],!1,null,null,null);a.default=n.exports}}]);