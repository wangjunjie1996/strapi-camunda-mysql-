(window.webpackJsonp=window.webpackJsonp||[]).push([[1109],{1531:function(t,s,a){"use strict";a.r(s);var e=a(9),n=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"migration-guide-from-3-0-0-beta-20-to-3-0-0"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#migration-guide-from-3-0-0-beta-20-to-3-0-0"}},[t._v("#")]),t._v(" Migration guide from 3.0.0-beta.20 to 3.0.0")]),t._v(" "),a("p",[t._v("Upgrading your Strapi application to "),a("code",[t._v("3.0.0")]),t._v(".")]),t._v(" "),a("p",[a("strong",[t._v("Make sure your server is not running until the end of the migration")])]),t._v(" "),a("h2",{attrs:{id:"upgrading-your-dependencies"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#upgrading-your-dependencies"}},[t._v("#")]),t._v(" Upgrading your dependencies")]),t._v(" "),a("p",[t._v('Start by upgrading your dependencies. Make sure to use exact versions, however please note that the version listed below may not be the current "latest" release.')]),t._v(" "),a("p",[t._v("Update your package.json accordingly:")]),t._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"dependencies"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"strapi"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"3.0.0"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"strapi-admin"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"3.0.0"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"strapi-connector-bookshelf"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"3.0.0"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"strapi-plugin-content-manager"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"3.0.0"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"strapi-plugin-content-type-builder"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"3.0.0"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"strapi-plugin-email"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"3.0.0"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"strapi-plugin-graphql"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"3.0.0"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"strapi-plugin-upload"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"3.0.0"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"strapi-plugin-users-permissions"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"3.0.0"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"strapi-utils"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"3.0.0"')]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("Then run either "),a("code",[t._v("yarn install")]),t._v(" or "),a("code",[t._v("npm install")]),t._v(".")]),t._v(" "),a("h2",{attrs:{id:"new-configuration-loader"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#new-configuration-loader"}},[t._v("#")]),t._v(" New configuration loader")]),t._v(" "),a("p",[t._v("We have reworked the way a Strapi project is configured to make it simpler yet more powerful.")]),t._v(" "),a("p",[t._v("Some of the improvements are:")]),t._v(" "),a("ul",[a("li",[a("code",[t._v(".env")]),t._v(" support.")]),t._v(" "),a("li",[t._v("Less files.")]),t._v(" "),a("li",[t._v("Environment overwrites.")])]),t._v(" "),a("p",[t._v("Before migrating, you should first read the new "),a("RouterLink",{attrs:{to:"/developer-docs/latest/setup-deployment-guides/configurations.html"}},[t._v("configuration 文章")]),t._v(" to fully understand the changes.")],1),t._v(" "),a("h3",{attrs:{id:"migrating"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#migrating"}},[t._v("#")]),t._v(" Migrating")]),t._v(" "),a("h4",{attrs:{id:"server"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#server"}},[t._v("#")]),t._v(" Server")]),t._v(" "),a("p",[t._v("Your server configuration should move from "),a("code",[t._v("./config/environments/{env}/server.json")]),t._v(" to "),a("code",[t._v("./config/server.js")]),t._v(" like shown "),a("RouterLink",{attrs:{to:"/developer-docs/latest/setup-deployment-guides/configurations.html#server"}},[t._v("这里")]),t._v(".")],1),t._v(" "),a("h4",{attrs:{id:"database-configuration"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#database-configuration"}},[t._v("#")]),t._v(" Database configuration")]),t._v(" "),a("p",[t._v("Your database configuration should move from "),a("code",[t._v("./config/environments/{env}/database.json")]),t._v(" to "),a("code",[t._v("./config/database.js")]),t._v(" like shown "),a("RouterLink",{attrs:{to:"/developer-docs/latest/setup-deployment-guides/configurations.html#database"}},[t._v("这里")]),t._v(".")],1),t._v(" "),a("h4",{attrs:{id:"middlewares"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#middlewares"}},[t._v("#")]),t._v(" Middlewares")]),t._v(" "),a("p",[t._v("We have moved all the middleware related configurations into one place: "),a("code",[t._v("./config/middleware.js")]),t._v(".")]),t._v(" "),a("p",[t._v("The middlewares were previously configured in mutliple files:")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("./config/middleware.json")])]),t._v(" "),a("li",[a("code",[t._v("./config/application.json")])]),t._v(" "),a("li",[a("code",[t._v("./config/language.json")])]),t._v(" "),a("li",[a("code",[t._v("./config/environments/{env}/request.json")])]),t._v(" "),a("li",[a("code",[t._v("./config/environments/{env}/response.json")])]),t._v(" "),a("li",[a("code",[t._v("./config/environments/{env}/security.json")])])]),t._v(" "),a("p",[t._v("First you should create a file "),a("code",[t._v("./config/middleware.js")]),t._v(".")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// This is just an example, and is not required")]),t._v("\nmodule"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  timeout"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  load"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    before"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'responseTime'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'logger'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'cors'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'responses'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'gzip'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    order"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Define the middlewares\' load order by putting their name in this array is the right order"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    after"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'parser'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'router'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  settings"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      path"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./public'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      maxAge"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("60000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("You can now move the middleware configurations from "),a("code",[t._v("application.json")]),t._v(", "),a("code",[t._v("language.json")]),t._v(", "),a("code",[t._v("security.json")]),t._v(", "),a("code",[t._v("request.json")]),t._v(" and "),a("code",[t._v("response.json")]),t._v(" files directly into the "),a("code",[t._v("settings")]),t._v(" property.")]),t._v(" "),a("p",[t._v("You can review all possible options in the "),a("RouterLink",{attrs:{to:"/developer-docs/latest/setup-deployment-guides/configurations.html#configuration-and-activation-2"}},[t._v("middleware 文章")]),t._v(".")],1),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),a("p",[t._v("If you never configured any middlewares you can delete this file all together. You can also only set the configurations you want to customize and leave the others out.")])]),t._v(" "),a("h4",{attrs:{id:"hook"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#hook"}},[t._v("#")]),t._v(" Hook")]),t._v(" "),a("p",[t._v("We applied the same logic from the "),a("code",[t._v("middleware")]),t._v(" configuration to the "),a("code",[t._v("hook")]),t._v(" configuration.")]),t._v(" "),a("p",[t._v("First you should create a file "),a("code",[t._v("./config/hook.js")]),t._v(", and you can move the content of "),a("code",[t._v("./config/hook.json")]),t._v(" into it. Hooks should be placed under settings key eg:")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("module"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  timeout"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  load"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    before"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'hook-1'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'hook-2'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    order"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Define the hooks\' load order by putting their names in this array in the right order"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    after"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'hook-3'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'hook4'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  settings"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'hook-1'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      enabled"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'hook-2'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      enabled"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'hook-3'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      enabled"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    hook4"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      enabled"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),a("p",[t._v("If you never configured any hook you can delete the file all together. You can also only set the configurations you want to customize and leave the others out.")])]),t._v(" "),a("h4",{attrs:{id:"functions"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#functions"}},[t._v("#")]),t._v(" Functions")]),t._v(" "),a("p",[t._v("You can leave your functions as is, we didn't change how they work.")]),t._v(" "),a("h4",{attrs:{id:"policies"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#policies"}},[t._v("#")]),t._v(" Policies")]),t._v(" "),a("p",[t._v("You can leave your policies as is, we didn't change how they work.")]),t._v(" "),a("h4",{attrs:{id:"custom"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#custom"}},[t._v("#")]),t._v(" Custom")]),t._v(" "),a("p",[t._v("Any custom configuration you have can still be used. You can read the "),a("RouterLink",{attrs:{to:"/developer-docs/latest/setup-deployment-guides/configurations.html"}},[t._v("configuration 文章")]),t._v(" to know more.")],1),t._v(" "),a("h4",{attrs:{id:"plugin"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#plugin"}},[t._v("#")]),t._v(" Plugin")]),t._v(" "),a("p",[t._v("From now on, you will set your plugin configurations in "),a("code",[t._v("./config/plugins.js")]),t._v(" or "),a("code",[t._v("./config/env/{env}/plugin.js")]),t._v(". Instead of using the extensions system to directly modify the plugin configuration.")]),t._v(" "),a("p",[a("strong",[t._v("例子")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("module"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  graphql"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    depthLimit"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("h3",{attrs:{id:"final-structure"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#final-structure"}},[t._v("#")]),t._v(" Final structure")]),t._v(" "),a("p",[t._v("Here is an example of the structure you could have after migrating:")]),t._v(" "),a("p",[a("strong",[t._v("Before")])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("config\n├── application.json\n├── custom.json\n├── environments\n│   ├── development\n│   │   ├── custom.json\n│   │   ├── database.json\n│   │   ├── request.json\n│   │   ├── response.json\n│   │   ├── security.json\n│   │   └── server.json\n│   ├── production\n│   │   ├── custom.json\n│   │   ├── database.json\n│   │   ├── request.json\n│   │   ├── response.json\n│   │   ├── security.json\n│   │   └── server.json\n│   └── staging\n│       ├── custom.json\n│       ├── database.json\n│       ├── request.json\n│       ├── response.json\n│       ├── security.json\n│       └── server.json\n├── functions\n│   ├── bootstrap.js\n│   ├── cron.js\n│   └── responses\n│       └── 404.js\n├── hook.json\n├── language.json\n├── locales\n│   ├── cs_cz.json\n│   ├── de_de.json\n│   ├── en_us.json\n│   ├── es_es.json\n│   ├── fr_fr.json\n│   ├── it_it.json\n│   ├── ja_jp.json\n│   ├── ru_ru.json\n│   └── tr_tr.json\n└── middleware.json\n")])])]),a("p",[a("strong",[t._v("After")])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("config\n├── functions\n│   ├── bootstrap.js\n│   ├── cron.js\n│   └── responses\n│       └── 404.js\n├── env\n│   └── production\n│       └── database.js\n├── database.js\n├── middleware.js\n└── server.js\n")])])]),a("h2",{attrs:{id:"database-lifecycles"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#database-lifecycles"}},[t._v("#")]),t._v(" Database lifecycles")]),t._v(" "),a("p",[t._v("We have replaced the old lifecycles that had a lot of issues with a new simpler lifecycle layer.")]),t._v(" "),a("p",[t._v("You can read more "),a("RouterLink",{attrs:{to:"/developer-docs/latest/development/backend-customization.html#lifecycle-hooks"}},[t._v("这里")]),t._v(".")],1),t._v(" "),a("h2",{attrs:{id:"email-plugin-settings"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#email-plugin-settings"}},[t._v("#")]),t._v(" Email plugin settings")]),t._v(" "),a("p",[t._v("Email plugin settings have been moved to files. Now you can configure your email provider directly in files.")]),t._v(" "),a("p",[t._v("You can read the documentation "),a("RouterLink",{attrs:{to:"/developer-docs/latest/development/plugins/email.html#configure-the-plugin"}},[t._v("这里")]),t._v(" to update.")],1),t._v(" "),a("p",[t._v("Once you have setup your configuration, you can cleanup your database by deleting in the "),a("code",[t._v("core_store")]),t._v(" model the data with the "),a("code",[t._v("key")]),t._v(" equal to "),a("code",[t._v("plugin_email_provider")]),t._v(".")]),t._v(" "),a("h2",{attrs:{id:"graphql-changes"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#graphql-changes"}},[t._v("#")]),t._v(" GraphQL changes")]),t._v(" "),a("p",[t._v("If you are using the graphql "),a("code",[t._v("register")]),t._v(" mutation, the input and response types have changed. You can check the code "),a("a",{attrs:{href:"https://github.com/strapi/strapi/pull/6047",target:"_blank",rel:"noopener noreferrer"}},[t._v("这里"),a("OutboundLink")],1),t._v(".")]),t._v(" "),a("p",[t._v("The "),a("code",[t._v("changePassword")]),t._v(" mutation got renamed to "),a("code",[t._v("resetPassword")]),t._v(" to reflect what it does. You can check the code "),a("a",{attrs:{href:"https://github.com/strapi/strapi/pull/5655",target:"_blank",rel:"noopener noreferrer"}},[t._v("这里"),a("OutboundLink")],1),t._v(".")]),t._v(" "),a("h2",{attrs:{id:"remove-idattribute-and-idattributetype-options"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#remove-idattribute-and-idattributetype-options"}},[t._v("#")]),t._v(" Remove "),a("code",[t._v("idAttribute")]),t._v(" and "),a("code",[t._v("idAttributeType")]),t._v(" options")]),t._v(" "),a("p",[t._v("Currently using the idAttribute and idAttributeType options can break strapi in many ways. Fixing this is going to require a lot of work on the database and content management layer.")]),t._v(" "),a("p",[t._v("In an effort to make Strapi more stable we have decided to remove those broken options for the time being. For users who want unique uuid fields for examples we recommend you create a uuid attribute and use the lifecycles function to populate it.")]),t._v(" "),a("h2",{attrs:{id:"proxy-configuration"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#proxy-configuration"}},[t._v("#")]),t._v(" Proxy configuration")]),t._v(" "),a("p",[t._v("In order to support hosting strapi with more flexibility, we have changed the way you configure the server proxy options and the admin panel path.")]),t._v(" "),a("h3",{attrs:{id:"proxy"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#proxy"}},[t._v("#")]),t._v(" Proxy")]),t._v(" "),a("p",[t._v("We replaced the "),a("code",[t._v("proxy")]),t._v(" option found in "),a("code",[t._v("./config/server.json")]),t._v(" by the "),a("code",[t._v("url")]),t._v(" option.")]),t._v(" "),a("p",[t._v("This option also makes the "),a("code",[t._v("admin.build.backend")]),t._v(" option obsolete.")]),t._v(" "),a("p",[t._v("This option tells strapi where it is hosted and is useful for generating links or telling the admin panel where the API is available.")]),t._v(" "),a("p",[a("strong",[t._v("Before")])]),t._v(" "),a("p",[a("strong",[t._v("Path —")]),t._v(" "),a("code",[t._v("./config/server.json")])]),t._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"proxy"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"enabled"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"ssl"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"host"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"domain.com"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"port"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1337"')]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[a("strong",[t._v("After")])]),t._v(" "),a("p",[a("strong",[t._v("Path —")]),t._v(" "),a("code",[t._v("./config/server.js")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("module"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//...")]),t._v("\n  url"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token template-string"}},[a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("https://domain.com:1337")]),a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("What you can now do is add a path to the url to host strapi in a sub path of your domain.")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("module"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//...")]),t._v("\n  url"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token template-string"}},[a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("https://domain.com:1337/my-strapi-api")]),a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[t._v("WARNING")]),t._v(" "),a("p",[t._v("Adding a sub path to the url doesn't mean your api is going to be prefixed. You will need to host your app behind a proxy and remove the prefix so strapi receives request like if they where made on the root "),a("code",[t._v("/")]),t._v(" path.")])]),t._v(" "),a("p",[t._v("You can see this option in action in the following "),a("RouterLink",{attrs:{to:"/developer-docs/latest/setup-deployment-guides/deployment.html#optional-software-guides"}},[t._v("deployment guides")]),t._v(".")],1),t._v(" "),a("h3",{attrs:{id:"admin-path"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#admin-path"}},[t._v("#")]),t._v(" Admin path")]),t._v(" "),a("p",[t._v("We replaced the "),a("code",[t._v("admin.path")]),t._v(" option by the "),a("code",[t._v("admin.url")]),t._v(" option to offer more flexibility of deployment.")]),t._v(" "),a("p",[t._v("The "),a("code",[t._v("url")]),t._v(" option can either be a relative path: "),a("code",[t._v("/admin-panel")]),t._v(" or an absolute url.")]),t._v(" "),a("p",[a("strong",[t._v("Before")])]),t._v(" "),a("p",[a("strong",[t._v("Path —")]),t._v(" "),a("code",[t._v("./config/server.json")])]),t._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"admin"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"path"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/dashboard"')]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[a("strong",[t._v("After")])]),t._v(" "),a("p",[a("strong",[t._v("Path —")]),t._v(" "),a("code",[t._v("./config/server.js")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("module"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//...")]),t._v("\n  admin"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    url"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/dashboard'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("You can see this option in action in the following "),a("RouterLink",{attrs:{to:"/developer-docs/latest/setup-deployment-guides/deployment.html#optional-software-guides"}},[t._v("deployment guides")]),t._v(".")],1),t._v(" "),a("h2",{attrs:{id:"rebuilding-your-administration-panel"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#rebuilding-your-administration-panel"}},[t._v("#")]),t._v(" Rebuilding your administration panel")]),t._v(" "),a("p",[t._v("You can run "),a("code",[t._v("yarn build --clean")]),t._v(" or "),a("code",[t._v("npm run build -- --clean")]),t._v(" to rebuild your admin panel with the newly installed version of strapi.")]),t._v(" "),a("p",[t._v("Finally restart your server: "),a("code",[t._v("yarn develop")]),t._v(" or "),a("code",[t._v("npm run develop")]),t._v(".")])])}),[],!1,null,null,null);s.default=n.exports}}]);