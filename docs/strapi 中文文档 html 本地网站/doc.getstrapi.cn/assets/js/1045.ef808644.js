(window.webpackJsonp=window.webpackJsonp||[]).push([[1045],{1467:function(t,s,e){"use strict";e.r(s);var a=e(9),n=Object(a.a)({},(function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"amazon-aws"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#amazon-aws"}},[t._v("#")]),t._v(" Amazon AWS")]),t._v(" "),e("p",[t._v("This is a step-by-step guide for deploying a Strapi project to "),e("a",{attrs:{href:"https://aws.amazon.com/ec2/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Amazon AWS EC2"),e("OutboundLink")],1),t._v(". This guide will connect to an "),e("a",{attrs:{href:"https://aws.amazon.com/rds/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Amazon AWS RDS"),e("OutboundLink")],1),t._v(" for managing and hosting the database. Optionally, this guide will show you how to connect host and serve images on "),e("a",{attrs:{href:"https://aws.amazon.com/s3/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Amazon AWS S3"),e("OutboundLink")],1),t._v(".")]),t._v(" "),e("p",[t._v("Prior to starting this guide, you should have created a "),e("RouterLink",{attrs:{to:"/developer-docs/latest/getting-started/quick-start.html"}},[t._v("Strapi project")]),t._v(", to use for deploying on AWS. And have read through the "),e("RouterLink",{attrs:{to:"/developer-docs/latest/setup-deployment-guides/deployment.html#application-configuration"}},[t._v("configuration")]),t._v(" section.")],1),t._v(" "),e("h3",{attrs:{id:"amazon-aws-install-requirements-and-creating-an-iam-non-root-user"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#amazon-aws-install-requirements-and-creating-an-iam-non-root-user"}},[t._v("#")]),t._v(" Amazon AWS Install Requirements and creating an IAM non-root user")]),t._v(" "),e("ul",[e("li",[t._v("You must have an "),e("a",{attrs:{href:"https://aws.amazon.com/free",target:"_blank",rel:"noopener noreferrer"}},[t._v("Amazon AWS"),e("OutboundLink")],1),t._v(" account before doing these steps.")])]),t._v(" "),e("p",[t._v("Best practices for using "),e("strong",[t._v("AWS Amazon")]),t._v(" services state to not use your root account user and to use instead the "),e("a",{attrs:{href:"https://docs.aws.amazon.com/IAM/latest/UserGuide/introduction.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("IAM (AWS Identity and Access Management) service"),e("OutboundLink")],1),t._v(". Your root user is therefore only used for a very few "),e("a",{attrs:{href:"https://docs.aws.amazon.com/general/latest/gr/aws_tasks-that-require-root.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("select tasks"),e("OutboundLink")],1),t._v(". For example, for "),e("strong",[t._v("billing")]),t._v(", you create an "),e("strong",[t._v("Administrator user and Group")]),t._v(" for such things. And other, more routine tasks are done with a "),e("strong",[t._v("regular IAM User")]),t._v(".")]),t._v(" "),e("h4",{attrs:{id:"_1-follow-these-instructions-for-creating-your-administrator-iam-admin-user-and-group"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-follow-these-instructions-for-creating-your-administrator-iam-admin-user-and-group"}},[t._v("#")]),t._v(" 1. Follow these instructions for "),e("a",{attrs:{href:"https://docs.aws.amazon.com/IAM/latest/UserGuide/getting-started_create-admin-group.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("creating your Administrator IAM Admin User and Group"),e("OutboundLink")],1)]),t._v(" "),e("ul",[e("li",[t._v("Login as "),e("strong",[t._v("root")]),t._v(".")]),t._v(" "),e("li",[t._v("创建 "),e("strong",[t._v("Administrator")]),t._v(" role.")])]),t._v(" "),e("h4",{attrs:{id:"_2-next-create-a-regular-user-for-the-creation-and-management-of-your-strapi-project"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-next-create-a-regular-user-for-the-creation-and-management-of-your-strapi-project"}},[t._v("#")]),t._v(" 2. Next, create a "),e("strong",[t._v("regular user")]),t._v(" for the creation and management of your Strapi project")]),t._v(" "),e("ul",[e("li",[t._v("Copy your "),e("strong",[t._v("IAM Users sign-in link")]),t._v(" found here: "),e("a",{attrs:{href:"https://console.aws.amazon.com/iam/home",target:"_blank",rel:"noopener noreferrer"}},[t._v("IAM Console"),e("OutboundLink")],1),t._v(" and then log out of your "),e("strong",[t._v("root user")]),t._v(" and log in to your "),e("strong",[t._v("administrator")]),t._v(" user you just created.")]),t._v(" "),e("li",[t._v("Return to the IAM Console by "),e("code",[t._v("searching for IAM")]),t._v(" and clicking or going here: "),e("a",{attrs:{href:"https://console.aws.amazon.com/iam/home",target:"_blank",rel:"noopener noreferrer"}},[t._v("IAM Console"),e("OutboundLink")],1),t._v(".")]),t._v(" "),e("li",[t._v("点击 "),e("code",[t._v("Users")]),t._v(", in the left hand menu, and then click "),e("code",[t._v("Add User")]),t._v(":\n"),e("ol",[e("li",[t._v("In the "),e("strong",[t._v("Set user details")]),t._v(" screen:")])]),t._v(" "),e("ul",[e("li",[t._v("Provide a "),e("strong",[t._v("User name")]),t._v(".")]),t._v(" "),e("li",[e("strong",[t._v("Access Type")]),t._v(": Check both "),e("code",[t._v("Programmatic access")]),t._v(" and "),e("code",[t._v("AWS Management Console access")]),t._v(".")]),t._v(" "),e("li",[e("code",[t._v("Autogenerate a password")]),t._v(" or click "),e("code",[t._v("Custom password")]),t._v(" and provide one.")]),t._v(" "),e("li",[e("strong",[t._v("OPTIONAL:")]),t._v(" For simplicity, "),e("code",[t._v("uncheck")]),t._v(" the "),e("strong",[t._v("Require password reset")]),t._v(".")]),t._v(" "),e("li",[t._v("Click "),e("code",[t._v("Next: Permissions")]),t._v(".")])]),t._v(" "),e("ol",{attrs:{start:"2"}},[e("li",[t._v("In the "),e("strong",[t._v("Set Permissions")]),t._v(" screen, do the following:")])]),t._v(" "),e("ul",[e("li",[t._v("Click "),e("code",[t._v("Create group")]),t._v(", name it, e.g. "),e("code",[t._v("Developers")]),t._v(", and then choose appropriate policies under "),e("strong",[t._v("Policy Name")]),t._v(":\n"),e("ul",[e("li",[t._v("search for "),e("code",[t._v("ec2")]),t._v(" and check "),e("code",[t._v("AmazonEC2FullAccess")])]),t._v(" "),e("li",[t._v("search for "),e("code",[t._v("RDS")]),t._v(" and check "),e("code",[t._v("AmazonRDSFullAccess")])]),t._v(" "),e("li",[t._v("search for "),e("code",[t._v("s3")]),t._v(" and check "),e("code",[t._v("AmazonS3FullAccess")])]),t._v(" "),e("li",[t._v("Click "),e("code",[t._v("Create group")])])])]),t._v(" "),e("li",[t._v("Click to "),e("code",[t._v("Add user to group")]),t._v(" and check the "),e("code",[t._v("Developers")]),t._v(" group, to add the new user.")]),t._v(" "),e("li",[t._v("Click "),e("code",[t._v("Next: Tags")]),t._v(".")])]),t._v(" "),e("ol",{attrs:{start:"3"}},[e("li",[e("strong",[t._v("Add tags")]),t._v(" (optional)")])]),t._v(" "),e("ul",[e("li",[t._v("This step is "),e("strong",[t._v("optional")]),t._v(" and based on your workflow and project scope.")]),t._v(" "),e("li",[t._v("Click "),e("code",[t._v("Next: Review")]),t._v(".")])]),t._v(" "),e("ol",{attrs:{start:"4"}},[e("li",[e("strong",[t._v("Review")])])]),t._v(" "),e("ul",[e("li",[t._v("Review the information and ensure it is correct. Use "),e("code",[t._v("Previous")]),t._v(" to correct anything.")]),t._v(" "),e("li",[t._v("Click "),e("code",[t._v("Create user")]),t._v(".")])]),t._v(" "),e("ol",{attrs:{start:"5"}},[e("li",[e("strong",[t._v("Success")]),t._v(" - These are very "),e("strong",[t._v("IMPORTANT CREDENTIALS")]),t._v(" "),e("em",[t._v("If you do not do these steps you will have to reset your "),e("code",[t._v("Access key ID")]),t._v(" and "),e("code",[t._v("Secret access key")]),t._v(" later.")])])]),t._v(" "),e("ul",[e("li",[e("code",[t._v("Download the .csv file")]),t._v(" and store it in a safe place. This contains the user name, login link, Access key ID and Secret access key.")]),t._v(" "),e("li",[e("strong",[t._v("OPTIONAL:")]),t._v(" Add these credentials to your *Password manager**.")]),t._v(" "),e("li",[t._v("点击 the "),e("code",[t._v("AWS Management Console Access sign-in link")]),t._v(". This will log you out of "),e("code",[t._v("Administrator")]),t._v(".")])])])]),t._v(" "),e("h4",{attrs:{id:"_3-log-into-your-aws-management-console-as-your-regular-user"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-log-into-your-aws-management-console-as-your-regular-user"}},[t._v("#")]),t._v(" 3. "),e("code",[t._v("Log into")]),t._v(" your "),e("strong",[t._v("AWS Management Console")]),t._v(" as your "),e("code",[t._v("regular user")])]),t._v(" "),e("p",[t._v("You may now proceed to the next steps.")]),t._v(" "),e("h4",{attrs:{id:"additional-iam-user-resources"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#additional-iam-user-resources"}},[t._v("#")]),t._v(" Additional IAM User Resources")]),t._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("IAM Best Practices"),e("OutboundLink")],1),t._v(".")]),t._v(" "),e("li",[e("a",{attrs:{href:"https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_access-keys.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Instructions to reset Access key ID and Secret access key"),e("OutboundLink")],1),t._v(".")])]),t._v(" "),e("h3",{attrs:{id:"launch-an-ec2-virtual-machine"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#launch-an-ec2-virtual-machine"}},[t._v("#")]),t._v(" Launch an EC2 virtual machine")]),t._v(" "),e("p",[t._v("Amazon calls a virtual private server, a "),e("strong",[t._v("virtual server")]),t._v(" or "),e("strong",[t._v("Amazon EC2 instance")]),t._v(". To use this service you will "),e("code",[t._v("Launch Instance")]),t._v(". In this section, you will "),e("strong",[t._v("establish IAM credentials")]),t._v(", "),e("strong",[t._v("launch a new instance")]),t._v(" and "),e("strong",[t._v("set-up primary security rules")]),t._v(".")]),t._v(" "),e("h4",{attrs:{id:"_1-from-your-aws-management-console-and-as-your-regular-user"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-from-your-aws-management-console-and-as-your-regular-user"}},[t._v("#")]),t._v(" 1. From your "),e("strong",[t._v("AWS Management Console")]),t._v(" and as your "),e("strong",[e("em",[t._v("regular")])]),t._v(" user")]),t._v(" "),e("ul",[e("li",[e("code",[t._v("Find Services")]),t._v(", search for "),e("code",[t._v("ec2")]),t._v(" and click on "),e("code",[t._v("EC2, Virtual Servers in the Cloud")])])]),t._v(" "),e("h4",{attrs:{id:"_2-select-appropriate-region"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-select-appropriate-region"}},[t._v("#")]),t._v(" 2. "),e("strong",[t._v("Select Appropriate Region")])]),t._v(" "),e("p",[t._v("In the top menu, near your IAM Account User name, select, from the dropdown, the most appropriate region to host your Strapi project. For example, "),e("code",[t._v("US East (N.Virginia)")]),t._v(" or "),e("code",[t._v("Asia Pacific (Hong Kong)")]),t._v(". You will want to remember this region for configuring other services on AWS and serving these services from the same region.")]),t._v(" "),e("h4",{attrs:{id:"_3-点击-the-blue-launch-instance-button"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-点击-the-blue-launch-instance-button"}},[t._v("#")]),t._v(" 3. 点击 the blue "),e("code",[t._v("Launch Instance")]),t._v(" button")]),t._v(" "),e("ul",[e("li",[e("code",[t._v("Select")]),t._v(" "),e("strong",[t._v("Ubuntu Server 18.04 LTS (HVM), SSD Volume Type")])]),t._v(" "),e("li",[t._v("Ensure "),e("code",[t._v("General purpose")]),t._v(" + "),e("code",[t._v("t2.small")]),t._v(" is "),e("code",[t._v("checked")]),t._v("."),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[e("code",[t._v("t2.small")]),t._v(" is the smallest instance type in which Strapi runs. "),e("code",[t._v("t2.nano")]),t._v(" and "),e("code",[t._v("t2.micro")]),t._v(" "),e("strong",[t._v("DO NOT")]),t._v(" work. At the moment, deploying the Strapi Admin interface requires more than 1g of RAM. Therefore, "),e("strong",[t._v("t2.small")]),t._v(" or larger instance is needed.")])])]),t._v(" "),e("li",[t._v("点击 grey "),e("code",[t._v("Next: Configure Instance Details")]),t._v(" and "),e("code",[t._v("Next: Add Storage")])]),t._v(" "),e("li",[t._v("In the "),e("strong",[t._v("Step 4: Add Storage")]),t._v(" verify the "),e("code",[t._v("General Purpose SSD (gb2)")]),t._v(", then click "),e("code",[t._v("Next: Add tags")]),t._v(".")]),t._v(" "),e("li",[t._v("In the "),e("strong",[t._v("Step 5: Add Tags")]),t._v(", add tags to suit your project or leave blank, then click "),e("code",[t._v("Next: Configure Security Group")]),t._v(".")]),t._v(" "),e("li",[t._v("In the "),e("strong",[t._v("Step 6: Configure Security Group")]),t._v(", configure the "),e("code",[t._v("security settings")]),t._v(" as follows:\n"),e("ul",[e("li",[e("strong",[t._v("Assign a security group:")]),t._v(" Check as "),e("code",[t._v("Create a new security group")])]),t._v(" "),e("li",[e("strong",[t._v("Security group name:")]),t._v(" Name it, e.g. "),e("code",[t._v("strapi")])]),t._v(" "),e("li",[e("strong",[t._v("Description:")]),t._v(" Write a short description, e.g. "),e("code",[t._v("strapi instance security settings")])]),t._v(" "),e("li",[t._v("You should have a rule: "),e("strong",[t._v("Type:")]),t._v(" "),e("code",[t._v("SSH")]),t._v(", "),e("strong",[t._v("Protocol:")]),t._v(" "),e("code",[t._v("TCP")]),t._v(", "),e("strong",[t._v("Port Range")]),t._v(" "),e("code",[t._v("22")]),t._v(", "),e("strong",[t._v("Source:")]),t._v(" "),e("code",[t._v("0.0.0.0/0")]),t._v(" (all IP addresses). If not, add it.")]),t._v(" "),e("li",[t._v("点击 grey "),e("code",[t._v("Add rule")]),t._v(" to add each of these rules:\n"),e("ul",[e("li",[e("strong",[t._v("Type:")]),t._v(" "),e("code",[t._v("SSH")]),t._v(", "),e("strong",[t._v("Protocol:")]),t._v(" "),e("code",[t._v("TCP")]),t._v(", "),e("strong",[t._v("Port Range")]),t._v(" "),e("code",[t._v("22")]),t._v(", "),e("strong",[t._v("Source:")]),t._v(" "),e("code",[t._v("::/0")])]),t._v(" "),e("li",[e("strong",[t._v("Type:")]),t._v(" "),e("code",[t._v("HTTP")]),t._v(", "),e("strong",[t._v("Protocol:")]),t._v(" "),e("code",[t._v("TCP")]),t._v(", "),e("strong",[t._v("Port Range")]),t._v(" "),e("code",[t._v("80")]),t._v(", "),e("strong",[t._v("Source:")]),t._v(" "),e("code",[t._v("0.0.0.0/0, ::/0")])]),t._v(" "),e("li",[e("strong",[t._v("Type:")]),t._v(" "),e("code",[t._v("HTTPS")]),t._v(", "),e("strong",[t._v("Protocol:")]),t._v(" "),e("code",[t._v("TCP")]),t._v(", "),e("strong",[t._v("Port Range")]),t._v(" "),e("code",[t._v("443")]),t._v(", "),e("strong",[t._v("Source:")]),t._v(" "),e("code",[t._v("0.0.0.0/0, ::/0")])]),t._v(" "),e("li",[e("strong",[t._v("Type:")]),t._v(" "),e("code",[t._v("Custom TCP Rule")]),t._v(", "),e("strong",[t._v("Protocol:")]),t._v(" "),e("code",[t._v("TCP")]),t._v(", "),e("strong",[t._v("Port Range")]),t._v(" "),e("code",[t._v("1337")]),t._v(", "),e("strong",[t._v("Source:")]),t._v(" "),e("code",[t._v("0.0.0.0/0")]),t._v(" "),e("strong",[t._v("Description:")]),t._v(" "),e("code",[t._v("Strapi for Testing Port")]),t._v("\nThese rules are basic configuration and security rules. You may want to tighten and limit these rules based on your own project and organizational policies."),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("After setting up your Nginx rules and domain name with the proper aliases, you will need to delete the rule regarding port 1337 as this is for testing and setting up the project - "),e("strong",[t._v("not for production")]),t._v(".")])])])])])])]),t._v(" "),e("li",[t._v("点击 blue "),e("code",[t._v("Review and Launch")]),t._v(" 按钮")]),t._v(" "),e("li",[t._v("Review the details, in the "),e("strong",[t._v("Step 7: Review Instance Launch")]),t._v(", then click the blue "),e("code",[t._v("Launch")]),t._v(" 按钮 Now, you need to "),e("strong",[t._v("select an existing key pair")]),t._v(" or "),e("strong",[t._v("create a new key pair")]),t._v(". To create a new key pair, do the following:\n"),e("ul",[e("li",[t._v("选择 dropdown option "),e("code",[t._v("Create a new key pair")]),t._v(".")]),t._v(" "),e("li",[t._v("Name your the key pair name, e.g. "),e("code",[t._v("ec2-strapi-key-pair")]),e("div",{staticClass:"custom-block warning"},[e("p",{staticClass:"custom-block-title"},[t._v("WARNING")]),t._v(" "),e("p",[t._v("Download the "),e("strong",[t._v("private key file")]),t._v(" (.pem file). This file is needed, so note where it was downloaded.")])])]),t._v(" "),e("li",[t._v("After downloading the file, click the blue "),e("code",[t._v("Launch Instances")]),t._v(" 按钮")])])])]),t._v(" "),e("p",[t._v("Your instance is now running. Continue to the next steps.")]),t._v(" "),e("h3",{attrs:{id:"install-a-postgresql-database-on-aws-rds"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#install-a-postgresql-database-on-aws-rds"}},[t._v("#")]),t._v(" Install a PostgreSQL database on AWS RDS")]),t._v(" "),e("p",[t._v("Amazon calls their database hosting services "),e("strong",[t._v("RDS")]),t._v(". Multiple database options exist and are available. In this guide, "),e("strong",[t._v("PostgreSQL")]),t._v(" is used as the example, and the steps are similar for each of the other database that are supported by Strapi. ("),e("strong",[t._v("MySQL")]),t._v(", "),e("strong",[t._v("MongoDB")]),t._v(", "),e("strong",[t._v("PostgreSQL")]),t._v(", "),e("strong",[t._v("MariaDB")]),t._v(", "),e("strong",[t._v("SQLite")]),t._v("). You will set-up an "),e("strong",[t._v("RDS instance")]),t._v(" to host your "),e("code",[t._v("postgresql")]),t._v(" database.")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[e("strong",[t._v("Amazon RDS")]),t._v(" does "),e("strong",[t._v("NOT")]),t._v(" have a completely free evaluation tier. After finishing this guide, if you are only testing, please remember to "),e("a",{attrs:{href:"https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_DeleteInstance.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("delete the database"),e("OutboundLink")],1),t._v(". Otherwise, you will incur charges.")])]),t._v(" "),e("h4",{attrs:{id:"_1-navigate-to-the-aws-rds-service"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-navigate-to-the-aws-rds-service"}},[t._v("#")]),t._v(" 1. Navigate to the "),e("code",[t._v("AWS RDS Service")])]),t._v(" "),e("p",[t._v("In the top menu, click on "),e("code",[t._v("Services")]),t._v(" and do a search for "),e("code",[t._v("rds")]),t._v(", click on "),e("code",[t._v("RDS, Managed Relational Database Service")]),t._v(".")]),t._v(" "),e("h4",{attrs:{id:"_2-select-your-region"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-select-your-region"}},[t._v("#")]),t._v(" 2. Select your region")]),t._v(" "),e("p",[t._v("In the top menu bar, select the region that is the same as the EC2 instance, e.g. "),e("code",[t._v("EU (Paris)")]),t._v(" or "),e("code",[t._v("US East (N. Virgina)")]),t._v(".")]),t._v(" "),e("h4",{attrs:{id:"_3-create-the-database"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-create-the-database"}},[t._v("#")]),t._v(" 3. Create the database")]),t._v(" "),e("p",[t._v("点击 orange "),e("code",[t._v("Create database")]),t._v(" 按钮\nFollow these steps to complete installation of a "),e("code",[t._v("PostgreSQL")]),t._v(" database:")]),t._v(" "),e("ul",[e("li",[e("strong",[t._v("Engine Options:")]),t._v(" 点击 "),e("code",[t._v("PostgreSQL")]),t._v(", version "),e("strong",[t._v("PostgreSQL 10.x-R1")])]),t._v(" "),e("li",[e("strong",[t._v("Templates:")]),t._v(" 点击 "),e("code",[t._v("Free Tier")]),t._v(".")]),t._v(" "),e("li",[e("strong",[t._v("Settings")]),t._v(" "),e("ul",[e("li",[e("strong",[t._v("DB instance identifier")]),t._v(" Give a name to your database, e.g. "),e("code",[t._v("strapi-database")])]),t._v(" "),e("li",[e("strong",[t._v("Credential Settings")]),t._v(": This is your "),e("code",[t._v("psql")]),t._v(" database "),e("em",[t._v("username")]),t._v(" and "),e("em",[t._v("password")]),t._v(".\n"),e("ul",[e("li",[e("strong",[t._v("Master username:")]),t._v(" Keep as "),e("code",[t._v("postgres")]),t._v(", or change (optional)")]),t._v(" "),e("li",[e("code",[t._v("Uncheck")]),t._v(" "),e("em",[t._v("Auto generate a password")]),t._v(", and then type in a new secret password.")])])])])]),t._v(" "),e("li",[e("strong",[t._v("Connectivity")]),t._v(", and "),e("strong",[t._v("Additional connectivity configuration")]),t._v(": Set "),e("code",[t._v("Publicly accessible")]),t._v(" to "),e("code",[t._v("Yes")]),t._v(".")]),t._v(" "),e("li",[e("strong",[t._v("OPTIONAL:")]),t._v(" Review any further options ("),e("strong",[t._v("DB Instance size")]),t._v(", "),e("strong",[t._v("Storage")]),t._v(", "),e("strong",[t._v("Connectivity")]),t._v("), and modify to your project needs.")]),t._v(" "),e("li",[t._v("You need to give you Database a name. Under "),e("strong",[t._v("Additional configuration")]),t._v(":\n"),e("ul",[e("li",[e("strong",[t._v("Additional configuration")]),t._v(", and then "),e("strong",[t._v("Initial database name:")]),t._v(" Give your database a name, e.g. "),e("code",[t._v("strapi")]),t._v(".")])])]),t._v(" "),e("li",[t._v("Review the rest of the options and click the orange, "),e("code",[t._v("Create database")]),t._v(" 按钮")])]),t._v(" "),e("p",[t._v("After a few minutes, you may refresh your page and see that your database has been successfully created.")]),t._v(" "),e("h3",{attrs:{id:"configure-s3-for-image-hosting"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#configure-s3-for-image-hosting"}},[t._v("#")]),t._v(" Configure S3 for image hosting")]),t._v(" "),e("p",[t._v("Amazon calls cloud storage services "),e("strong",[t._v("S3")]),t._v(". You create a "),e("strong",[t._v("bucket")]),t._v(", which holds the files, images, folders, etc... which then can be accessed and served by your application. This guide will show you how to use "),e("strong",[t._v("Amazon S3")]),t._v(" to host the images for your project.")]),t._v(" "),e("h4",{attrs:{id:"_1-navigate-to-the-amazon-s3"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-navigate-to-the-amazon-s3"}},[t._v("#")]),t._v(" 1. Navigate to the "),e("code",[t._v("Amazon S3")])]),t._v(" "),e("p",[t._v("In the top menu, click on "),e("code",[t._v("Services")]),t._v(" and do a search for "),e("code",[t._v("s3")]),t._v(", click on "),e("code",[t._v("Scalable storage in the cloud")]),t._v(".")]),t._v(" "),e("h4",{attrs:{id:"_2-create-the-bucket"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-create-the-bucket"}},[t._v("#")]),t._v(" 2. Create the bucket")]),t._v(" "),e("p",[t._v("点击 the blue "),e("code",[t._v("Create bucket")]),t._v(" button:")]),t._v(" "),e("ul",[e("li",[t._v("Give your bucket a unique name, under "),e("strong",[t._v("Bucket name")]),t._v(", e.g. "),e("code",[t._v("my-project-name-images")]),t._v(".")]),t._v(" "),e("li",[t._v("选择 most appropriate region, under "),e("strong",[t._v("Region")]),t._v(", e.g. "),e("code",[t._v("EU (Paris)")]),t._v(" or "),e("code",[t._v("US East (N. Virgina)")]),t._v(".")]),t._v(" "),e("li",[t._v("Click "),e("code",[t._v("Next")]),t._v(".")]),t._v(" "),e("li",[t._v("Configure any appropriate options for your project in the "),e("strong",[t._v("Configure Options")]),t._v(" page, and click "),e("code",[t._v("next")]),t._v(".")]),t._v(" "),e("li",[t._v("Under "),e("strong",[t._v("Block public access")]),t._v(":\n"),e("ul",[e("li",[t._v("Uncheck "),e("code",[t._v("Block all public access")]),t._v(" and set the permissions as follows:\n"),e("ul",[e("li",[e("code",[t._v("Uncheck")]),t._v(" Block new public ACLs and uploading public objects (Recommended)")]),t._v(" "),e("li",[e("code",[t._v("Uncheck")]),t._v(" Block public access to buckets and objects granted through any access control lists (ACLs)")]),t._v(" "),e("li",[e("code",[t._v("Check")]),t._v(" Block public access to buckets and objects granted through new public bucket policies")]),t._v(" "),e("li",[e("code",[t._v("Check")]),t._v(" Block public and cross-account access to buckets and objects through any public bucket policies")])])]),t._v(" "),e("li",[t._v("Select "),e("code",[t._v("Do not grant Amazon S3 Log Delivery group write access to this bucket")]),t._v(".")])])]),t._v(" "),e("li",[t._v("Click "),e("code",[t._v("Next")]),t._v(".")]),t._v(" "),e("li",[e("strong",[t._v("Review")]),t._v(" and click "),e("code",[t._v("Create bucket")]),t._v(".")])]),t._v(" "),e("h3",{attrs:{id:"configure-ec2-as-a-node-js-server"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#configure-ec2-as-a-node-js-server"}},[t._v("#")]),t._v(" Configure EC2 as a Node.js server")]),t._v(" "),e("p",[t._v("You will set-up your EC2 server as a Node.js server. Including basic configuration and Git.")]),t._v(" "),e("p",[t._v("You will need your "),e("strong",[t._v("EC2")]),t._v(" ip address:")]),t._v(" "),e("ul",[e("li",[t._v("In the "),e("code",[t._v("AWS Console")]),t._v(", navigate to the "),e("code",[t._v("AWS EC2")]),t._v(". In the top menu, click on "),e("code",[t._v("Services")]),t._v(" and do a search for "),e("code",[t._v("ec2")]),t._v(", click on "),e("code",[t._v("Virtual Servers in the cloud")]),t._v(".")]),t._v(" "),e("li",[t._v("点击 "),e("code",[t._v("1 Running Instance")]),t._v(" and note the "),e("code",[t._v("IPv4 Public OP")]),t._v(" address. E.g. "),e("code",[t._v("34.182.83.134")]),t._v(".")])]),t._v(" "),e("h4",{attrs:{id:"_1-setup-the-pem-file"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-setup-the-pem-file"}},[t._v("#")]),t._v(" 1. Setup the "),e("code",[t._v(".pem")]),t._v(" file")]),t._v(" "),e("ul",[e("li",[t._v("You downloaded, in a previous step, your "),e("code",[t._v("User")]),t._v(" .pem file. e.g. "),e("code",[t._v("ec2-strapi-key-pair.pem")]),t._v(". This needs to be included in each attempt to "),e("code",[t._v("SSH")]),t._v(" into your "),e("code",[t._v("EC2 server")]),t._v(". Move your "),e("code",[t._v(".pem")]),t._v(" file to "),e("code",[t._v("~/.ssh/")]),t._v(", follow these steps:")]),t._v(" "),e("li",[t._v("On your local machine, navigate to the folder that contains your .pem file. e.g. "),e("code",[t._v("downloads")])]),t._v(" "),e("li",[t._v("Move the .pem file to "),e("code",[t._v("~/.ssh/")]),t._v(" and set file permissions:\n"),e("code",[t._v("Path:./path-to/.pem-file/")])])]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("mv")]),t._v(" ec2-strapi-key-pair.pem ~/.ssh/\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("chmod")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("400")]),t._v(" ~/.ssh/ec2-strapi-key-pair.pem\n")])])]),e("h4",{attrs:{id:"_2-log-in-to-your-server-as-the-default-ubuntu-user"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-log-in-to-your-server-as-the-default-ubuntu-user"}},[t._v("#")]),t._v(" 2. Log in to your server as the default "),e("code",[t._v("ubuntu")]),t._v(" user:")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("In the future, each time you log into your "),e("code",[t._v("EC2")]),t._v(" server, you will need to add the path to the .pem file, e.g. "),e("code",[t._v("ssh -i ~/.ssh/ec2-strapi-key-pair.pem ubuntu@12.123.123.11")]),t._v(".")])]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("ssh")]),t._v(" -i ~/.ssh/ec2-strapi-key-pair.pem ubuntu@12.123.123.11\n\nWelcome to Ubuntu "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("18.04")]),t._v(".2 LTS "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("GNU/Linux "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("4.15")]),t._v(".0-1032-aws x86_64"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\n\nTo run a "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("command")]),t._v(" as administrator "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("user "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"root"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(", use "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"sudo <command>"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v("\nSee "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"man sudo_root"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" details.\n\nubuntu@ip-12.123.123.11:~$\n\n")])])]),e("h4",{attrs:{id:"_3-install-node-js-with-npm"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-install-node-js-with-npm"}},[t._v("#")]),t._v(" 3. Install "),e("strong",[t._v("Node.js")]),t._v(" with "),e("strong",[t._v("npm")]),t._v(":")]),t._v(" "),e("p",[t._v("Strapi currently supports "),e("code",[t._v("Node.js v12.x.x")]),t._v(". The following steps will install Node.js onto your EC2 server.")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" ~\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" -sL https://deb.nodesource.com/setup_12.x "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" -E "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("bash")]),t._v(" -\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt-get")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" nodejs\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\nnode -v "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" -v\n")])])]),e("p",[t._v("The last command "),e("code",[t._v("node -v && npm -v")]),t._v(" should output two versions numbers, eg. "),e("code",[t._v("v12.x.x, 6.x.x")]),t._v(".")]),t._v(" "),e("h4",{attrs:{id:"_4-create-and-change-npm-s-default-directory"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-create-and-change-npm-s-default-directory"}},[t._v("#")]),t._v(" 4. Create and change npm's default directory.")]),t._v(" "),e("p",[t._v("The following steps are based on "),e("a",{attrs:{href:"https://docs.npmjs.com/resolving-eacces-permissions-errors-when-installing-packages-globally",target:"_blank",rel:"noopener noreferrer"}},[t._v("how to resolve access permissions from npmjs.com"),e("OutboundLink")],1),t._v(":")]),t._v(" "),e("ul",[e("li",[t._v("创建 a "),e("code",[t._v(".npm-global")]),t._v(" directory and set the path to this directory for "),e("code",[t._v("node_modules")])])]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" ~\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("mkdir")]),t._v(" ~/.npm-global\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" config "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("set")]),t._v(" prefix "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'~/.npm-global'")]),t._v("\n")])])]),e("ul",[e("li",[t._v("创建 (or modify) a "),e("code",[t._v("~/.profile")]),t._v(" file and add this line:")])]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("nano")]),t._v(" ~/.profile\n")])])]),e("p",[t._v("Add these lines at the bottom of the "),e("code",[t._v("~/.profile")]),t._v(" file.")]),t._v(" "),e("div",{staticClass:"language-ini extra-class"},[e("pre",{pre:!0,attrs:{class:"language-ini"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# set PATH so global node modules install without permission issues")]),t._v("\nexport PATH"),e("span",{pre:!0,attrs:{class:"token attr-value"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v("~/.npm-global/bin:$PATH")]),t._v("\n")])])]),e("ul",[e("li",[t._v("Lastly, update your system variables:")])]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("source")]),t._v(" ~/.profile\n")])])]),e("p",[t._v("You are now ready to continue to the next section.")]),t._v(" "),e("h3",{attrs:{id:"install-and-configure-git-versioning-on-your-server"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#install-and-configure-git-versioning-on-your-server"}},[t._v("#")]),t._v(" Install and Configure Git versioning on your server")]),t._v(" "),e("p",[t._v("A convenient way to maintain your Strapi application and update it during and after initial development is to use "),e("a",{attrs:{href:"https://git-scm.com/book/en/v2/Getting-Started-About-Version-Control",target:"_blank",rel:"noopener noreferrer"}},[t._v("Git"),e("OutboundLink")],1),t._v(". In order to use Git, you will need to have it installed on your EC2 instance. EC2 instances should have Git installed by default, so you will first check if it is installed and if it is not installed, you will need to install it.")]),t._v(" "),e("p",[t._v("The next step is to configure Git on your server.")]),t._v(" "),e("h4",{attrs:{id:"_1-check-to-see-if-git-is-installed"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-check-to-see-if-git-is-installed"}},[t._v("#")]),t._v(" 1. Check to see if "),e("code",[t._v("Git")]),t._v(" is installed")]),t._v(" "),e("p",[t._v("If you see a "),e("code",[t._v("git version 2.x.x")]),t._v(" then you do have "),e("code",[t._v("Git")]),t._v(" installed. Check with the following command:")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" --version\n")])])]),e("h4",{attrs:{id:"_2-optional-install-git"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-optional-install-git"}},[t._v("#")]),t._v(" 2. "),e("strong",[t._v("OPTIONAL:")]),t._v(" Install Git.")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("Only do if "),e("em",[t._v("not installed")]),t._v(", as above. Please follow these directions on "),e("a",{attrs:{href:"https://git-scm.com/book/en/v2/Getting-Started-Installing-Git",target:"_blank",rel:"noopener noreferrer"}},[t._v("how to install Git on Ubuntu 18.04"),e("OutboundLink")],1),t._v(".")])]),t._v(" "),e("h4",{attrs:{id:"_3-configure-the-global-username-and-email-settings-setting-up-git-your-identity"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-configure-the-global-username-and-email-settings-setting-up-git-your-identity"}},[t._v("#")]),t._v(" 3. Configure the global "),e("strong",[t._v("username")]),t._v(" and "),e("strong",[t._v("email")]),t._v(" settings: "),e("a",{attrs:{href:"https://git-scm.com/book/en/v2/Getting-Started-First-Time-Git-Setup",target:"_blank",rel:"noopener noreferrer"}},[t._v("Setting up Git - Your Identity"),e("OutboundLink")],1)]),t._v(" "),e("p",[t._v("After installing and configuring Git on your EC2 instance. Please continue to the next step.")]),t._v(" "),e("h3",{attrs:{id:"prepare-and-clone-strapi-project-to-server"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#prepare-and-clone-strapi-project-to-server"}},[t._v("#")]),t._v(" Prepare and clone Strapi project to server")]),t._v(" "),e("p",[t._v("These instructions assume that you have already created a "),e("strong",[t._v("Strapi")]),t._v(" project, and have it in a "),e("strong",[t._v("GitHub")]),t._v(" repository.")]),t._v(" "),e("p",[t._v("You will need to update the "),e("code",[t._v("database.json")]),t._v(" file to configure Strapi to connect to the "),e("code",[t._v("RDS")]),t._v(" database. And you will need to install an npm package called "),e("code",[t._v("pg")]),t._v(" locally on your development server.")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("The "),e("code",[t._v("pg")]),t._v(" package install is only necessary if you are using "),e("strong",[t._v("PostgresSQL")]),t._v(" as your database.")])]),t._v(" "),e("h4",{attrs:{id:"_1-install-pg-in-your-strapi-project"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-install-pg-in-your-strapi-project"}},[t._v("#")]),t._v(" 1. Install "),e("code",[t._v("pg")]),t._v(" in your Strapi project.")]),t._v(" "),e("p",[t._v("On your development machine, navigate to your Strapi project root directory:\n"),e("code",[t._v("Path: ./my-project/")])]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" pg\n")])])]),e("h4",{attrs:{id:"_2-edit-the-config-database-js-file"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-edit-the-config-database-js-file"}},[t._v("#")]),t._v(" 2. Edit the "),e("code",[t._v("./config/database.js")]),t._v(" file.")]),t._v(" "),e("p",[t._v("Copy/paste the following:")]),t._v(" "),e("p",[e("code",[t._v("Path: ./my-project/config/database.js")]),t._v(":")]),t._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[t._v("module"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("exports")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token parameter"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" env "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  defaultConnection"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'default'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  connections"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      connector"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'bookshelf'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      settings"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        client"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'postgres'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        host"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("env")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'DATABASE_HOST'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'127.0.0.1'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        port"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" env"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("int")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'DATABASE_PORT'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("5432")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        database"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("env")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'DATABASE_NAME'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'strapi'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        username"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("env")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'DATABASE_USERNAME'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        password"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("env")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'DATABASE_PASSWORD'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      options"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        ssl"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("h4",{attrs:{id:"_3-install-the-strapi-aws-s3-upload-provider"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-install-the-strapi-aws-s3-upload-provider"}},[t._v("#")]),t._v(" 3. Install the "),e("strong",[t._v("Strapi AWS S3 Upload Provider")]),t._v(":")]),t._v(" "),e("p",[t._v("Path: "),e("code",[t._v("./my-project/")]),t._v(".")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" strapi-provider-upload-aws-s3\n")])])]),e("p",[t._v("To enable and configure the provider, create or edit the file at "),e("code",[t._v("./config/plugins.js")]),t._v(".")]),t._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[t._v("module"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("exports")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token parameter"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" env "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  upload"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    provider"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'aws-s3'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    providerOptions"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      accessKeyId"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("env")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'AWS_ACCESS_KEY_ID'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      secretAccessKey"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("env")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'AWS_ACCESS_SECRET'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      region"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("env")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'AWS_REGION'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      params"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        Bucket"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("env")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'AWS_BUCKET_NAME'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("p",[t._v("Checkout the documentation about using an upload provider "),e("RouterLink",{attrs:{to:"/developer-docs/latest/development/plugins/upload.html#using-a-provider"}},[t._v("这里")]),t._v(".")],1),t._v(" "),e("h4",{attrs:{id:"_4-push-your-local-changes-to-your-project-s-github-repository"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-push-your-local-changes-to-your-project-s-github-repository"}},[t._v("#")]),t._v(" 4. Push your local changes to your project's GitHub repository.")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" commit -m "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Installed pg, aws-S3 upload provider and updated the config files'")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" push\n")])])]),e("h4",{attrs:{id:"_5-deploy-from-github"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5-deploy-from-github"}},[t._v("#")]),t._v(" 5. Deploy from GitHub")]),t._v(" "),e("p",[t._v("You will next deploy your Strapi project to your EC2 instance by "),e("strong",[t._v("cloning it from GitHub")]),t._v(".")]),t._v(" "),e("p",[t._v("From your terminal and logged into your EC2 instance as the "),e("code",[t._v("ubuntu")]),t._v(" user:")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" ~\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" clone https://github.com/your-name/your-project-repo.git\n")])])]),e("p",[t._v("Next, navigate to the "),e("code",[t._v("my-project")]),t._v(" folder, the root for Strapi. You will need to run "),e("code",[t._v("npm install")]),t._v(" to install the packages for your project.")]),t._v(" "),e("p",[e("code",[t._v("Path: ./my-project/")])]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" ./my-project/\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("NODE_ENV")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("production "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" run build\n")])])]),e("p",[t._v("Next, you need to install "),e("strong",[t._v("PM2 Runtime")]),t._v(" and configure the "),e("code",[t._v("ecosystem.config.js")]),t._v(" file")]),t._v(" "),e("h4",{attrs:{id:"_6-install-pm2-runtime"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_6-install-pm2-runtime"}},[t._v("#")]),t._v(" 6. Install "),e("strong",[t._v("PM2 Runtime")])]),t._v(" "),e("p",[e("a",{attrs:{href:"https://pm2.keymetrics.io",target:"_blank",rel:"noopener noreferrer"}},[t._v("PM2 Runtime"),e("OutboundLink")],1),t._v(" allows you to keep your Strapi project alive and to reload it without downtime.")]),t._v(" "),e("p",[t._v("Ensure you are logged in as a "),e("strong",[t._v("non-root")]),t._v(" user. You will install "),e("strong",[t._v("PM2")]),t._v(" globally:")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" pm2@latest -g\n")])])]),e("p",[t._v("Now, you will need to configure an "),e("code",[t._v("ecosystem.config.js")]),t._v(" file. This file will set "),e("code",[t._v("env")]),t._v(" variables that connect Strapi to your database. It will also be used to restart your project whenever any changes are made to files within the Strapi file system itself (such as when an update arrived from Github). You can read more about this file "),e("a",{attrs:{href:"https://pm2.keymetrics.io/docs/usage/application-declaration/",target:"_blank",rel:"noopener noreferrer"}},[t._v("这里"),e("OutboundLink")],1),t._v(".")]),t._v(" "),e("ul",[e("li",[t._v("You will need to open your "),e("code",[t._v("nano")]),t._v(" editor and then "),e("code",[t._v("copy/paste")]),t._v(" the following:")])]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" ~\npm2 init\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("nano")]),t._v(" ecosystem.config.js\n")])])]),e("ul",[e("li",[t._v("Next, replace the boilerplate content in the file, with the following:")])]),t._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[t._v("module"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  apps"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      name"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'your-app-name'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      cwd"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/home/ubuntu/my-project'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      script"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'npm'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      args"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'start'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      env"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token constant"}},[t._v("NODE_ENV")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'production'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token constant"}},[t._v("DATABASE_HOST")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'your-unique-url.rds.amazonaws.com'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// database Endpoint under 'Connectivity & Security' tab")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token constant"}},[t._v("DATABASE_PORT")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'5432'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token constant"}},[t._v("DATABASE_NAME")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'strapi'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// DB name under 'Configuration' tab")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token constant"}},[t._v("DATABASE_USERNAME")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'postgres'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// default username")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token constant"}},[t._v("DATABASE_PASSWORD")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Password'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token constant"}},[t._v("AWS_ACCESS_KEY_ID")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'aws-access-key-id'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token constant"}},[t._v("AWS_ACCESS_SECRET")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'aws-access-secret'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Find it in Amazon S3 Dashboard")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token constant"}},[t._v("AWS_REGION")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'aws-region'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token constant"}},[t._v("AWS_BUCKET_NAME")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'my-project-bucket-name'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("p",[t._v("You can also set your environment variables in a "),e("code",[t._v(".env")]),t._v(" file in your project like so:")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("DATABASE_HOST=your-unique-url.rds.amazonaws.com\nDATABASE_PORT=5432\nDATABASE_NAME=strapi\nDATABASE_USERNAME=postgres\nDATABASE_PASSWORD=Password\nAWS_ACCESS_KEY_ID=aws-access-key-id\nAWS_ACCESS_SECRET=aws-access-secret\nAWS_REGION=aws-region\nAWS_BUCKET_NAME=my-project-bucket-name\n")])])]),e("p",[t._v("We recommend you continue setting the "),e("code",[t._v("NODE_ENV")]),t._v(" variable in the "),e("code",[t._v("ecosystem.config.js")]),t._v(" file.")]),t._v(" "),e("p",[t._v("Use the following command to start "),e("code",[t._v("pm2")]),t._v(":")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" ~\npm2 start ecosystem.config.js\n")])])]),e("p",[t._v("Your Strapi project should now be available on "),e("code",[t._v("http://your-ip-address:1337/")]),t._v(".")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("Earlier, "),e("code",[t._v("Port 1337")]),t._v(" was allowed access for "),e("strong",[t._v("testing and setup")]),t._v(" purposes. After setting up "),e("strong",[t._v("NGINX")]),t._v(", the "),e("strong",[t._v("Port 1337")]),t._v(" needs to have access "),e("strong",[t._v("denied")]),t._v(".")])]),t._v(" "),e("h4",{attrs:{id:"_7-configure-pm2-runtime-to-launch-project-on-system-startup"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_7-configure-pm2-runtime-to-launch-project-on-system-startup"}},[t._v("#")]),t._v(" 7. Configure "),e("strong",[t._v("PM2 Runtime")]),t._v(" to launch project on system startup.")]),t._v(" "),e("p",[t._v("Follow the steps below to have your app launch on system startup.")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("These steps are based on the "),e("a",{attrs:{href:"https://pm2.keymetrics.io/docs/usage/startup/#startup-script-generator",target:"_blank",rel:"noopener noreferrer"}},[t._v("PM2 Runtime Startup Guide"),e("OutboundLink")],1),t._v(".")])]),t._v(" "),e("ul",[e("li",[t._v("Generate and configure a startup script to launch PM2, it will generate a Startup Script to copy/paste, do so:")])]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("$ "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" ~\n$ pm2 startup systemd\n\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("PM2"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" Init System found: systemd\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("PM2"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" To setup the Startup Script, copy/paste the following command:\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("env")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("PATH")])]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("$PATH")]),t._v(":/usr/bin /usr/lib/node_modules/pm2/bin/pm2 startup systemd -u your-name --hp /home/your-name\n")])])]),e("ul",[e("li",[t._v("Copy/paste the generated command:")])]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("env")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("PATH")])]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("$PATH")]),t._v(":/usr/bin /usr/lib/node_modules/pm2/bin/pm2 startup systemd -u your-name --hp /home/your-name\n\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("PM2"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" Init System found: systemd\nPlatform systemd\n\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v("\n\n\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("PM2"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("v"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" Command successfully executed.\n+---------------------------------------+\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("PM2"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" Freeze a process list on "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("reboot")]),t._v(" via:\n   $ pm2 save\n\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("PM2"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" Remove init script via:\n   $ pm2 unstartup systemd\n")])])]),e("ul",[e("li",[t._v("Next, "),e("code",[t._v("Save")]),t._v(" the new PM2 process list and environment.")])]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("pm2 save\n\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("PM2"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" Saving current process list"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("PM2"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" Successfully saved "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" /home/your-name/.pm2/dump.pm2\n\n")])])]),e("ul",[e("li",[e("strong",[t._v("OPTIONAL")]),t._v(": You can test to see if the script above works whenever your system reboots with the "),e("code",[t._v("sudo reboot")]),t._v(" command. You will need to login again with your "),e("strong",[t._v("non-root user")]),t._v(" and then run "),e("code",[t._v("pm2 list")]),t._v(" and "),e("code",[t._v("systemctl status pm2-ubuntu")]),t._v(" to verify everything is working.")])]),t._v(" "),e("h3",{attrs:{id:"create-you-first-administrator-user"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#create-you-first-administrator-user"}},[t._v("#")]),t._v(" Create you first Administrator user")]),t._v(" "),e("p",[t._v("The next steps will create an Administrator user on the strapi AWS instance.")]),t._v(" "),e("h4",{attrs:{id:"_1-locate-your-ipv4-public-ip"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-locate-your-ipv4-public-ip"}},[t._v("#")]),t._v(" 1. Locate your "),e("code",[t._v("IPv4 Public IP")]),t._v(":")]),t._v(" "),e("ul",[e("li",[t._v("Login as your regular user to your "),e("code",[t._v("EC2 Dashboard")])]),t._v(" "),e("li",[t._v("点击 "),e("code",[t._v("1 Running Instances")]),t._v(".")]),t._v(" "),e("li",[t._v("Below, in the "),e("strong",[t._v("Description")]),t._v(" tab, locate your "),e("strong",[t._v("IPv4 Public IP")])])]),t._v(" "),e("h4",{attrs:{id:"_2-next-create-your-administrator-user-and-login-to-strapi"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-next-create-your-administrator-user-and-login-to-strapi"}},[t._v("#")]),t._v(" 2. Next, create your "),e("strong",[t._v("Administrator")]),t._v(" user, and login to Strapi:")]),t._v(" "),e("ul",[e("li",[t._v("Go to "),e("code",[t._v("http://your-ip-address:1337/")])]),t._v(" "),e("li",[t._v("Complete the registration form.")]),t._v(" "),e("li",[t._v("Click "),e("code",[t._v("Ready to Start")])])]),t._v(" "),e("h3",{attrs:{id:"set-up-a-webhook"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#set-up-a-webhook"}},[t._v("#")]),t._v(" Set up a webhook")]),t._v(" "),e("p",[t._v("Providing that your project is set-up on GitHub, you will need to configure your "),e("strong",[t._v("Strapi Project Repository")]),t._v(" with a webhook. The following article provides additional information to the steps below: "),e("a",{attrs:{href:"https://developer.github.com/webhooks/creating/",target:"_blank",rel:"noopener noreferrer"}},[t._v("GitHub Creating Webhooks Guide"),e("OutboundLink")],1),t._v(".")]),t._v(" "),e("ul",[e("li",[e("p",[t._v("You will need to access the "),e("code",[t._v("Settings")]),t._v(" tab for your "),e("code",[t._v("Strapi Project Repository")]),t._v(":")]),t._v(" "),e("ol",[e("li",[t._v("Navigate and click to "),e("code",[t._v("Settings")]),t._v(" for your repository.")]),t._v(" "),e("li",[t._v("点击 "),e("code",[t._v("Webhooks")]),t._v(", then click "),e("code",[t._v("Add Webhook")]),t._v(".")]),t._v(" "),e("li",[t._v("The fields are filled out like this:\n"),e("ul",[e("li",[t._v("Payload URL: Enter "),e("code",[t._v("http://your-ip-address:8080")])]),t._v(" "),e("li",[t._v("Content type: Select "),e("code",[t._v("application/json")])]),t._v(" "),e("li",[t._v("Which events would you like to trigger this webhook: Select "),e("code",[t._v("Just the push event")])]),t._v(" "),e("li",[t._v("Secret: Enter "),e("code",[t._v("YourSecret")])]),t._v(" "),e("li",[t._v("Active: Select the checkbox")])])]),t._v(" "),e("li",[t._v("Review the fields and click "),e("code",[t._v("Add Webhook")]),t._v(".")])])]),t._v(" "),e("li",[e("p",[t._v("Next, you need to create a "),e("code",[t._v("Webhook Script")]),t._v(" on your server. These commands create a new file called "),e("code",[t._v("webhook.js")]),t._v(" which will hold two variables:")])])]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" ~\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("mkdir")]),t._v(" NodeWebHooks\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" NodeWebHooks\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("nano")]),t._v(" webhook.js\n")])])]),e("ul",[e("li",[t._v("In the "),e("code",[t._v("nano")]),t._v(" editor, copy/paste the following script, but make sure to replace "),e("code",[t._v("your_secret_key")]),t._v(" and "),e("code",[t._v("repo")]),t._v(" with the values that correspond to your project, then save and exit.")])]),t._v(" "),e("p",[t._v("(This script creates a variable called "),e("code",[t._v("PM2_CMD")]),t._v(" which is used after pulling from GitHub to update your project. The script first changes to the home directory and then runs the variable "),e("code",[t._v("PM2_CMD")]),t._v(" as "),e("code",[t._v("pm2 restart strapi")]),t._v(". The project uses the "),e("code",[t._v("ecosystem.config.js")]),t._v(" as the point of starting your application.)")]),t._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" secret "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'your_secret_key'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Your secret key from Settings in GitHub")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" repo "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'~/path-to-strapi-root-folder/'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// path to the root of your Strapi project on server")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" http "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" crypto "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'crypto'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" exec "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'child_process'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exec"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token constant"}},[t._v("PM2_CMD")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'cd ~ && pm2 startOrRestart ecosystem.config.js'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nhttp\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("createServer")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("req"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    req"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'data'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("chunk")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" sig "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'sha1='")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("\n        crypto\n          "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("createHmac")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'sha1'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" secret"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n          "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("update")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("chunk"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("toString")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n          "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("digest")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'hex'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n      "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("req"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("headers"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'x-hub-signature'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" sig"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("exec")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token template-string"}},[e("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("cd ")]),e("span",{pre:!0,attrs:{class:"token interpolation"}},[e("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("repo"),e("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v(" && git pull && ")]),e("span",{pre:!0,attrs:{class:"token interpolation"}},[e("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),e("span",{pre:!0,attrs:{class:"token constant"}},[t._v("PM2_CMD")]),e("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),e("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("error"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" stdout"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" stderr")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("error"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            console"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("error")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token template-string"}},[e("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("exec error: ")]),e("span",{pre:!0,attrs:{class:"token interpolation"}},[e("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("error"),e("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),e("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n          "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n          console"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token template-string"}},[e("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("stdout: ")]),e("span",{pre:!0,attrs:{class:"token interpolation"}},[e("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("stdout"),e("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),e("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n          console"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token template-string"}},[e("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("stderr: ")]),e("span",{pre:!0,attrs:{class:"token interpolation"}},[e("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("stderr"),e("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),e("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    res"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("end")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("listen")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("8080")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("ul",[e("li",[t._v("Allow the port to communicate with outside web traffic for "),e("code",[t._v("port 8080")]),t._v(":\n"),e("ul",[e("li",[t._v("Within your "),e("strong",[t._v("AWS EC2")]),t._v(" dashboard:\n"),e("ul",[e("li",[t._v("In the left hand menu, click on "),e("code",[t._v("Security Groups")]),t._v(",")]),t._v(" "),e("li",[t._v("Select with the checkbox, the correct "),e("code",[t._v("Group Name")]),t._v(", e.g. "),e("code",[t._v("strapi")]),t._v(",")]),t._v(" "),e("li",[t._v("At the bottom of the screen, in the "),e("strong",[t._v("Inbound")]),t._v(" tab, click "),e("code",[t._v("Edit")]),t._v(", and then "),e("code",[t._v("Add Rule")]),t._v(":\n"),e("ul",[e("li",[t._v("Type: "),e("code",[t._v("Custom TCP")])]),t._v(" "),e("li",[t._v("Protocol: "),e("code",[t._v("TCP")])]),t._v(" "),e("li",[t._v("Port Range: "),e("code",[t._v("8080")])]),t._v(" "),e("li",[t._v("Source: "),e("code",[t._v("Custom")]),t._v(" "),e("code",[t._v("0.0.0.0/0, ::/0")])])])]),t._v(" "),e("li",[t._v("然后 "),e("code",[t._v("Save")])])])])])])]),t._v(" "),e("p",[t._v("Earlier you setup "),e("code",[t._v("pm2")]),t._v(" to start the services (your "),e("strong",[t._v("Strapi project")]),t._v(") whenever the "),e("strong",[t._v("EC2 instance")]),t._v(" reboots or is started. You will now do the same for the "),e("code",[t._v("webhook")]),t._v(" script.")]),t._v(" "),e("ul",[e("li",[e("p",[t._v("Install the webhook as a "),e("code",[t._v("Systemd")]),t._v(" service")]),t._v(" "),e("ul",[e("li",[t._v("Run "),e("code",[t._v("echo $PATH")]),t._v(" and copy the output for use in the next step.")])])])]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("cd ~\necho $PATH\n\n/home/your-name/.npm-global/bin:/home/your-name/bin:/home/your-name/.local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin\n")])])]),e("ul",[e("li",[t._v("创建 a "),e("code",[t._v("webhook.service")]),t._v(" file:")])]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("nano")]),t._v(" /etc/systemd/system/webhook.service\n")])])]),e("ul",[e("li",[t._v("In the "),e("code",[t._v("nano")]),t._v(" editor, copy/paste the following script, but make sure to replace "),e("code",[t._v("ubuntu")]),t._v(" "),e("strong",[t._v("in two places")]),t._v(" if you changed the default "),e("code",[t._v("ubuntu")]),t._v(" user, and "),e("code",[t._v("paste the $PATH")]),t._v(" from above.")])]),t._v(" "),e("div",{staticClass:"custom-block warning"},[e("p",{staticClass:"custom-block-title"},[t._v("WARNING")]),t._v(" "),e("p",[e("strong",[t._v("DELETE THE #COMMENTS BEFORE SAVING")]),t._v(", then save and exit.")])]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Unit"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("Description")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("Github webhook\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("After")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("network.target\n\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Service"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("Environment")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("PATH")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/PASTE-PATH_HERE "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#path from echo $PATH (as above)")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("Type")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("simple\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("User")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("ubuntu "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#replace with your name, if changed from default ubuntu user")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("ExecStart")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/usr/bin/nodejs /home/ubuntu/NodeWebHooks/webhook.js "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#replace with your name, if changed from default ubuntu user")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("Restart")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("on-failure\n\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Install"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("WantedBy")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("multi-user.target\n")])])]),e("ul",[e("li",[t._v("Enable and start the new service so it starts when the system boots:")])]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" systemctl "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("enable")]),t._v(" webhook.service\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" systemctl start webhook\n")])])]),e("ul",[e("li",[t._v("点击 the status of the webhook:")])]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" systemctl status webhook\n")])])]),e("ul",[e("li",[t._v("You may test your "),e("strong",[t._v("webhook")]),t._v(" by following the instructions "),e("a",{attrs:{href:"https://www.digitalocean.com/community/tutorials/how-to-use-node-js-and-github-webhooks-to-keep-remote-projects-in-sync#step-4-testing-the-webhook",target:"_blank",rel:"noopener noreferrer"}},[t._v("这里"),e("OutboundLink")],1),t._v(".")])]),t._v(" "),e("h3",{attrs:{id:"further-steps-to-take"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#further-steps-to-take"}},[t._v("#")]),t._v(" Further steps to take")]),t._v(" "),e("ul",[e("li",[e("p",[t._v("You can "),e("strong",[t._v("add a domain name")]),t._v(" or "),e("strong",[t._v("use a subdomain name")]),t._v(" for your Strapi project, you will need to "),e("a",{attrs:{href:"https://docs.nginx.com/nginx/admin-guide/installing-nginx/installing-nginx-open-source/",target:"_blank",rel:"noopener noreferrer"}},[t._v("install NGINX"),e("OutboundLink")],1),t._v(" and "),e("a",{attrs:{href:"https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/nodejs-platform-proxy.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("configure it"),e("OutboundLink")],1),t._v(".")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("After setting up "),e("strong",[t._v("NGINX")]),t._v(", for security purposes, you need to disable port access on "),e("code",[t._v("Port 1337")]),t._v(". You may do this easily from your "),e("strong",[t._v("EC2 Dashboard")]),t._v(". In "),e("code",[t._v("Security Groups")]),t._v(" (lefthand menu), click the checkbox of the group, eg. "),e("code",[t._v("strapi")]),t._v(", and below in the "),e("code",[t._v("inbound")]),t._v(" tab, click "),e("code",[t._v("Edit")]),t._v(", and delete the rule for "),e("code",[t._v("Port Range")]),t._v(" : "),e("code",[t._v("1337")]),t._v(" by click the "),e("code",[t._v("x")]),t._v(".")])])]),t._v(" "),e("li",[e("p",[t._v("To "),e("strong",[t._v("install SSL")]),t._v(", you will need to "),e("a",{attrs:{href:"https://certbot.eff.org/docs/using.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("install and run Certbot by Let's Encrypt"),e("OutboundLink")],1),t._v(".")])]),t._v(" "),e("li",[e("p",[t._v("Set-up "),e("a",{attrs:{href:"https://www.digitalocean.com/community/tutorials/how-to-set-up-nginx-with-http-2-support-on-ubuntu-18-04",target:"_blank",rel:"noopener noreferrer"}},[t._v("Nginx with HTTP/2 Support"),e("OutboundLink")],1),t._v(" for Ubuntu 18.04.")])])]),t._v(" "),e("p",[t._v("Your "),e("code",[t._v("Strapi")]),t._v(" project has been installed on an "),e("strong",[t._v("AWS EC2 instance")]),t._v(" using "),e("strong",[t._v("Ubuntu 18.04")]),t._v(".")])])}),[],!1,null,null,null);s.default=n.exports}}]);